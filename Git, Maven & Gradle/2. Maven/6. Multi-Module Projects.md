## Overview

Multi-module projects allow you to organize related Maven projects into a hierarchical structure. This enables shared configuration, simplified builds, and better dependency management across multiple related modules.

```
┌─────────────────────────────────────────────────────────────────┐
│              MULTI-MODULE PROJECT STRUCTURE                     │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Parent/Aggregator POM (packaging=pom)                         │
│       ├── Declares modules to build                            │
│       ├── Provides shared configuration                        │
│       └── Manages dependency versions                          │
│            ↓                                                    │
│  ┌─────────────┬─────────────┬─────────────┐                  │
│  │  Module A   │  Module B   │  Module C   │                  │
│  │   (JAR)     │   (JAR)     │   (WAR)     │                  │
│  │             │             │             │                  │
│  │ Inherits:   │ Inherits:   │ Inherits:   │                  │
│  │ • groupId   │ • groupId   │ • groupId   │                  │
│  │ • version   │ • version   │ • version   │                  │
│  │ • deps mgmt │ • deps mgmt │ • deps mgmt │                  │
│  │ • plugins   │ • plugins   │ • plugins   │                  │
│  └─────────────┴─────────────┴─────────────┘                  │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. Project Structure

### Complete Multi-Module Example

```
ecommerce-platform/
├── pom.xml                           # Parent/Aggregator POM
│
├── ecommerce-common/                 # Shared utilities module
│   ├── pom.xml
│   └── src/
│       └── main/
│           └── java/
│               └── com/company/ecommerce/common/
│                   ├── dto/
│                   ├── util/
│                   └── exception/
│
├── ecommerce-api/                    # API/Contract module
│   ├── pom.xml
│   └── src/
│       └── main/
│           └── java/
│               └── com/company/ecommerce/api/
│                   ├── request/
│                   └── response/
│
├── user-service/                     # User microservice
│   ├── pom.xml
│   └── src/
│       ├── main/
│       │   ├── java/
│       │   │   └── com/company/ecommerce/user/
│       │   │       ├── controller/
│       │   │       ├── service/
│       │   │       └── repository/
│       │   └── resources/
│       │       └── application.yml
│       └── test/
│
├── order-service/                    # Order microservice
│   ├── pom.xml
│   └── src/
│       ├── main/
│       └── test/
│
├── payment-service/                  # Payment microservice
│   ├── pom.xml
│   └── src/
│       ├── main/
│       └── test/
│
└── web-app/                          # Frontend web application
    ├── pom.xml
    └── src/
        ├── main/
        │   ├── java/
        │   └── webapp/
        └── test/
```

---

## 2. Parent POM

### Parent/Aggregator POM Configuration

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- Project coordinates -->
    <groupId>com.company.ecommerce</groupId>
    <artifactId>ecommerce-platform</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    
    <!-- CRITICAL: Must be 'pom' for parent/aggregator -->
    <packaging>pom</packaging>
    
    <name>E-Commerce Platform</name>
    <description>Multi-module e-commerce platform</description>
    
    <!-- List of modules to build -->
    <modules>
        <module>ecommerce-common</module>
        <module>ecommerce-api</module>
        <module>user-service</module>
        <module>order-service</module>
        <module>payment-service</module>
        <module>web-app</module>
    </modules>
    
    <!-- Shared properties -->
    <properties>
        <!-- Java version -->
        <java.version>17</java.version>
        <maven.compiler.source>${java.version}</maven.compiler.source>
        <maven.compiler.target>${java.version}</maven.compiler.target>
        
        <!-- Encoding -->
        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
        <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
        
        <!-- Dependency versions -->
        <spring-boot.version>3.1.5</spring-boot.version>
        <lombok.version>1.18.30</lombok.version>
        <mapstruct.version>1.5.5.Final</mapstruct.version>
        <postgresql.version>42.6.0</postgresql.version>
        
        <!-- Testing -->
        <junit.version>5.10.0</junit.version>
        <mockito.version>5.5.0</mockito.version>
        <testcontainers.version>1.19.1</testcontainers.version>
        
        <!-- Plugin versions -->
        <maven-compiler-plugin.version>3.11.0</maven-compiler-plugin.version>
        <maven-surefire-plugin.version>3.1.2</maven-surefire-plugin.version>
        <maven-failsafe-plugin.version>3.1.2</maven-failsafe-plugin.version>
        <jacoco-maven-plugin.version>0.8.10</jacoco-maven-plugin.version>
    </properties>
    
    <!-- Dependency management (versions only, not actual dependencies) -->
    <dependencyManagement>
        <dependencies>
            <!-- Spring Boot BOM -->
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-dependencies</artifactId>
                <version>${spring-boot.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
            
            <!-- Testcontainers BOM -->
            <dependency>
                <groupId>org.testcontainers</groupId>
                <artifactId>testcontainers-bom</artifactId>
                <version>${testcontainers.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
            
            <!-- Internal modules (with ${project.version}) -->
            <dependency>
                <groupId>com.company.ecommerce</groupId>
                <artifactId>ecommerce-common</artifactId>
                <version>${project.version}</version>
            </dependency>
            
            <dependency>
                <groupId>com.company.ecommerce</groupId>
                <artifactId>ecommerce-api</artifactId>
                <version>${project.version}</version>
            </dependency>
            
            <!-- External dependencies -->
            <dependency>
                <groupId>org.projectlombok</groupId>
                <artifactId>lombok</artifactId>
                <version>${lombok.version}</version>
            </dependency>
            
            <dependency>
                <groupId>org.mapstruct</groupId>
                <artifactId>mapstruct</artifactId>
                <version>${mapstruct.version}</version>
            </dependency>
            
            <dependency>
                <groupId>org.postgresql</groupId>
                <artifactId>postgresql</artifactId>
                <version>${postgresql.version}</version>
            </dependency>
            
            <!-- Testing -->
            <dependency>
                <groupId>org.junit.jupiter</groupId>
                <artifactId>junit-jupiter</artifactId>
                <version>${junit.version}</version>
            </dependency>
            
            <dependency>
                <groupId>org.mockito</groupId>
                <artifactId>mockito-core</artifactId>
                <version>${mockito.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <!-- Plugin management (versions and configurations) -->
    <build>
        <pluginManagement>
            <plugins>
                <!-- Compiler -->
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>${maven-compiler-plugin.version}</version>
                    <configuration>
                        <source>${java.version}</source>
                        <target>${java.version}</target>
                        <annotationProcessorPaths>
                            <path>
                                <groupId>org.projectlombok</groupId>
                                <artifactId>lombok</artifactId>
                                <version>${lombok.version}</version>
                            </path>
                            <path>
                                <groupId>org.mapstruct</groupId>
                                <artifactId>mapstruct-processor</artifactId>
                                <version>${mapstruct.version}</version>
                            </path>
                        </annotationProcessorPaths>
                    </configuration>
                </plugin>
                
                <!-- Surefire (Unit Tests) -->
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-surefire-plugin</artifactId>
                    <version>${maven-surefire-plugin.version}</version>
                </plugin>
                
                <!-- Failsafe (Integration Tests) -->
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-failsafe-plugin</artifactId>
                    <version>${maven-failsafe-plugin.version}</version>
                    <executions>
                        <execution>
                            <goals>
                                <goal>integration-test</goal>
                                <goal>verify</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
                
                <!-- JaCoCo (Code Coverage) -->
                <plugin>
                    <groupId>org.jacoco</groupId>
                    <artifactId>jacoco-maven-plugin</artifactId>
                    <version>${jacoco-maven-plugin.version}</version>
                    <executions>
                        <execution>
                            <id>prepare-agent</id>
                            <goals>
                                <goal>prepare-agent</goal>
                            </goals>
                        </execution>
                        <execution>
                            <id>report</id>
                            <phase>test</phase>
                            <goals>
                                <goal>report</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
                
                <!-- Spring Boot -->
                <plugin>
                    <groupId>org.springframework.boot</groupId>
                    <artifactId>spring-boot-maven-plugin</artifactId>
                    <version>${spring-boot.version}</version>
                    <executions>
                        <execution>
                            <goals>
                                <goal>repackage</goal>
                            </goals>
                        </execution>
                    </executions>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
    
    <!-- Profiles -->
    <profiles>
        <profile>
            <id>dev</id>
            <activation>
                <activeByDefault>true</activeByDefault>
            </activation>
            <properties>
                <env>development</env>
            </properties>
        </profile>
        
        <profile>
            <id>prod</id>
            <properties>
                <env>production</env>
            </properties>
        </profile>
    </profiles>
</project>
```

### Key Parent POM Elements

**Packaging:**

```xml
<!-- MUST be 'pom' for aggregator/parent -->
<packaging>pom</packaging>
```

**Modules Section:**

```xml
<!-- List of child modules (relative paths) -->
<modules>
    <module>module-a</module>
    <module>module-b</module>
    <module>subdirectory/module-c</module>
</modules>
```

**DependencyManagement:**

```xml
<!-- Defines versions WITHOUT adding dependencies -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.company</groupId>
            <artifactId>my-lib</artifactId>
            <version>1.0.0</version>
        </dependency>
    </dependencies>
</dependencyManagement>
```

---

## 3. Child Module POM

### Common Module (Shared Utilities)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- Parent reference -->
    <parent>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-platform</artifactId>
        <version>1.0.0-SNAPSHOT</version>
        <!-- Relative path to parent POM -->
        <relativePath>../pom.xml</relativePath>
    </parent>
    
    <!-- Only artifactId needed (inherits groupId and version) -->
    <artifactId>ecommerce-common</artifactId>
    
    <!-- Can override packaging (default is jar) -->
    <packaging>jar</packaging>
    
    <name>E-Commerce Common</name>
    <description>Shared utilities and DTOs</description>
    
    <dependencies>
        <!-- No version needed - managed by parent -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <scope>provided</scope>
        </dependency>
        
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>
        
        <!-- Testing -->
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter</artifactId>
            <scope>test</scope>
        </dependency>
        
        <dependency>
            <groupId>org.assertj</groupId>
            <artifactId>assertj-core</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
</project>
```

### Service Module (With Inter-Module Dependencies)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <!-- Parent reference -->
    <parent>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-platform</artifactId>
        <version>1.0.0-SNAPSHOT</version>
        <relativePath>../pom.xml</relativePath>
    </parent>
    
    <artifactId>user-service</artifactId>
    <packaging>jar</packaging>
    
    <name>User Service</name>
    <description>User management microservice</description>
    
    <dependencies>
        <!-- Internal module dependencies -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
        </dependency>
        
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-api</artifactId>
        </dependency>
        
        <!-- Spring Boot -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        
        <!-- Database -->
        <dependency>
            <groupId>org.postgresql</groupId>
            <artifactId>postgresql</artifactId>
            <scope>runtime</scope>
        </dependency>
        
        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <scope>provided</scope>
        </dependency>
        
        <!-- Testing -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
        
        <dependency>
            <groupId>org.testcontainers</groupId>
            <artifactId>postgresql</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <!-- Build configuration -->
    <build>
        <plugins>
            <!-- Spring Boot plugin (inherits configuration from parent) -->
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
        </plugins>
    </build>
</project>
```

### Web Application Module (WAR packaging)

```xml
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <parent>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-platform</artifactId>
        <version>1.0.0-SNAPSHOT</version>
        <relativePath>../pom.xml</relativePath>
    </parent>
    
    <artifactId>web-app</artifactId>
    
    <!-- WAR packaging -->
    <packaging>war</packaging>
    
    <name>E-Commerce Web Application</name>
    
    <dependencies>
        <!-- Internal dependencies -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
        </dependency>
        
        <!-- Spring Boot Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-thymeleaf</artifactId>
        </dependency>
        
        <!-- Tomcat (provided for external deployment) -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-tomcat</artifactId>
            <scope>provided</scope>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
            </plugin>
            
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-war-plugin</artifactId>
                <configuration>
                    <failOnMissingWebXml>false</failOnMissingWebXml>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>
```

### Parent Section Explained

```xml
<parent>
    <!-- Parent coordinates -->
    <groupId>com.company.ecommerce</groupId>
    <artifactId>ecommerce-platform</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    
    <!-- Relative path to parent POM -->
    <relativePath>../pom.xml</relativePath>
    <!-- Default: ../pom.xml
         Empty <relativePath/> means repository only
         Custom: ../../parent/pom.xml
    -->
</parent>
```

**What Child Inherits from Parent:**

```
✓ groupId (if not specified in child)
✓ version (if not specified in child)
✓ properties
✓ dependencyManagement
✓ pluginManagement
✓ dependencies (actual dependencies in parent)
✓ build configuration
✓ repositories
✓ distributionManagement
```

**What Child Can Override:**

```
✓ artifactId (required - must be unique)
✓ packaging (default: jar)
✓ name and description
✓ Any property value
✓ Add more dependencies
✓ Configure plugins differently
```

---

## 4. Inter-Module Dependencies

### Declaring Module Dependencies

```xml
<!-- In user-service/pom.xml -->
<dependencies>
    <!-- Depend on ecommerce-common module -->
    <dependency>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-common</artifactId>
        <!-- Version comes from parent's dependencyManagement -->
    </dependency>
    
    <!-- Depend on ecommerce-api module -->
    <dependency>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-api</artifactId>
    </dependency>
</dependencies>
```

### Dependency Graph Example

```
┌─────────────────────────────────────────────────────────────┐
│              MODULE DEPENDENCY GRAPH                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  ecommerce-common (no dependencies)                        │
│       ↑                                                     │
│       │                                                     │
│  ecommerce-api (depends on common)                         │
│       ↑                                                     │
│       │                                                     │
│  ┌────┴────┬────────────┬────────────┐                    │
│  │         │            │            │                    │
│  user-    order-    payment-      web-app                 │
│  service  service   service       (depends on all)        │
│  (api +   (api +    (api +                                │
│  common)  common)   common)                               │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### Module Build Order (Reactor)

Maven's **Reactor** automatically determines the build order based on dependencies.

**Build Order Example:**

```
Module dependencies:
  ecommerce-common  → no dependencies
  ecommerce-api     → depends on common
  user-service      → depends on common, api
  order-service     → depends on common, api
  payment-service   → depends on common, api, order-service
  web-app           → depends on all

Reactor build order:
  1. ecommerce-common     (no dependencies)
  2. ecommerce-api        (depends on #1)
  3. user-service         (depends on #1, #2)
  4. order-service        (depends on #1, #2)
  5. payment-service      (depends on #1, #2, #4)
  6. web-app              (depends on all)
```

**Maven Output:**

```bash
$ mvn clean install

[INFO] Reactor Build Order:
[INFO] 
[INFO] E-Commerce Platform                            [pom]
[INFO] E-Commerce Common                              [jar]
[INFO] E-Commerce API                                 [jar]
[INFO] User Service                                   [jar]
[INFO] Order Service                                  [jar]
[INFO] Payment Service                                [jar]
[INFO] E-Commerce Web Application                     [war]
```

---

## 5. Building Multi-Module Projects

### Build All Modules

```bash
# Build everything from root
cd ecommerce-platform
mvn clean install

# Build without tests (faster)
mvn clean install -DskipTests

# Build with all tests
mvn clean verify
```

### Build Specific Module

```bash
# Build only one module (and its dependencies)
mvn clean install -pl user-service -am

# Flags:
# -pl, --projects     : Comma-separated list of modules
# -am, --also-make    : Build dependencies too
# -amd, --also-make-dependents : Build dependents too
# -rf, --resume-from  : Resume from specific module
```

**Examples:**

```bash
# Build user-service and all its dependencies
mvn clean install -pl user-service -am

# Build user-service only (no dependencies)
mvn clean install -pl user-service

# Build user-service and everything that depends on it
mvn clean install -pl user-service -amd

# Build multiple modules
mvn clean install -pl user-service,order-service -am

# Build all except web-app
mvn clean install -pl !web-app

# Resume from payment-service (after failure)
mvn clean install -rf payment-service

# Build in parallel (4 threads)
mvn clean install -T 4
```

### Build Profiles

```bash
# Use specific profile
mvn clean install -Pprod

# Multiple profiles
mvn clean install -Pdev,integration-test
```

---

## 6. Best Practices

### 1. DependencyManagement in Parent

**✓ DO: Centralize versions in parent**

```xml
<!-- Parent POM -->
<dependencyManagement>
    <dependencies>
        <!-- Spring Boot BOM -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>3.1.5</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        
        <!-- Internal modules -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
            <version>${project.version}</version>
        </dependency>
        
        <!-- Third-party -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <version>1.18.30</version>
        </dependency>
    </dependencies>
</dependencyManagement>
```

**✓ DO: Omit versions in child modules**

```xml
<!-- Child POM -->
<dependencies>
    <dependency>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-common</artifactId>
        <!-- No version - comes from parent -->
    </dependency>
    
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <!-- No version - comes from parent -->
        <scope>provided</scope>
    </dependency>
</dependencies>
```

**✗ DON'T: Hardcode versions in child modules**

```xml
<!-- BAD: Version should be in parent's dependencyManagement -->
<dependency>
    <groupId>org.projectlombok</groupId>
    <artifactId>lombok</artifactId>
    <version>1.18.30</version> <!-- ✗ Don't do this -->
</dependency>
```

---

### 2. PluginManagement in Parent

**✓ DO: Configure plugin versions in parent**

```xml
<!-- Parent POM -->
<build>
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
                <configuration>
                    <source>17</source>
                    <target>17</target>
                    <annotationProcessorPaths>
                        <path>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                            <version>${lombok.version}</version>
                        </path>
                    </annotationProcessorPaths>
                </configuration>
            </plugin>
            
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <version>3.1.5</version>
                <executions>
                    <execution>
                        <goals>
                            <goal>repackage</goal>
                        </goals>
                    </execution>
                </executions>
            </plugin>
        </plugins>
    </pluginManagement>
</build>
```

**✓ DO: Use plugins in child without version**

```xml
<!-- Child POM -->
<build>
    <plugins>
        <!-- Version and configuration inherited from parent -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
        </plugin>
    </plugins>
</build>
```

---

### 3. Properties in Parent

**✓ DO: Define common properties in parent**

```xml
<!-- Parent POM -->
<properties>
    <!-- Java version -->
    <java.version>17</java.version>
    <maven.compiler.source>${java.version}</maven.compiler.source>
    <maven.compiler.target>${java.version}</maven.compiler.target>
    
    <!-- Encoding -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    
    <!-- Framework versions -->
    <spring-boot.version>3.1.5</spring-boot.version>
    <spring-cloud.version>2022.0.4</spring-cloud.version>
    
    <!-- Library versions -->
    <lombok.version>1.18.30</lombok.version>
    <mapstruct.version>1.5.5.Final</mapstruct.version>
    
    <!-- Plugin versions -->
    <maven-compiler-plugin.version>3.11.0</maven-compiler-plugin.version>
    <jacoco-maven-plugin.version>0.8.10</jacoco-maven-plugin.version>
    
    <!-- Test configuration -->
    <skipTests>false</skipTests>
    <skipITs>false</skipITs>
</properties>
```

**✓ DO: Override properties in child if needed**

```xml
<!-- Child POM - override for specific module -->
<properties>
    <!-- Use Java 21 for this module only -->
    <maven.compiler.source>21</maven.compiler.source>
    <maven.compiler.target>21</maven.compiler.target>
</properties>
```

---

### 4. Module Organization

**✓ DO: Organize by layers or features**

```
# Layer-based (traditional)
ecommerce-platform/
├── ecommerce-domain/       # Domain models
├── ecommerce-service/      # Business logic
├── ecommerce-repository/   # Data access
└── ecommerce-web/          # Web layer

# Feature-based (microservices)
ecommerce-platform/
├── ecommerce-common/       # Shared code
├── user-service/           # User management
├── order-service/          # Order processing
└── payment-service/        # Payment handling
```

**✓ DO: Keep common code in shared module**

```
ecommerce-common/
└── src/main/java/
    ├── dto/            # Data Transfer Objects
    ├── util/           # Utility classes
    ├── exception/      # Custom exceptions
    └── constant/       # Constants
```

---

### 5. Dependency Scope Best Practices

**✓ DO: Use appropriate scopes**

```xml
<!-- Compile-time only -->
<dependency>
    <groupId>org.projectlombok</groupId>
    <artifactId>lombok</artifactId>
    <scope>provided</scope>
</dependency>

<!-- Runtime only -->
<dependency>
    <groupId>org.postgresql</groupId>
    <artifactId>postgresql</artifactId>
    <scope>runtime</scope>
</dependency>

<!-- Test only -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <scope>test</scope>
</dependency>
```

---

### 6. Version Management

**✓ DO: Use ${project.version} for internal modules**

```xml
<!-- Parent POM -->
<dependencyManagement>
    <dependencies>
        <!-- Always use ${project.version} for internal modules -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
            <version>${project.version}</version>
        </dependency>
    </dependencies>
</dependencyManagement>
```

**✓ DO: Use single version for parent and all modules**

```xml
<!-- Parent: version 1.0.0-SNAPSHOT -->
<groupId>com.company.ecommerce</groupId>
<artifactId>ecommerce-platform</artifactId>
<version>1.0.0-SNAPSHOT</version>

<!-- All children inherit same version -->
```

**✓ DO: Use versions:set to update all module versions**

```bash
# Update all module versions at once
mvn versions:set -DnewVersion=2.0.0-SNAPSHOT

# Commit the change
mvn versions:commit

# Or revert
mvn versions:revert
```

---

### 7. Build Performance

**✓ DO: Use parallel builds**

```bash
# Build with 4 threads
mvn clean install -T 4

# Build with 1 thread per CPU core
mvn clean install -T 1C
```

**✓ DO: Skip unnecessary modules**

```bash
# Skip modules that haven't changed
mvn clean install -pl changed-module -am

# Build only affected modules
mvn clean install -pl module-a,module-b
```

**✓ DO: Use incremental builds**

```bash
# Maven already does incremental compilation
# Just run without 'clean' when possible
mvn install
```

---

### 8. Testing Strategy

**✓ DO: Run unit tests in each module**

```xml
<!-- Each module has its own tests -->
src/
├── main/java/
└── test/java/
    ├── unit/
    └── integration/
```

**✓ DO: Run integration tests at verify phase**

```bash
# Unit tests only
mvn test

# Unit + Integration tests
mvn verify
```

**✓ DO: Create separate test module for E2E tests**

```
ecommerce-platform/
├── ecommerce-common/
├── user-service/
├── order-service/
└── integration-tests/    # E2E tests
    └── src/test/java/
        └── e2e/
```

---

### 9. Documentation

**✓ DO: Document module structure in README**

````markdown
# E-Commerce Platform

## Module Structure

- `ecommerce-common` - Shared utilities and DTOs
- `ecommerce-api` - API contracts and interfaces
- `user-service` - User management microservice
- `order-service` - Order processing microservice
- `payment-service` - Payment handling microservice
- `web-app` - Frontend web application

## Build Instructions

```bash
# Build all modules
mvn clean install

# Build specific module
mvn clean install -pl user-service -am
````

## Module Dependencies

```
common ← api ← services ← web-app
```

```

---

## 7. Common Patterns

### Pattern 1: Common + API + Services

```

project/ ├── common/ # Shared utilities ├── api/ # API contracts ├── service-a/ # Implementation ├── service-b/ # Implementation └── service-c/ # Implementation

```

### Pattern 2: Domain-Driven Design

```

project/ ├── domain/ # Domain models ├── application/ # Use cases ├── infrastructure/ # External adapters └── presentation/ # Controllers/UI

```

### Pattern 3: Microservices

```

project/ ├── common/ # Shared code ├── user-service/ # User microservice ├── order-service/ # Order microservice ├── gateway/ # API Gateway └── config/ # Configuration service

```

---

## 8. Troubleshooting

### Circular Dependencies

**Problem:**
```

Module A depends on Module B Module B depends on Module A → Build fails with circular dependency error

```

**Solution:**
```

Create Module C with shared code Module A depends on Module C Module B depends on Module C

```

### Version Conflicts

**Problem:**
```

Different modules use different versions of same dependency

````

**Solution:**
```xml
<!-- Use dependencyManagement in parent -->
<dependencyManagement>
    <dependencies>
        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava</artifactId>
            <version>32.1.3-jre</version>
        </dependency>
    </dependencies>
</dependencyManagement>
````

### Build Order Issues

**Problem:**

```
Module builds before its dependency
```

**Solution:**

```bash
# Check reactor order
mvn clean install -X | grep "Reactor Build Order"

# Ensure dependencies are declared in child POMs
```

---

## Summary

### Key Concepts

1. **Parent POM** acts as both aggregator and configuration source
    
    - `<packaging>pom</packaging>`
    - Lists modules in `<modules>`
    - Provides `<dependencyManagement>` and `<pluginManagement>`
2. **Child Modules** inherit from parent
    
    - Reference parent via `<parent>`
    - Inherit groupId, version, and configuration
    - Add `<dependencies>` without versions
3. **Reactor** determines build order automatically
    
    - Based on inter-module dependencies
    - Can build specific modules with `-pl`, `-am`, `-amd`
4. **Best Practices:**
    
    - Centralize versions in parent
    - Use `${project.version}` for internal modules
    - Organize modules by layer or feature
    - Use appropriate dependency scopes

### Essential Commands

```bash
# Build all modules
mvn clean install

# Build specific module + dependencies
mvn clean install -pl user-service -am

# Build multiple modules
mvn clean install -pl user-service,order-service

# Build all except one
mvn clean install -pl !web-app

# Resume from specific module
mvn clean install -rf payment-service

# Parallel build
mvn clean install -T 4

# Update version across all modules
mvn versions:set -DnewVersion=2.0.0
```

