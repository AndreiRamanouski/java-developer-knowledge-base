## Overview

The POM (Project Object Model) is the fundamental unit of work in Maven. It's an XML file that contains all information about the project and configuration details used by Maven to build the project.

```
┌─────────────────────────────────────────────────────────────────┐
│                      POM HIERARCHY                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Super POM (Maven's built-in defaults)                         │
│       ↓                                                         │
│  Parent POM (Organization/Team standards)                      │
│       ↓                                                         │
│  Your Project POM (Project-specific config)                    │
│       ↓                                                         │
│  Effective POM (Final merged result)                           │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. POM Structure

### Basic POM Elements

Every POM must contain these fundamental elements:

```xml
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0
                             http://maven.apache.org/xsd/maven-4.0.0.xsd">
    
    <!-- REQUIRED: POM model version -->
    <modelVersion>4.0.0</modelVersion>
    
    <!-- REQUIRED: Project coordinates (GAV) -->
    <groupId>com.company.application</groupId>
    <artifactId>my-service</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    
    <!-- OPTIONAL: Packaging type (default: jar) -->
    <packaging>jar</packaging>
</project>
```

---

### ModelVersion

```xml
<modelVersion>4.0.0</modelVersion>
```

**Purpose:**

- Specifies which POM model to use
- Always `4.0.0` for Maven 2 and 3
- Required in every POM
- Indicates POM structure version, not Maven version

**History:**

```
Maven 1.x → modelVersion 3.0.0 (deprecated)
Maven 2.x → modelVersion 4.0.0 (current)
Maven 3.x → modelVersion 4.0.0 (same as Maven 2)
Maven 4.x → modelVersion 4.0.0 (likely to stay)
```

---

### GroupId

```xml
<groupId>com.company.application</groupId>
```

**Purpose:**

- Identifies the organization or group
- Creates a namespace for projects
- Typically uses reverse domain name

**Conventions:**

```xml
<!-- Company domain -->
<groupId>com.google</groupId>
<groupId>org.springframework</groupId>
<groupId>io.github.username</groupId>

<!-- Organizational structure -->
<groupId>com.company</groupId>              <!-- Root -->
<groupId>com.company.platform</groupId>     <!-- Platform team -->
<groupId>com.company.platform.core</groupId> <!-- Core component -->

<!-- Open source projects -->
<groupId>org.apache.commons</groupId>
<groupId>org.hibernate</groupId>
```

**Best Practices:**

```xml
<!-- ✓ GOOD: Clear organizational hierarchy -->
<groupId>com.acme.ecommerce</groupId>

<!-- ✗ BAD: Too generic -->
<groupId>com.acme</groupId>

<!-- ✗ BAD: Inconsistent casing -->
<groupId>com.Acme.ECommerce</groupId>

<!-- ✓ GOOD: Descriptive and specific -->
<groupId>com.acme.ecommerce.payment</groupId>
```

---

### ArtifactId

```xml
<artifactId>user-service</artifactId>
```

**Purpose:**

- Name of the project/module
- Must be unique within the groupId
- Becomes the name of the JAR/WAR file

**Conventions:**

```xml
<!-- ✓ GOOD: Lowercase with hyphens -->
<artifactId>user-service</artifactId>
<artifactId>payment-gateway</artifactId>
<artifactId>order-management</artifactId>

<!-- ✗ BAD: CamelCase -->
<artifactId>UserService</artifactId>

<!-- ✗ BAD: Underscores -->
<artifactId>user_service</artifactId>

<!-- ✗ BAD: Spaces -->
<artifactId>user service</artifactId>
```

**Naming Patterns:**

```xml
<!-- Service pattern -->
<artifactId>authentication-service</artifactId>
<artifactId>notification-service</artifactId>

<!-- Library pattern -->
<artifactId>common-utils</artifactId>
<artifactId>data-models</artifactId>

<!-- Web application pattern -->
<artifactId>admin-portal</artifactId>
<artifactId>customer-web</artifactId>

<!-- Module pattern (multi-module project) -->
<artifactId>myapp-core</artifactId>
<artifactId>myapp-api</artifactId>
<artifactId>myapp-web</artifactId>
```

**Final Artifact Names:**

```
artifactId: user-service
version: 1.0.0

Results in:
  user-service-1.0.0.jar
  user-service-1.0.0-sources.jar
  user-service-1.0.0-javadoc.jar
```

---

### Version

```xml
<version>1.0.0-SNAPSHOT</version>
```

**Purpose:**

- Identifies the specific release of the project
- Distinguishes between development and release versions
- Controls dependency resolution

**Version Types:**

```
┌────────────────────────────────────────────────────────────┐
│               SNAPSHOT vs RELEASE                          │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  SNAPSHOT Versions:                                        │
│  - 1.0.0-SNAPSHOT                                         │
│  - Always in development                                   │
│  - Maven re-downloads every build (or daily)              │
│  - Can be overwritten in repository                       │
│  - Never use in production                                │
│                                                            │
│  RELEASE Versions:                                         │
│  - 1.0.0                                                   │
│  - Stable, immutable                                       │
│  - Cached locally after first download                    │
│  - Cannot be overwritten (should not)                     │
│  - Safe for production                                     │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Semantic Versioning (SemVer):**

```
MAJOR.MINOR.PATCH-QUALIFIER

Examples:
  1.0.0           # Major: 1, Minor: 0, Patch: 0
  2.1.3           # Major: 2, Minor: 1, Patch: 3
  1.0.0-SNAPSHOT  # Development version
  1.0.0-RC1       # Release Candidate 1
  1.0.0-beta      # Beta version
  1.0.0-alpha     # Alpha version

Increment rules:
  MAJOR: Breaking changes (incompatible API)
  MINOR: New features (backward compatible)
  PATCH: Bug fixes (backward compatible)
```

**Common Version Patterns:**

```xml
<!-- Development -->
<version>1.0.0-SNAPSHOT</version>

<!-- Pre-release -->
<version>1.0.0-alpha</version>
<version>1.0.0-beta</version>
<version>1.0.0-RC1</version>  <!-- Release Candidate -->

<!-- Release -->
<version>1.0.0</version>

<!-- Patch release -->
<version>1.0.1</version>

<!-- Minor release -->
<version>1.1.0</version>

<!-- Major release -->
<version>2.0.0</version>
```

**Version Variables:**

```xml
<!-- Use property for consistency across multi-module projects -->
<properties>
    <revision>1.0.0-SNAPSHOT</revision>
</properties>

<!-- Reference in version -->
<version>${revision}</version>

<!-- Or use Maven CI Friendly Versions -->
<version>${changelist}</version>
```

---

### Packaging

```xml
<packaging>jar</packaging>
```

**Purpose:**

- Defines the type of artifact to produce
- Determines the build lifecycle
- Default is `jar` if not specified

**Common Packaging Types:**

```xml
<!-- JAR: Java Archive (default) -->
<packaging>jar</packaging>
<!-- Use for:
     - Libraries
     - Spring Boot applications
     - Command-line applications
     - Microservices
-->

<!-- WAR: Web Application Archive -->
<packaging>war</packaging>
<!-- Use for:
     - Traditional web applications
     - Applications deployed to Tomcat/JBoss/WebLogic
     - Servlet-based applications
-->

<!-- POM: Project Object Model -->
<packaging>pom</packaging>
<!-- Use for:
     - Parent POMs
     - Aggregator POMs (multi-module projects)
     - Projects that don't produce artifacts
-->

<!-- EAR: Enterprise Archive -->
<packaging>ear</packaging>
<!-- Use for:
     - Java EE applications
     - Applications with EJBs
     - Full Java EE stack deployments
-->

<!-- Maven Plugin -->
<packaging>maven-plugin</packaging>
<!-- Use for:
     - Creating custom Maven plugins
-->
```

**Packaging Impact on Build:**

```
JAR packaging lifecycle:
  process-resources → compile → process-test-resources → 
  test-compile → test → package (creates JAR)

WAR packaging lifecycle:
  process-resources → compile → process-test-resources → 
  test-compile → test → prepare-package → package (creates WAR)

POM packaging lifecycle:
  install → deploy
  (skips compile, test, package phases)
```

**Output Examples:**

```bash
# JAR packaging
target/
  └── my-service-1.0.0.jar
        ├── com/company/app/Main.class
        ├── application.properties
        └── META-INF/MANIFEST.MF

# WAR packaging
target/
  └── my-webapp-1.0.0.war
        ├── WEB-INF/
        │   ├── classes/
        │   ├── lib/
        │   └── web.xml
        ├── index.html
        └── static/

# POM packaging
target/
  (no artifact produced, just installs POM to repository)
```

---

## 2. POM Relationships

### Parent POM (Inheritance)

Parent POMs allow sharing common configuration across multiple projects.

**Parent POM Example:**

```xml
<!-- parent-pom/pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.company</groupId>
    <artifactId>company-parent</artifactId>
    <version>1.0.0</version>
    <packaging>pom</packaging>
    
    <properties>
        <!-- Java version for all projects -->
        <java.version>17</java.version>
        <maven.compiler.source>${java.version}</maven.compiler.source>
        <maven.compiler.target>${java.version}</maven.compiler.target>
        
        <!-- Dependency versions -->
        <spring-boot.version>3.1.5</spring-boot.version>
        <lombok.version>1.18.30</lombok.version>
        <junit.version>5.10.0</junit.version>
    </properties>
    
    <dependencyManagement>
        <dependencies>
            <!-- Spring Boot BOM -->
            <dependency>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-dependencies</artifactId>
                <version>${spring-boot.version}</version>
                <type>pom</type>
                <scope>import</scope>
            </dependency>
            
            <!-- Common dependencies with versions -->
            <dependency>
                <groupId>org.projectlombok</groupId>
                <artifactId>lombok</artifactId>
                <version>${lombok.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>
    
    <build>
        <pluginManagement>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>3.11.0</version>
                    <configuration>
                        <source>${java.version}</source>
                        <target>${java.version}</target>
                    </configuration>
                </plugin>
            </plugins>
        </pluginManagement>
    </build>
</project>
```

**Child POM Example:**

```xml
<!-- service/pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <!-- Inherit from parent -->
    <parent>
        <groupId>com.company</groupId>
        <artifactId>company-parent</artifactId>
        <version>1.0.0</version>
        <!-- Relative path to parent (optional) -->
        <relativePath>../parent-pom/pom.xml</relativePath>
    </parent>
    
    <!-- Only need artifactId (inherits groupId and version) -->
    <artifactId>user-service</artifactId>
    
    <dependencies>
        <!-- No version needed - comes from parent -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
        </dependency>
    </dependencies>
</project>
```

**What Gets Inherited:**

```
From Parent POM:
  ✓ groupId (if not specified in child)
  ✓ version (if not specified in child)
  ✓ properties
  ✓ dependencyManagement
  ✓ dependencies
  ✓ pluginManagement
  ✓ plugins
  ✓ repositories
  ✓ build configuration

Child Can Override:
  ✓ Any property
  ✓ Add more dependencies
  ✓ Configure plugins differently
  ✓ Add repositories
```

**Relative Path:**

```xml
<!-- Default: looks in ../pom.xml -->
<parent>
    <groupId>com.company</groupId>
    <artifactId>parent</artifactId>
    <version>1.0.0</version>
</parent>

<!-- Custom location -->
<parent>
    <groupId>com.company</groupId>
    <artifactId>parent</artifactId>
    <version>1.0.0</version>
    <relativePath>../../parent/pom.xml</relativePath>
</parent>

<!-- Repository only (not in filesystem) -->
<parent>
    <groupId>com.company</groupId>
    <artifactId>parent</artifactId>
    <version>1.0.0</version>
    <relativePath/>  <!-- Empty means repository only -->
</parent>
```

---

### Aggregator POM (Multi-Module Projects)

Aggregator POMs build multiple modules together as a single unit.

**Aggregator POM:**

```xml
<!-- root/pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <groupId>com.company.ecommerce</groupId>
    <artifactId>ecommerce-parent</artifactId>
    <version>1.0.0-SNAPSHOT</version>
    <packaging>pom</packaging>
    
    <!-- List of modules to build -->
    <modules>
        <module>ecommerce-common</module>
        <module>ecommerce-api</module>
        <module>user-service</module>
        <module>order-service</module>
        <module>payment-service</module>
    </modules>
    
    <!-- Shared configuration for all modules -->
    <properties>
        <java.version>17</java.version>
    </properties>
    
    <dependencyManagement>
        <dependencies>
            <!-- Internal modules -->
            <dependency>
                <groupId>com.company.ecommerce</groupId>
                <artifactId>ecommerce-common</artifactId>
                <version>${project.version}</version>
            </dependency>
        </dependencies>
    </dependencyManagement>
</project>
```

**Project Structure:**

```
ecommerce-parent/
├── pom.xml                    # Aggregator + Parent POM
├── ecommerce-common/
│   ├── pom.xml
│   └── src/
├── ecommerce-api/
│   ├── pom.xml
│   └── src/
├── user-service/
│   ├── pom.xml
│   └── src/
├── order-service/
│   ├── pom.xml
│   └── src/
└── payment-service/
    ├── pom.xml
    └── src/
```

**Module POM:**

```xml
<!-- user-service/pom.xml -->
<project>
    <modelVersion>4.0.0</modelVersion>
    
    <!-- Reference parent -->
    <parent>
        <groupId>com.company.ecommerce</groupId>
        <artifactId>ecommerce-parent</artifactId>
        <version>1.0.0-SNAPSHOT</version>
    </parent>
    
    <artifactId>user-service</artifactId>
    
    <dependencies>
        <!-- Depend on other modules -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
        </dependency>
    </dependencies>
</project>
```

**Build Behavior:**

```bash
# From root directory
mvn clean install

# Maven determines build order automatically
# Based on inter-module dependencies

Build order:
  1. ecommerce-common    (no dependencies)
  2. ecommerce-api       (depends on common)
  3. user-service        (depends on common)
  4. order-service       (depends on common, api)
  5. payment-service     (depends on common, order)
```

**Build Specific Module:**

```bash
# Build one module and its dependencies
mvn clean install -pl user-service -am

# Build one module only
mvn clean install -pl user-service

# Build all except one module
mvn clean install -pl !payment-service

# Build multiple modules
mvn clean install -pl user-service,order-service
```

**Parent vs Aggregator:**

```
Parent POM:
  - Provides shared configuration
  - Child POMs reference via <parent>
  - Inheritance relationship

Aggregator POM:
  - Lists modules to build together
  - Lists modules via <modules>
  - Composition relationship

Often Combined:
  - One POM acts as both parent and aggregator
  - packaging=pom required for both
```

---

### Super POM

The Super POM is Maven's built-in default POM that all POMs inherit from.

**Location:**

```
Inside Maven installation:
  maven-model-builder-x.x.x.jar
  org/apache/maven/model/pom-4.0.0.xml
```

**What Super POM Provides:**

```xml
<!-- Simplified view of Super POM -->
<project>
    <!-- Central Repository -->
    <repositories>
        <repository>
            <id>central</id>
            <name>Central Repository</name>
            <url>https://repo.maven.apache.org/maven2</url>
        </repository>
    </repositories>
    
    <!-- Plugin Repository -->
    <pluginRepositories>
        <pluginRepository>
            <id>central</id>
            <name>Central Repository</name>
            <url>https://repo.maven.apache.org/maven2</url>
        </pluginRepository>
    </pluginRepositories>
    
    <!-- Default directories -->
    <build>
        <directory>${project.basedir}/target</directory>
        <outputDirectory>${project.build.directory}/classes</outputDirectory>
        <finalName>${project.artifactId}-${project.version}</finalName>
        <sourceDirectory>${project.basedir}/src/main/java</sourceDirectory>
        <scriptSourceDirectory>${project.basedir}/src/main/scripts</scriptSourceDirectory>
        <testSourceDirectory>${project.basedir}/src/test/java</testSourceDirectory>
        
        <!-- Default plugins -->
        <pluginManagement>
            <plugins>
                <plugin>
                    <artifactId>maven-compiler-plugin</artifactId>
                    <version>3.1</version>
                </plugin>
                <!-- ... many more default plugins ... -->
            </plugins>
        </pluginManagement>
    </build>
</project>
```

**View Effective POM:**

```bash
# See final merged POM (Super + Parent + Your POM)
mvn help:effective-pom

# Save to file
mvn help:effective-pom -Doutput=effective-pom.xml

# See effective POM for specific module
mvn help:effective-pom -pl user-service
```

**Inheritance Chain:**

```
Super POM (Maven built-in)
    ↓
Spring Boot Parent (if using Spring Boot)
    ↓
Company Parent POM (if you have one)
    ↓
Your Project POM
    ↓
Effective POM (final result)
```

---

## 3. Essential POM Sections

### Properties

Properties are variables that can be referenced throughout the POM.

```xml
<properties>
    <!-- Java version -->
    <java.version>17</java.version>
    <maven.compiler.source>${java.version}</maven.compiler.source>
    <maven.compiler.target>${java.version}</maven.compiler.target>
    
    <!-- Encoding -->
    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
    <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
    
    <!-- Dependency versions -->
    <spring-boot.version>3.1.5</spring-boot.version>
    <lombok.version>1.18.30</lombok.version>
    <junit.version>5.10.0</junit.version>
    <mockito.version>5.5.0</mockito.version>
    
    <!-- Plugin versions -->
    <maven-compiler-plugin.version>3.11.0</maven-compiler-plugin.version>
    <maven-surefire-plugin.version>3.0.0</maven-surefire-plugin.version>
    
    <!-- Application properties -->
    <app.main.class>com.company.app.Main</app.main.class>
    <docker.image.prefix>company</docker.image.prefix>
</properties>
```

**Built-in Properties:**

```xml
<!-- Project properties -->
${project.groupId}              <!-- com.company.app -->
${project.artifactId}           <!-- my-service -->
${project.version}              <!-- 1.0.0-SNAPSHOT -->
${project.name}                 <!-- Project Name -->
${project.description}          <!-- Project description -->

<!-- Project directories -->
${project.basedir}              <!-- /path/to/project -->
${project.build.directory}      <!-- target/ -->
${project.build.outputDirectory} <!-- target/classes -->
${project.build.sourceDirectory} <!-- src/main/java -->

<!-- Settings properties -->
${settings.localRepository}     <!-- ~/.m2/repository -->

<!-- Environment variables -->
${env.PATH}                     <!-- System PATH -->
${env.HOME}                     <!-- User home directory -->
${env.JAVA_HOME}                <!-- Java installation -->

<!-- System properties -->
${java.version}                 <!-- Java version -->
${user.name}                    <!-- Current user -->
${user.home}                    <!-- User home -->
${os.name}                      <!-- Operating system -->
```

**Using Properties:**

```xml
<!-- Define property -->
<properties>
    <spring.version>5.3.20</spring.version>
</properties>

<!-- Reference in dependency -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
    <version>${spring.version}</version>
</dependency>

<!-- Reference in plugin -->
<plugin>
    <configuration>
        <mainClass>${app.main.class}</mainClass>
    </configuration>
</plugin>

<!-- Reference in resource filtering -->
<!-- src/main/resources/application.properties -->
app.version=${project.version}
app.name=${project.name}
```

**Property Precedence (highest to lowest):**

```
1. System properties (-D from command line)
   mvn install -Dspring.version=5.3.21

2. User settings.xml (~/.m2/settings.xml)
   <properties><spring.version>5.3.21</spring.version></properties>

3. Project properties (pom.xml)
   <properties><spring.version>5.3.20</spring.version></properties>

4. Parent POM properties

5. Super POM properties
```

---

### Dependencies

Dependencies are external libraries your project needs.

```xml
<dependencies>
    <!-- Spring Boot Starter Web -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
        <version>3.1.5</version>
    </dependency>
    
    <!-- Lombok (compile-time) -->
    <dependency>
        <groupId>org.projectlombok</groupId>
        <artifactId>lombok</artifactId>
        <version>1.18.30</version>
        <scope>provided</scope>
    </dependency>
    
    <!-- JUnit (test-only) -->
    <dependency>
        <groupId>org.junit.jupiter</groupId>
        <artifactId>junit-jupiter</artifactId>
        <version>5.10.0</version>
        <scope>test</scope>
    </dependency>
    
    <!-- PostgreSQL Driver (runtime) -->
    <dependency>
        <groupId>org.postgresql</groupId>
        <artifactId>postgresql</artifactId>
        <version>42.6.0</version>
        <scope>runtime</scope>
    </dependency>
    
    <!-- Exclude transitive dependency -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-logging</artifactId>
        <exclusions>
            <exclusion>
                <groupId>ch.qos.logback</groupId>
                <artifactId>logback-classic</artifactId>
            </exclusion>
        </exclusions>
    </dependency>
    
    <!-- Optional dependency -->
    <dependency>
        <groupId>com.h2database</groupId>
        <artifactId>h2</artifactId>
        <version>2.2.220</version>
        <optional>true</optional>
    </dependency>
</dependencies>
```

**Dependency Scopes:**

```
┌────────────────────────────────────────────────────────────┐
│                  DEPENDENCY SCOPES                         │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  compile (default):                                        │
│  - Available in all classpaths                            │
│  - Packaged with application                              │
│  - Transitive (downstream projects get it)                │
│  Example: Spring Boot, Jackson                            │
│                                                            │
│  provided:                                                 │
│  - Available during compile and test                      │
│  - NOT packaged (container provides it)                   │
│  - NOT transitive                                          │
│  Example: Servlet API, Lombok                             │
│                                                            │
│  runtime:                                                  │
│  - NOT available during compile                           │
│  - Available during execution and test                    │
│  - Packaged with application                              │
│  Example: JDBC drivers, SLF4J implementations             │
│                                                            │
│  test:                                                     │
│  - Available only during test compile and execution       │
│  - NOT packaged                                            │
│  - NOT transitive                                          │
│  Example: JUnit, Mockito, Test containers                │
│                                                            │
│  system:                                                   │
│  - Like 'provided' but must specify path                  │
│  - NOT recommended (use local repository instead)         │
│                                                            │
│  import:                                                   │
│  - Only for <type>pom</type> in dependencyManagement     │
│  - Imports managed dependencies from BOM                  │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**Scope Examples:**

```xml
<!-- compile: Used in code, packaged in JAR -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
    <version>3.1.5</version>
    <scope>compile</scope> <!-- or omit, it's default -->
</dependency>

<!-- provided: Compile-time only (Lombok, Servlet API) -->
<dependency>
    <groupId>org.projectlombok</groupId>
    <artifactId>lombok</artifactId>
    <version>1.18.30</version>
    <scope>provided</scope>
</dependency>

<!-- runtime: Not needed at compile time (JDBC drivers) -->
<dependency>
    <groupId>org.postgresql</groupId>
    <artifactId>postgresql</artifactId>
    <version>42.6.0</version>
    <scope>runtime</scope>
</dependency>

<!-- test: Only for tests -->
<dependency>
    <groupId>org.junit.jupiter</groupId>
    <artifactId>junit-jupiter</artifactId>
    <version>5.10.0</version>
    <scope>test</scope>
</dependency>
```

**Transitive Dependencies:**

```
Your Project
  └── depends on Spring Web
       └── depends on Spring Core
            └── depends on Commons Logging

All three are included automatically!
```

**Excluding Transitive Dependencies:**

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
    <exclusions>
        <!-- Don't want Tomcat, using Jetty instead -->
        <exclusion>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-tomcat</artifactId>
        </exclusion>
    </exclusions>
</dependency>

<!-- Use Jetty instead -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jetty</artifactId>
</dependency>
```

**Optional Dependencies:**

```xml
<!-- Optional: downstream projects must explicitly include it -->
<dependency>
    <groupId>com.h2database</groupId>
    <artifactId>h2</artifactId>
    <version>2.2.220</version>
    <optional>true</optional>
</dependency>
```

---

### DependencyManagement

DependencyManagement centralizes version control without actually adding dependencies.

```xml
<dependencyManagement>
    <dependencies>
        <!-- Import Spring Boot BOM -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>3.1.5</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        
        <!-- Define versions for internal modules -->
        <dependency>
            <groupId>com.company.ecommerce</groupId>
            <artifactId>ecommerce-common</artifactId>
            <version>${project.version}</version>
        </dependency>
        
        <!-- Define versions for third-party libraries -->
        <dependency>
            <groupId>com.google.guava</groupId>
            <artifactId>guava</artifactId>
            <version>32.1.3-jre</version>
        </dependency>
    </dependencies>
</dependencyManagement>

<dependencies>
    <!-- No version needed - comes from dependencyManagement -->
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
    </dependency>
    
    <dependency>
        <groupId>com.google.guava</groupId>
        <artifactId>guava</artifactId>
    </dependency>
</dependencies>
```

**DependencyManagement vs Dependencies:**

```
┌────────────────────────────────────────────────────────────┐
│         dependencyManagement vs dependencies               │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  <dependencyManagement>:                                   │
│  - Declares versions only                                  │
│  - Does NOT add dependencies to project                   │
│  - Used in parent POMs                                     │
│  - Child POMs inherit version management                  │
│                                                            │
│  <dependencies>:                                           │
│  - Actually adds dependencies to project                   │
│  - Can omit version if in dependencyManagement            │
│  - Used in actual project POMs                            │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

**BOM (Bill of Materials):**

```xml
<!-- Import BOM to manage many related dependencies -->
<dependencyManagement>
    <dependencies>
        <!-- Spring Boot BOM -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>3.1.5</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        
        <!-- Spring Cloud BOM -->
        <dependency>
            <groupId>org.springframework.cloud</groupId>
            <artifactId>spring-cloud-dependencies</artifactId>
            <version>2022.0.4</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        
        <!-- AWS SDK BOM -->
        <dependency>
            <groupId>software.amazon.awssdk</groupId>
            <artifactId>bom</artifactId>
            <version>2.20.160</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
    </dependencies>
</dependencyManagement>

<!-- Now use without versions -->
<dependencies>
    <dependency>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-web</artifactId>
        <!-- Version from Spring Boot BOM -->
    </dependency>
    
    <dependency>
        <groupId>org.springframework.cloud</groupId>
        <artifactId>spring-cloud-starter-config</artifactId>
        <!-- Version from Spring Cloud BOM -->
    </dependency>
    
    <dependency>
        <groupId>software.amazon.awssdk</groupId>
        <artifactId>s3</artifactId>
        <!-- Version from AWS BOM -->
    </dependency>
</dependencies>
```

**Override BOM Version:**

```xml
<dependencyManagement>
    <dependencies>
        <!-- Import BOM -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-dependencies</artifactId>
            <version>3.1.5</version>
            <type>pom</type>
            <scope>import</scope>
        </dependency>
        
        <!-- Override specific version from BOM -->
        <dependency>
            <groupId>com.fasterxml.jackson.core</groupId>
            <artifactId>jackson-databind</artifactId>
            <version>2.15.3</version> <!-- Override BOM version -->
        </dependency>
    </dependencies>
</dependencyManagement>
```

---

### Build Section

The build section configures how Maven builds the project.

```xml
<build>
    <!-- Final artifact name -->
    <finalName>my-service</finalName>
    
    <!-- Source and resource directories (rarely need to override) -->
    <sourceDirectory>src/main/java</sourceDirectory>
    <testSourceDirectory>src/test/java</testSourceDirectory>
    
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <filtering>true</filtering> <!-- Enable variable substitution -->
            <includes>
                <include>**/*.properties</include>
                <include>**/*.yml</include>
            </includes>
        </resource>
    </resources>
    
    <!-- Plugin management (versions for plugins) -->
    <pluginManagement>
        <plugins>
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-compiler-plugin</artifactId>
                <version>3.11.0</version>
            </plugin>
        </plugins>
    </pluginManagement>
    
    <!-- Actual plugins to use -->
    <plugins>
        <!-- Compiler Plugin -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <configuration>
                <source>17</source>
                <target>17</target>
                <encoding>UTF-8</encoding>
            </configuration>
        </plugin>
        
        <!-- Surefire (Unit Tests) -->
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <configuration>
                <includes>
                    <include>**/*Test.java</include>
                    <include>**/*Tests.java</include>
                </includes>
            </configuration>
        </plugin>
        
        <!-- Spring Boot Plugin -->
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <executions>
                <execution>
                    <goals>
                        <goal>repackage</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Resource Filtering:**

```xml
<build>
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <filtering>true</filtering>
        </resource>
    </resources>
</build>

<!-- src/main/resources/application.properties -->
app.name=${project.name}
app.version=${project.version}
app.build.timestamp=${maven.build.timestamp}

<!-- After build, becomes: -->
app.name=My Application
app.version=1.0.0-SNAPSHOT
app.build.timestamp=2024-11-15T10:30:00Z
```

---

### Profiles

Profiles allow environment-specific configurations.

```xml
<profiles>
    <!-- Development Profile (active by default) -->
    <profile>
        <id>dev</id>
        <activation>
            <activeByDefault>true</activeByDefault>
        </activation>
        <properties>
            <env>development</env>
            <spring.profiles.active>dev</spring.profiles.active>
            <db.url>jdbc:postgresql://localhost:5432/devdb</db.url>
        </properties>
    </profile>
    
    <!-- Test Profile -->
    <profile>
        <id>test</id>
        <properties>
            <env>test</env>
            <spring.profiles.active>test</spring.profiles.active>
            <db.url>jdbc:postgresql://test-db:5432/testdb</db.url>
        </properties>
    </profile>
    
    <!-- Production Profile -->
    <profile>
        <id>prod</id>
        <properties>
            <env>production</env>
            <spring.profiles.active>prod</spring.profiles.active>
            <db.url>jdbc:postgresql://prod-db:5432/proddb</db.url>
        </properties>
        <build>
            <plugins>
                <!-- Additional optimizations for production -->
                <plugin>
                    <groupId>com.google.cloud.tools</groupId>
                    <artifactId>jib-maven-plugin</artifactId>
                    <configuration>
                        <to>
                            <image>company/my-service:${project.version}</image>
                        </to>
                    </configuration>
                </plugin>
            </plugins>
        </build>
    </profile>
    
    <!-- OS-specific profile -->
    <profile>
        <id>windows</id>
        <activation>
            <os>
                <family>windows</family>
            </os>
        </activation>
        <properties>
            <script.extension>.bat</script.extension>
        </properties>
    </profile>
    
    <!-- JDK-specific profile -->
    <profile>
        <id>jdk-17</id>
        <activation>
            <jdk>17</jdk>
        </activation>
        <properties>
            <maven.compiler.release>17</maven.compiler.release>
        </properties>
    </profile>
</profiles>
```

**Activating Profiles:**

```bash
# Activate profile via command line
mvn clean install -Ptest

# Multiple profiles
mvn clean install -Ptest,ci

# List active profiles
mvn help:active-profiles

# List all profiles
mvn help:all-profiles

# Activate in settings.xml
<settings>
    <activeProfiles>
        <activeProfile>dev</activeProfile>
    </activeProfiles>
</settings>
```

**Profile Activation Conditions:**

```xml
<profile>
    <id>conditional</id>
    <activation>
        <!-- Activate by default -->
        <activeByDefault>true</activeByDefault>
        
        <!-- Activate based on JDK version -->
        <jdk>17</jdk>
        
        <!-- Activate based on OS -->
        <os>
            <name>Windows 10</name>
            <family>Windows</family>
            <arch>amd64</arch>
        </os>
        
        <!-- Activate based on system property -->
        <property>
            <name>environment</name>
            <value>production</value>
        </property>
        
        <!-- Activate if file exists -->
        <file>
            <exists>config/production.properties</exists>
            <missing>config/development.properties</missing>
        </file>
    </activation>
</profile>
```

---

### Repositories and PluginRepositories

Configure where Maven downloads dependencies and plugins.

```xml
<repositories>
    <!-- Company Nexus Repository -->
    <repository>
        <id>company-nexus</id>
        <name>Company Nexus Repository</name>
        <url>https://nexus.company.com/repository/maven-public/</url>
        <releases>
            <enabled>true</enabled>
            <updatePolicy>never</updatePolicy> <!-- never, always, daily, interval:X -->
        </releases>
        <snapshots>
            <enabled>true</enabled>
            <updatePolicy>always</updatePolicy>
            <checksumPolicy>warn</checksumPolicy> <!-- fail, ignore, warn -->
        </snapshots>
    </repository>
    
    <!-- JitPack (for GitHub projects) -->
    <repository>
        <id>jitpack.io</id>
        <url>https://jitpack.io</url>
    </repository>
    
    <!-- Spring Milestones -->
    <repository>
        <id>spring-milestones</id>
        <name>Spring Milestones</name>
        <url>https://repo.spring.io/milestone</url>
        <snapshots>
            <enabled>false</enabled>
        </snapshots>
    </repository>
</repositories>

<pluginRepositories>
    <pluginRepository>
        <id>company-nexus-plugins</id>
        <name>Company Plugin Repository</name>
        <url>https://nexus.company.com/repository/maven-plugins/</url>
    </pluginRepository>
</pluginRepositories>
```

**Repository Authentication (in settings.xml):**

```xml
<!-- ~/.m2/settings.xml -->
<settings>
    <servers>
        <server>
            <id>company-nexus</id> <!-- Must match repository id -->
            <username>${env.NEXUS_USERNAME}</username>
            <password>${env.NEXUS_PASSWORD}</password>
        </server>
    </servers>
</settings>
```

**Mirror Configuration (in settings.xml):**

```xml
<!-- Force all dependencies through company repository -->
<settings>
    <mirrors>
        <mirror>
            <id>company-mirror</id>
            <name>Company Repository Mirror</name>
            <url>https://nexus.company.com/repository/maven-public/</url>
            <mirrorOf>*</mirrorOf> <!-- Mirror everything -->
        </mirror>
    </mirrors>
</settings>
```

---

## Summary

### POM Structure Hierarchy

```
<project>
  ├── modelVersion (4.0.0)
  ├── GAV Coordinates
  │   ├── groupId
  │   ├── artifactId
  │   └── version
  ├── packaging (jar/war/pom)
  ├── parent (inheritance)
  ├── modules (aggregation)
  ├── properties (variables)
  ├── dependencyManagement (version control)
  ├── dependencies (actual dependencies)
  ├── build
  │   ├── plugins
  │   └── pluginManagement
  ├── profiles (environment configs)
  └── repositories
```

### Key Takeaways

1. **Every POM inherits from Super POM** - Maven's built-in defaults
2. **Parent POMs share configuration** - Use for consistency across projects
3. **Aggregator POMs build modules together** - Multi-module projects
4. **DependencyManagement controls versions** - Without adding dependencies
5. **Dependencies section adds actual dependencies** - Can omit versions if managed
6. **Profiles enable environment-specific configs** - dev, test, prod
7. **Properties are variables** - Reusable throughout POM

### Best Practices

```xml
<!-- ✓ Use properties for versions -->
<properties>
    <spring.version>5.3.20</spring.version>
</properties>

<!-- ✓ Use dependencyManagement in parent POMs -->
<dependencyManagement>
    <dependencies>...</dependencies>
</dependencyManagement>

<!-- ✓ Omit versions in child POMs -->
<dependency>
    <groupId>org.springframework</groupId>
    <artifactId>spring-core</artifactId>
    <!-- Version from parent -->
</dependency>

<!-- ✓ Use BOMs for related dependencies -->
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-dependencies</artifactId>
    <type>pom</type>
    <scope>import</scope>
</dependency>

<!-- ✓ Use profiles for environments -->
<profiles>
    <profile><id>dev</id>...</profile>
    <profile><id>prod</id>...</profile>
</profiles>
```

