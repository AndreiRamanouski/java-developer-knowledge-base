## Overview

Plugins are the heart of Maven. Every task in Maven is performed by a plugin. Understanding how to configure and use plugins is essential for mastering Maven.

```
┌─────────────────────────────────────────────────────────────────┐
│                    MAVEN PLUGIN ARCHITECTURE                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Maven Core                                                     │
│       ↓                                                         │
│  Plugin Framework                                               │
│       ↓                                                         │
│  Plugin Goals (Mojos)                                          │
│       ↓                                                         │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐        │
│  │    Build     │  │    Report    │  │   Analysis   │        │
│  │   Plugins    │  │   Plugins    │  │   Plugins    │        │
│  │              │  │              │  │              │        │
│  │ • compiler   │  │ • surefire   │  │ • checkstyle │        │
│  │ • jar        │  │ • javadoc    │  │ • pmd        │        │
│  │ • war        │  │ • site       │  │ • jacoco     │        │
│  │ • shade      │  │              │  │ • enforcer   │        │
│  └──────────────┘  └──────────────┘  └──────────────┘        │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. Core Maven Plugins

### Maven Compiler Plugin

**Purpose:** Compile Java source code

**Default Binding:** compile, testCompile phases

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.11.0</version>
            <configuration>
                <!-- Java version -->
                <source>17</source>
                <target>17</target>
                
                <!-- Or use release (recommended for Java 9+) -->
                <release>17</release>
                
                <!-- Encoding -->
                <encoding>UTF-8</encoding>
                
                <!-- Show warnings and deprecations -->
                <showWarnings>true</showWarnings>
                <showDeprecation>true</showDeprecation>
                
                <!-- Compiler arguments -->
                <compilerArgs>
                    <arg>-parameters</arg>        <!-- Preserve parameter names -->
                    <arg>-Xlint:unchecked</arg>   <!-- Unchecked warnings -->
                    <arg>-Xlint:deprecation</arg> <!-- Deprecation warnings -->
                </compilerArgs>
                
                <!-- Annotation processors -->
                <annotationProcessorPaths>
                    <path>
                        <groupId>org.projectlombok</groupId>
                        <artifactId>lombok</artifactId>
                        <version>1.18.30</version>
                    </path>
                    <path>
                        <groupId>org.mapstruct</groupId>
                        <artifactId>mapstruct-processor</artifactId>
                        <version>1.5.5.Final</version>
                    </path>
                </annotationProcessorPaths>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**Using Properties (Recommended):**

```xml
<properties>
    <maven.compiler.source>17</maven.compiler.source>
    <maven.compiler.target>17</maven.compiler.target>
    <!-- Or -->
    <maven.compiler.release>17</maven.compiler.release>
</properties>
```

**Source vs Target vs Release:**

```
source:  Minimum Java version of your source code
target:  Java version of generated bytecode
release: Sets both source and target, plus cross-compilation
         (recommended for Java 9+)

Example:
  source=11, target=11  → Compile with Java 11 syntax to Java 11 bytecode
  release=11           → Same as above, but ensures Java 11 APIs only
```

**Common Use Cases:**

```xml
<!-- Java 8 project -->
<maven.compiler.release>8</maven.compiler.release>

<!-- Java 11 project -->
<maven.compiler.release>11</maven.compiler.release>

<!-- Java 17 project -->
<maven.compiler.release>17</maven.compiler.release>

<!-- Java 21 project -->
<maven.compiler.release>21</maven.compiler.release>

<!-- Multi-release JAR (advanced) -->
<plugin>
    <artifactId>maven-compiler-plugin</artifactId>
    <executions>
        <execution>
            <id>default-compile</id>
            <configuration>
                <release>8</release>
            </configuration>
        </execution>
        <execution>
            <id>java11-compile</id>
            <phase>compile</phase>
            <goals>
                <goal>compile</goal>
            </goals>
            <configuration>
                <release>11</release>
                <multiReleaseOutput>true</multiReleaseOutput>
            </configuration>
        </execution>
    </executions>
</plugin>
```

---

### Maven Surefire Plugin

**Purpose:** Run unit tests

**Default Binding:** test phase

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-surefire-plugin</artifactId>
            <version>3.1.2</version>
            <configuration>
                <!-- Test patterns -->
                <includes>
                    <include>**/*Test.java</include>
                    <include>**/*Tests.java</include>
                    <include>**/Test*.java</include>
                </includes>
                
                <excludes>
                    <exclude>**/*IT.java</exclude>
                    <exclude>**/*IntegrationTest.java</exclude>
                </excludes>
                
                <!-- Parallel execution -->
                <parallel>methods</parallel>
                <threadCount>4</threadCount>
                <perCoreThreadCount>true</perCoreThreadCount>
                
                <!-- Rerun failing tests -->
                <rerunFailingTestsCount>2</rerunFailingTestsCount>
                
                <!-- System properties -->
                <systemPropertyVariables>
                    <java.awt.headless>true</java.awt.headless>
                    <test.environment>unit</test.environment>
                </systemPropertyVariables>
                
                <!-- Argline for JaCoCo -->
                <argLine>
                    ${argLine}
                    -Xmx1024m
                    -XX:MaxPermSize=256m
                </argLine>
                
                <!-- Fail build if no tests -->
                <failIfNoTests>true</failIfNoTests>
                
                <!-- Skip tests -->
                <skipTests>${skipTests}</skipTests>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**Run Specific Tests:**

```bash
# Run single test class
mvn test -Dtest=UserServiceTest

# Run single test method
mvn test -Dtest=UserServiceTest#shouldCreateUser

# Run multiple test classes
mvn test -Dtest=UserServiceTest,OrderServiceTest

# Run tests matching pattern
mvn test -Dtest=*ServiceTest

# Run tests in package
mvn test -Dtest=com.company.service.*Test

# Exclude tests
mvn test -Dtest=!*IntegrationTest
```

**Parallel Execution:**

```xml
<configuration>
    <!-- Parallel options: methods, classes, both, suites, classesAndMethods -->
    <parallel>methods</parallel>
    
    <!-- Fixed thread count -->
    <threadCount>4</threadCount>
    
    <!-- Or per-core thread count -->
    <perCoreThreadCount>true</perCoreThreadCount>
    <threadCountClasses>2</threadCountClasses>
    <threadCountMethods>4</threadCountMethods>
</configuration>
```

**Test Reports:**

```
target/surefire-reports/
├── com.company.UserServiceTest.txt
├── TEST-com.company.UserServiceTest.xml
└── surefire-summary.txt
```

---

### Maven Failsafe Plugin

**Purpose:** Run integration tests

**Default Binding:** integration-test, verify phases

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-failsafe-plugin</artifactId>
            <version>3.1.2</version>
            <configuration>
                <!-- Integration test patterns -->
                <includes>
                    <include>**/*IT.java</include>
                    <include>**/*IntegrationTest.java</include>
                </includes>
                
                <!-- System properties -->
                <systemPropertyVariables>
                    <test.environment>integration</test.environment>
                    <db.url>jdbc:h2:mem:testdb</db.url>
                </systemPropertyVariables>
                
                <!-- Longer timeout for integration tests -->
                <forkedProcessTimeoutInSeconds>1800</forkedProcessTimeoutInSeconds>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <goal>integration-test</goal>
                        <goal>verify</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Why Failsafe Instead of Surefire:**

```
Surefire (Unit Tests):
  - Runs in 'test' phase
  - Fails immediately if test fails
  - No cleanup phase

Failsafe (Integration Tests):
  - Runs in 'integration-test' phase
  - Doesn't fail immediately (continues to cleanup)
  - Fails in 'verify' phase after cleanup
  
Example workflow:
  1. integration-test: Start Docker container
  2. integration-test: Run tests (might fail)
  3. post-integration-test: Stop Docker container ← Cleanup happens!
  4. verify: Fail build if tests failed
```

**Integration Test Example:**

```xml
<!-- Start Testcontainers before tests -->
<plugin>
    <groupId>io.fabric8</groupId>
    <artifactId>docker-maven-plugin</artifactId>
    <version>0.43.4</version>
    <executions>
        <execution>
            <id>start</id>
            <phase>pre-integration-test</phase>
            <goals>
                <goal>start</goal>
            </goals>
        </execution>
        <execution>
            <id>stop</id>
            <phase>post-integration-test</phase>
            <goals>
                <goal>stop</goal>
            </goals>
        </execution>
    </executions>
</plugin>

<!-- Run integration tests -->
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-failsafe-plugin</artifactId>
    <version>3.1.2</version>
    <executions>
        <execution>
            <goals>
                <goal>integration-test</goal>
                <goal>verify</goal>
            </goals>
        </execution>
    </executions>
</plugin>
```

---

### Maven JAR Plugin

**Purpose:** Create JAR files

**Default Binding:** package phase

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-jar-plugin</artifactId>
            <version>3.3.0</version>
            <configuration>
                <archive>
                    <!-- Manifest configuration -->
                    <manifest>
                        <!-- Add classpath to manifest -->
                        <addClasspath>true</addClasspath>
                        <classpathPrefix>lib/</classpathPrefix>
                        
                        <!-- Main class for executable JAR -->
                        <mainClass>com.company.app.Main</mainClass>
                        
                        <!-- Add default implementation entries -->
                        <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
                        <addDefaultSpecificationEntries>true</addDefaultSpecificationEntries>
                    </manifest>
                    
                    <!-- Custom manifest entries -->
                    <manifestEntries>
                        <Built-By>${user.name}</Built-By>
                        <Build-Time>${maven.build.timestamp}</Build-Time>
                        <Build-OS>${os.name}</Build-OS>
                        <Implementation-Version>${project.version}</Implementation-Version>
                        <Implementation-Title>${project.name}</Implementation-Title>
                    </manifestEntries>
                </archive>
                
                <!-- Exclude files from JAR -->
                <excludes>
                    <exclude>**/*.properties</exclude>
                    <exclude>**/test-data/**</exclude>
                </excludes>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**Create Test JAR:**

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-jar-plugin</artifactId>
    <version>3.3.0</version>
    <executions>
        <execution>
            <goals>
                <goal>test-jar</goal>
            </goals>
        </execution>
    </executions>
</plugin>

<!-- Use test JAR in another module -->
<dependency>
    <groupId>com.company</groupId>
    <artifactId>common-test-utils</artifactId>
    <version>1.0.0</version>
    <type>test-jar</type>
    <scope>test</scope>
</dependency>
```

**Executable JAR (with dependencies in lib/):**

```xml
<!-- JAR plugin -->
<plugin>
    <artifactId>maven-jar-plugin</artifactId>
    <configuration>
        <archive>
            <manifest>
                <addClasspath>true</addClasspath>
                <classpathPrefix>lib/</classpathPrefix>
                <mainClass>com.company.app.Main</mainClass>
            </manifest>
        </archive>
    </configuration>
</plugin>

<!-- Copy dependencies to lib/ -->
<plugin>
    <artifactId>maven-dependency-plugin</artifactId>
    <executions>
        <execution>
            <phase>package</phase>
            <goals>
                <goal>copy-dependencies</goal>
            </goals>
            <configuration>
                <outputDirectory>${project.build.directory}/lib</outputDirectory>
            </configuration>
        </execution>
    </executions>
</plugin>
```

---

### Maven WAR Plugin

**Purpose:** Create WAR files for web applications

**Default Binding:** package phase

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-war-plugin</artifactId>
            <version>3.4.0</version>
            <configuration>
                <!-- Web resources directory -->
                <warSourceDirectory>src/main/webapp</warSourceDirectory>
                
                <!-- web.xml required? -->
                <failOnMissingWebXml>false</failOnMissingWebXml>
                
                <!-- Archive configuration -->
                <archive>
                    <manifest>
                        <addDefaultImplementationEntries>true</addDefaultImplementationEntries>
                    </manifest>
                    <manifestEntries>
                        <Built-By>${user.name}</Built-By>
                        <Build-Time>${maven.build.timestamp}</Build-Time>
                    </manifestEntries>
                </archive>
                
                <!-- Overlay configuration (for merging WARs) -->
                <overlays>
                    <overlay>
                        <groupId>com.company</groupId>
                        <artifactId>base-webapp</artifactId>
                        <excludes>
                            <exclude>WEB-INF/web.xml</exclude>
                        </excludes>
                    </overlay>
                </overlays>
                
                <!-- Web resources filtering -->
                <webResources>
                    <resource>
                        <directory>src/main/webapp</directory>
                        <filtering>true</filtering>
                        <includes>
                            <include>**/*.xml</include>
                            <include>**/*.properties</include>
                        </includes>
                    </resource>
                </webResources>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**WAR Structure:**

```
my-webapp.war
├── WEB-INF/
│   ├── classes/              # Compiled classes from src/main/java
│   │   └── com/company/...
│   ├── lib/                  # Dependencies
│   │   ├── spring-core.jar
│   │   ├── jackson-databind.jar
│   │   └── ...
│   ├── web.xml              # Servlet configuration
│   └── views/               # JSP/templates
│       └── home.jsp
├── META-INF/
│   └── MANIFEST.MF
├── index.html               # From src/main/webapp
├── css/
├── js/
└── images/
```

---

### Maven Resources Plugin

**Purpose:** Copy and filter resources

**Default Binding:** process-resources, process-test-resources

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-resources-plugin</artifactId>
            <version>3.3.1</version>
            <configuration>
                <!-- Encoding -->
                <encoding>UTF-8</encoding>
                
                <!-- Include empty directories -->
                <includeEmptyDirs>true</includeEmptyDirs>
                
                <!-- Escape string for filtering -->
                <escapeString>\</escapeString>
            </configuration>
        </plugin>
    </plugins>
    
    <resources>
        <resource>
            <directory>src/main/resources</directory>
            <!-- Enable filtering (replace ${property} placeholders) -->
            <filtering>true</filtering>
            <includes>
                <include>**/*.properties</include>
                <include>**/*.xml</include>
                <include>**/*.yml</include>
            </includes>
        </resource>
        
        <resource>
            <directory>src/main/resources</directory>
            <!-- Disable filtering for binary files -->
            <filtering>false</filtering>
            <excludes>
                <exclude>**/*.properties</exclude>
                <exclude>**/*.xml</exclude>
                <exclude>**/*.yml</exclude>
            </excludes>
        </resource>
    </resources>
</build>
```

**Resource Filtering Example:**

```properties
# src/main/resources/application.properties
app.name=${project.name}
app.version=${project.version}
app.build.timestamp=${maven.build.timestamp}
app.description=${project.description}

# After filtering (in target/classes/application.properties):
app.name=My Application
app.version=1.0.0-SNAPSHOT
app.build.timestamp=2024-11-15T10:30:00Z
app.description=Sample application
```

**Custom Delimiters:**

```xml
<plugin>
    <artifactId>maven-resources-plugin</artifactId>
    <version>3.3.1</version>
    <configuration>
        <!-- Use @ instead of ${} to avoid conflicts with Spring -->
        <useDefaultDelimiters>false</useDefaultDelimiters>
        <delimiters>
            <delimiter>@</delimiter>
        </delimiters>
    </configuration>
</plugin>

<!-- Now use @property@ in resources -->
app.version=@project.version@
```

---

### Maven Clean Plugin

**Purpose:** Delete build output directory

**Default Binding:** clean phase

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-clean-plugin</artifactId>
            <version>3.3.1</version>
            <configuration>
                <!-- Additional directories/files to clean -->
                <filesets>
                    <fileset>
                        <directory>logs</directory>
                        <includes>
                            <include>**/*.log</include>
                        </includes>
                        <followSymlinks>false</followSymlinks>
                    </fileset>
                    
                    <fileset>
                        <directory>generated-sources</directory>
                    </fileset>
                    
                    <fileset>
                        <directory>.</directory>
                        <includes>
                            <include>**/*.tmp</include>
                            <include>**/*.bak</include>
                        </includes>
                    </fileset>
                </filesets>
                
                <!-- Skip clean phase -->
                <skip>false</skip>
                
                <!-- Fail if directory can't be cleaned -->
                <failOnError>true</failOnError>
            </configuration>
        </plugin>
    </plugins>
</build>
```

---

## 2. Important Plugins for Java

### Maven Shade Plugin

**Purpose:** Create uber/fat JAR with all dependencies

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-shade-plugin</artifactId>
            <version>3.5.0</version>
            <executions>
                <execution>
                    <phase>package</phase>
                    <goals>
                        <goal>shade</goal>
                    </goals>
                    <configuration>
                        <!-- Create executable JAR -->
                        <transformers>
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ManifestResourceTransformer">
                                <mainClass>com.company.app.Main</mainClass>
                            </transformer>
                            
                            <!-- Merge service files -->
                            <transformer implementation="org.apache.maven.plugins.shade.resource.ServicesResourceTransformer"/>
                            
                            <!-- Append properties files -->
                            <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                                <resource>META-INF/spring.handlers</resource>
                            </transformer>
                            
                            <!-- Merge Spring schemas -->
                            <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
                                <resource>META-INF/spring.schemas</resource>
                            </transformer>
                        </transformers>
                        
                        <!-- Relocate packages to avoid conflicts -->
                        <relocations>
                            <relocation>
                                <pattern>com.google.common</pattern>
                                <shadedPattern>shaded.com.google.common</shadedPattern>
                            </relocation>
                        </relocations>
                        
                        <!-- Exclude files -->
                        <filters>
                            <filter>
                                <artifact>*:*</artifact>
                                <excludes>
                                    <exclude>META-INF/*.SF</exclude>
                                    <exclude>META-INF/*.DSA</exclude>
                                    <exclude>META-INF/*.RSA</exclude>
                                </excludes>
                            </filter>
                        </filters>
                        
                        <!-- Minimize JAR (remove unused classes) -->
                        <minimizeJar>false</minimizeJar>
                        
                        <!-- Create dependency-reduced POM -->
                        <createDependencyReducedPom>true</createDependencyReducedPom>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Output:**

```
target/
├── my-app-1.0.0.jar                      # Original JAR
├── my-app-1.0.0-shaded.jar              # Uber JAR with dependencies
└── dependency-reduced-pom.xml            # POM without shaded dependencies
```

**When to Use Shade Plugin:**

- Creating standalone applications
- Lambda functions (AWS, Azure)
- Command-line tools
- Avoiding dependency conflicts

---

### Maven Assembly Plugin

**Purpose:** Create custom distribution packages

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>3.6.0</version>
            <configuration>
                <descriptors>
                    <descriptor>src/assembly/distribution.xml</descriptor>
                </descriptors>
                <!-- Or use built-in descriptors -->
                <descriptorRefs>
                    <descriptorRef>jar-with-dependencies</descriptorRef>
                    <descriptorRef>bin</descriptorRef>
                    <descriptorRef>src</descriptorRef>
                </descriptorRefs>
                
                <!-- Append assembly id to filename -->
                <appendAssemblyId>true</appendAssemblyId>
                
                <!-- Archive configuration -->
                <archive>
                    <manifest>
                        <mainClass>com.company.app.Main</mainClass>
                    </manifest>
                </archive>
            </configuration>
            <executions>
                <execution>
                    <id>make-assembly</id>
                    <phase>package</phase>
                    <goals>
                        <goal>single</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Custom Assembly Descriptor:**

```xml
<!-- src/assembly/distribution.xml -->
<assembly xmlns="http://maven.apache.org/ASSEMBLY/2.2.0"
          xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
          xsi:schemaLocation="http://maven.apache.org/ASSEMBLY/2.2.0
                              http://maven.apache.org/xsd/assembly-2.2.0.xsd">
    <id>distribution</id>
    
    <!-- Output formats -->
    <formats>
        <format>tar.gz</format>
        <format>zip</format>
    </formats>
    
    <!-- Include base directory -->
    <includeBaseDirectory>true</includeBaseDirectory>
    
    <!-- File sets -->
    <fileSets>
        <!-- Application JAR -->
        <fileSet>
            <directory>${project.build.directory}</directory>
            <outputDirectory>/</outputDirectory>
            <includes>
                <include>*.jar</include>
            </includes>
        </fileSet>
        
        <!-- Configuration files -->
        <fileSet>
            <directory>src/main/config</directory>
            <outputDirectory>/config</outputDirectory>
            <includes>
                <include>**/*</include>
            </includes>
        </fileSet>
        
        <!-- Scripts -->
        <fileSet>
            <directory>src/main/scripts</directory>
            <outputDirectory>/bin</outputDirectory>
            <includes>
                <include>**/*.sh</include>
                <include>**/*.bat</include>
            </includes>
            <fileMode>0755</fileMode>
        </fileSet>
        
        <!-- Documentation -->
        <fileSet>
            <directory>.</directory>
            <outputDirectory>/</outputDirectory>
            <includes>
                <include>README.md</include>
                <include>LICENSE</include>
            </includes>
        </fileSet>
    </fileSets>
    
    <!-- Dependencies -->
    <dependencySets>
        <dependencySet>
            <outputDirectory>/lib</outputDirectory>
            <scope>runtime</scope>
        </dependencySet>
    </dependencySets>
</assembly>
```

**Output:**

```
my-app-1.0.0-distribution.zip
└── my-app-1.0.0/
    ├── my-app-1.0.0.jar
    ├── lib/
    │   ├── spring-core.jar
    │   └── ...
    ├── config/
    │   └── application.properties
    ├── bin/
    │   ├── start.sh
    │   └── start.bat
    ├── README.md
    └── LICENSE
```

---

### Maven Dependency Plugin

**Purpose:** Analyze and manage dependencies

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-dependency-plugin</artifactId>
            <version>3.6.0</version>
            <executions>
                <!-- Copy dependencies to lib/ -->
                <execution>
                    <id>copy-dependencies</id>
                    <phase>package</phase>
                    <goals>
                        <goal>copy-dependencies</goal>
                    </goals>
                    <configuration>
                        <outputDirectory>${project.build.directory}/lib</outputDirectory>
                        <includeScope>runtime</includeScope>
                    </configuration>
                </execution>
                
                <!-- Unpack dependencies -->
                <execution>
                    <id>unpack</id>
                    <phase>generate-resources</phase>
                    <goals>
                        <goal>unpack</goal>
                    </goals>
                    <configuration>
                        <artifactItems>
                            <artifactItem>
                                <groupId>com.company</groupId>
                                <artifactId>config-bundle</artifactId>
                                <version>1.0.0</version>
                                <type>jar</type>
                                <outputDirectory>${project.build.directory}/config</outputDirectory>
                            </artifactItem>
                        </artifactItems>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Common Goals:**

```bash
# Show dependency tree
mvn dependency:tree

# Show dependency tree with conflicts
mvn dependency:tree -Dverbose

# Analyze dependencies (find unused/undeclared)
mvn dependency:analyze

# List dependencies
mvn dependency:list

# Resolve all dependencies
mvn dependency:resolve

# Copy dependencies to target/dependency
mvn dependency:copy-dependencies

# Purge local repository snapshots
mvn dependency:purge-local-repository

# Display updates
mvn dependency:display-updates
```

---

### Maven Help Plugin

**Purpose:** Get information about Maven and the project

```bash
# Show effective POM
mvn help:effective-pom

# Show effective POM for specific module
mvn help:effective-pom -pl my-module

# Show effective settings
mvn help:effective-settings

# Show active profiles
mvn help:active-profiles

# Show all profiles
mvn help:all-profiles

# Describe plugin
mvn help:describe -Dplugin=compiler

# Describe plugin goal
mvn help:describe -Dplugin=compiler -Dgoal=compile

# Describe dependency
mvn help:describe -DgroupId=org.springframework -DartifactId=spring-core

# Evaluate expression
mvn help:evaluate -Dexpression=project.version

# System properties
mvn help:system
```

**Plugin Configuration:**

```xml
<plugin>
    <groupId>org.apache.maven.plugins</groupId>
    <artifactId>maven-help-plugin</artifactId>
    <version>3.4.0</version>
</plugin>
```

---

### Maven Enforcer Plugin

**Purpose:** Enforce environment rules and requirements

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-enforcer-plugin</artifactId>
            <version>3.4.1</version>
            <executions>
                <execution>
                    <id>enforce-versions</id>
                    <goals>
                        <goal>enforce</goal>
                    </goals>
                    <configuration>
                        <rules>
                            <!-- Require specific Maven version -->
                            <requireMavenVersion>
                                <version>[3.8.0,)</version>
                                <message>Maven 3.8.0 or higher is required!</message>
                            </requireMavenVersion>
                            
                            <!-- Require specific Java version -->
                            <requireJavaVersion>
                                <version>[17,)</version>
                                <message>Java 17 or higher is required!</message>
                            </requireJavaVersion>
                            
                            <!-- No duplicate dependencies -->
                            <banDuplicatePomDependencyVersions/>
                            
                            <!-- Require specific dependency versions -->
                            <requireUpperBoundDeps/>
                            
                            <!-- Ban specific dependencies -->
                            <bannedDependencies>
                                <excludes>
                                    <exclude>commons-logging:commons-logging</exclude>
                                    <exclude>log4j:log4j</exclude>
                                </excludes>
                                <message>Use SLF4J instead!</message>
                            </bannedDependencies>
                            
                            <!-- Require dependency convergence -->
                            <dependencyConvergence/>
                            
                            <!-- Require plugin versions -->
                            <requirePluginVersions>
                                <message>Best practice: Always define plugin versions!</message>
                            </requirePluginVersions>
                            
                            <!-- Require release dependencies (no snapshots) -->
                            <requireReleaseDeps>
                                <message>No SNAPSHOTS allowed in production!</message>
                                <onlyWhenRelease>true</onlyWhenRelease>
                            </requireReleaseDeps>
                            
                            <!-- Custom rule -->
                            <requireEnvironmentVariable>
                                <variableName>JAVA_HOME</variableName>
                            </requireEnvironmentVariable>
                            
                            <!-- Require specific OS -->
                            <requireOS>
                                <family>unix</family>
                                <message>Build requires Unix-like OS!</message>
                            </requireOS>
                            
                            <!-- Require properties -->
                            <requireProperty>
                                <property>project.version</property>
                                <regex>.*(?!-SNAPSHOT)$</regex>
                                <regexMessage>No SNAPSHOT versions in production!</regexMessage>
                            </requireProperty>
                        </rules>
                        
                        <!-- Fail build on rule violation -->
                        <fail>true</fail>
                    </configuration>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Common Use Cases:**

```xml
<!-- CI/CD: Ensure consistent environment -->
<requireMavenVersion>
    <version>[3.8.0,)</version>
</requireMavenVersion>
<requireJavaVersion>
    <version>[17,)</version>
</requireJavaVersion>

<!-- Production: No SNAPSHOT dependencies -->
<requireReleaseDeps>
    <onlyWhenRelease>true</onlyWhenRelease>
</requireReleaseDeps>

<!-- Code Quality: Ban problematic dependencies -->
<bannedDependencies>
    <excludes>
        <exclude>commons-logging:commons-logging</exclude>
    </excludes>
</bannedDependencies>

<!-- Consistency: Ensure all plugins have versions -->
<requirePluginVersions/>
```

---

### JaCoCo Maven Plugin

**Purpose:** Code coverage analysis

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.jacoco</groupId>
            <artifactId>jacoco-maven-plugin</artifactId>
            <version>0.8.10</version>
            <executions>
                <!-- Prepare agent for unit tests -->
                <execution>
                    <id>prepare-agent</id>
                    <goals>
                        <goal>prepare-agent</goal>
                    </goals>
                </execution>
                
                <!-- Generate report after tests -->
                <execution>
                    <id>report</id>
                    <phase>test</phase>
                    <goals>
                        <goal>report</goal>
                    </goals>
                </execution>
                
                <!-- Prepare agent for integration tests -->
                <execution>
                    <id>prepare-agent-integration</id>
                    <goals>
                        <goal>prepare-agent-integration</goal>
                    </goals>
                </execution>
                
                <!-- Generate integration test report -->
                <execution>
                    <id>report-integration</id>
                    <goals>
                        <goal>report-integration</goal>
                    </goals>
                </execution>
                
                <!-- Enforce coverage rules -->
                <execution>
                    <id>check</id>
                    <goals>
                        <goal>check</goal>
                    </goals>
                    <configuration>
                        <rules>
                            <rule>
                                <element>PACKAGE</element>
                                <limits>
                                    <limit>
                                        <counter>LINE</counter>
                                        <value>COVEREDRATIO</value>
                                        <minimum>0.80</minimum>
                                    </limit>
                                    <limit>
                                        <counter>BRANCH</counter>
                                        <value>COVEREDRATIO</value>
                                        <minimum>0.70</minimum>
                                    </limit>
                                </limits>
                            </rule>
                        </rules>
                    </configuration>
                </execution>
            </executions>
            <configuration>
                <!-- Exclude classes from coverage -->
                <excludes>
                    <exclude>**/*Test.class</exclude>
                    <exclude>**/config/**</exclude>
                    <exclude>**/dto/**</exclude>
                    <exclude>**/Application.class</exclude>
                </excludes>
            </configuration>
        </plugin>
    </plugins>
</build>
```

**Generate Coverage Report:**

```bash
# Run tests with coverage
mvn clean test

# View report
open target/site/jacoco/index.html

# Run with coverage threshold check
mvn clean verify
```

**Coverage Report:**

```
target/site/jacoco/
├── index.html                 # Coverage summary
├── com.company.service/
│   └── UserService.html      # Class coverage
└── jacoco.xml                # XML report for CI/CD
```

---

### Maven Checkstyle Plugin

**Purpose:** Check code style and conventions

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-checkstyle-plugin</artifactId>
            <version>3.3.0</version>
            <dependencies>
                <!-- Use specific Checkstyle version -->
                <dependency>
                    <groupId>com.puppycrawl.tools</groupId>
                    <artifactId>checkstyle</artifactId>
                    <version>10.12.3</version>
                </dependency>
            </dependencies>
            <configuration>
                <!-- Checkstyle configuration file -->
                <configLocation>checkstyle.xml</configLocation>
                <!-- Or use built-in configurations -->
                <!-- <configLocation>google_checks.xml</configLocation> -->
                <!-- <configLocation>sun_checks.xml</configLocation> -->
                
                <encoding>UTF-8</encoding>
                <consoleOutput>true</consoleOutput>
                <failsOnError>true</failsOnError>
                <linkXRef>false</linkXRef>
                
                <!-- Exclude files -->
                <excludes>**/generated/**/*</excludes>
            </configuration>
            <executions>
                <execution>
                    <id>validate</id>
                    <phase>validate</phase>
                    <goals>
                        <goal>check</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Run Checkstyle:**

```bash
# Check code style
mvn checkstyle:check

# Generate report
mvn checkstyle:checkstyle

# View report
open target/site/checkstyle.html
```

---

### Maven PMD Plugin

**Purpose:** Static code analysis

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-pmd-plugin</artifactId>
            <version>3.21.0</version>
            <configuration>
                <!-- Minimum priority (1=high, 5=low) -->
                <minimumPriority>3</minimumPriority>
                
                <!-- Print violations to console -->
                <printFailingErrors>true</printFailingErrors>
                
                <!-- Rulesets -->
                <rulesets>
                    <ruleset>/rulesets/java/basic.xml</ruleset>
                    <ruleset>/rulesets/java/braces.xml</ruleset>
                    <ruleset>/rulesets/java/design.xml</ruleset>
                    <ruleset>/rulesets/java/unusedcode.xml</ruleset>
                    <!-- Or custom ruleset -->
                    <ruleset>pmd-ruleset.xml</ruleset>
                </rulesets>
                
                <!-- Exclude files -->
                <excludes>
                    <exclude>**/generated/**/*.java</exclude>
                </excludes>
            </configuration>
            <executions>
                <execution>
                    <id>pmd-check</id>
                    <goals>
                        <goal>check</goal>
                        <goal>cpd-check</goal> <!-- Copy-paste detection -->
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

**Run PMD:**

```bash
# Run PMD analysis
mvn pmd:check

# Run copy-paste detection
mvn pmd:cpd-check

# Generate report
mvn pmd:pmd

# View report
open target/site/pmd.html
```

---

## 3. Spring Boot Maven Plugin

### Spring Boot Maven Plugin

**Purpose:** Package Spring Boot applications as executable JARs

```xml
<build>
    <plugins>
        <plugin>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-maven-plugin</artifactId>
            <version>3.1.5</version>
            <configuration>
                <!-- Main class -->
                <mainClass>com.company.app.Application</mainClass>
                
                <!-- Include/exclude dependencies -->
                <excludes>
                    <exclude>
                        <groupId>org.projectlombok</groupId>
                        <artifactId>lombok</artifactId>
                    </exclude>
                </excludes>
                
                <!-- Layered JAR for Docker -->
                <layers>
                    <enabled>true</enabled>
                </layers>
                
                <!-- JVM arguments -->
                <jvmArguments>
                    -Xmx512m
                    -Dspring.profiles.active=dev
                </jvmArguments>
                
                <!-- Environment variables -->
                <environmentVariables>
                    <ENV>development</ENV>
                </environmentVariables>
            </configuration>
            <executions>
                <execution>
                    <goals>
                        <!-- Repackage as executable JAR -->
                        <goal>repackage</goal>
                        
                        <!-- Generate build info -->
                        <goal>build-info</goal>
                    </goals>
                </execution>
            </executions>
        </plugin>
    </plugins>
</build>
```

---

### Running Spring Boot Application

```bash
# Run application
mvn spring-boot:run

# Run with profile
mvn spring-boot:run -Dspring-boot.run.profiles=dev

# Run with arguments
mvn spring-boot:run -Dspring-boot.run.arguments="--server.port=8081"

# Run with JVM arguments
mvn spring-boot:run -Dspring-boot.run.jvmArguments="-Xmx1024m -XX:+HeapDumpOnOutOfMemoryError"

# Run with environment variables
mvn spring-boot:run -Dspring-boot.run.environmentVariables.DATABASE_URL=jdbc:postgresql://localhost/db

# Debug mode
mvn spring-boot:run -Dspring-boot.run.jvmArguments="-Xdebug -Xrunjdwp:transport=dt_socket,server=y,suspend=n,address=5005"
```

---

### Building Docker Images

**Using Cloud Native Buildpacks:**

```xml
<plugin>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-maven-plugin</artifactId>
    <version>3.1.5</version>
    <configuration>
        <image>
            <!-- Image name -->
            <name>company/${project.artifactId}:${project.version}</name>
            
            <!-- Builder (Paketo is default) -->
            <builder>paketobuildpacks/builder:base</builder>
            
            <!-- Environment variables for build -->
            <env>
                <BP_JVM_VERSION>17</BP_JVM_VERSION>
            </env>
            
            <!-- Build arguments -->
            <buildpacks>
                <buildpack>gcr.io/paketo-buildpacks/java</buildpack>
            </buildpacks>
            
            <!-- Publish to registry -->
            <publish>false</publish>
        </image>
    </configuration>
</plugin>
```

**Build Docker Image:**

```bash
# Build image
mvn spring-boot:build-image

# Build with custom name
mvn spring-boot:build-image -Dspring-boot.build-image.imageName=mycompany/myapp:1.0.0

# Publish to registry
mvn spring-boot:build-image -Dspring-boot.build-image.publish=true

# View created image
docker images | grep myapp
```

**Run Docker Container:**

```bash
# Run the image
docker run -p 8080:8080 company/my-app:1.0.0

# Run with environment variables
docker run -p 8080:8080 \
  -e SPRING_PROFILES_ACTIVE=prod \
  -e DATABASE_URL=jdbc:postgresql://db:5432/mydb \
  company/my-app:1.0.0
```

---

### Layered JARs for Docker

**Enable Layers:**

```xml
<plugin>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-maven-plugin</artifactId>
    <configuration>
        <layers>
            <enabled>true</enabled>
            <configuration>layers.xml</configuration>
        </layers>
    </configuration>
</plugin>
```

**Custom Layers Configuration:**

```xml
<!-- layers.xml -->
<layers xmlns="http://www.springframework.org/schema/boot/layers"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.springframework.org/schema/boot/layers
                            https://www.springframework.org/schema/boot/layers/layers-1.0.xsd">
    <application>
        <into layer="spring-boot-loader">
            <include>org/springframework/boot/loader/**</include>
        </into>
        <into layer="application"/>
    </application>
    <dependencies>
        <into layer="application-dependencies">
            <include>com.company:*:*</include>
        </into>
        <into layer="snapshot-dependencies">
            <include>*:*:*SNAPSHOT</include>
        </into>
        <into layer="dependencies"/>
    </dependencies>
    <layerOrder>
        <layer>dependencies</layer>
        <layer>spring-boot-loader</layer>
        <layer>snapshot-dependencies</layer>
        <layer>application-dependencies</layer>
        <layer>application</layer>
    </layerOrder>
</layers>
```

**Extract Layers:**

```bash
# Build JAR
mvn clean package

# Extract layers
java -Djarmode=layertools -jar target/my-app-1.0.0.jar extract

# View layers
ls -la
dependencies/
spring-boot-loader/
snapshot-dependencies/
application-dependencies/
application/
```

**Optimized Dockerfile:**

```dockerfile
FROM eclipse-temurin:17-jre as builder
WORKDIR application
ARG JAR_FILE=target/*.jar
COPY ${JAR_FILE} application.jar
RUN java -Djarmode=layertools -jar application.jar extract

FROM eclipse-temurin:17-jre
WORKDIR application
COPY --from=builder application/dependencies/ ./
COPY --from=builder application/spring-boot-loader/ ./
COPY --from=builder application/snapshot-dependencies/ ./
COPY --from=builder application/application-dependencies/ ./
COPY --from=builder application/application/ ./
ENTRYPOINT ["java", "org.springframework.boot.loader.JarLauncher"]
```

**Benefits of Layered JARs:**

```
Without layers:
  - Change one line of code → Rebuild entire image → Slow
  
With layers:
  - Dependencies rarely change → Cached layer → Fast
  - Application code changes → Only rebuild top layer → Fast
  - Smaller images in registry
  - Faster deployments
```

---

## Summary

### Plugin Categories

```
┌────────────────────────────────────────────────────────────┐
│                  PLUGIN CATEGORIES                         │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  Core Build Plugins:                                       │
│  • compiler  → Compile Java code                          │
│  • resources → Copy/filter resources                       │
│  • jar/war   → Package applications                        │
│  • clean     → Remove build output                         │
│                                                            │
│  Testing Plugins:                                          │
│  • surefire  → Unit tests                                  │
│  • failsafe  → Integration tests                           │
│  • jacoco    → Code coverage                               │
│                                                            │
│  Packaging Plugins:                                        │
│  • shade     → Fat JAR with dependencies                   │
│  • assembly  → Custom distributions                        │
│                                                            │
│  Analysis Plugins:                                         │
│  • dependency → Analyze dependencies                       │
│  • enforcer   → Enforce rules                              │
│  • checkstyle → Code style                                 │
│  • pmd        → Static analysis                            │
│                                                            │
│  Spring Boot:                                              │
│  • spring-boot-maven-plugin → Executable JARs + Docker    │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

### Essential Commands

```bash
# Run tests with coverage
mvn clean test jacoco:report

# Analyze code quality
mvn clean verify checkstyle:check pmd:check

# Create fat JAR
mvn clean package shade:shade

# Create distribution
mvn clean package assembly:single

# Analyze dependencies
mvn dependency:tree
mvn dependency:analyze

# Spring Boot
mvn spring-boot:run
mvn spring-boot:build-image

# Debug effective configuration
mvn help:effective-pom
mvn help:describe -Dplugin=compiler
```

### Best Practices

```xml
<!-- ✓ Always specify plugin versions -->
<plugin>
    <artifactId>maven-compiler-plugin</artifactId>
    <version>3.11.0</version>
</plugin>

<!-- ✓ Use pluginManagement in parent POM -->
<pluginManagement>
    <plugins>
        <plugin>
            <artifactId>maven-compiler-plugin</artifactId>
            <version>3.11.0</version>
        </plugin>
    </plugins>
</pluginManagement>

<!-- ✓ Configure once, use everywhere -->
<properties>
    <maven.compiler.release>17</maven.compiler.release>
</properties>

<!-- ✓ Bind goals to appropriate phases -->
<execution>
    <phase>package</phase>
    <goals>
        <goal>shade</goal>
    </goals>
</execution>

<!-- ✗ Don't skip tests in CI/CD -->
<!-- ✗ Don't minimize JARs without testing -->
<!-- ✗ Don't forget to configure encoding -->
```

