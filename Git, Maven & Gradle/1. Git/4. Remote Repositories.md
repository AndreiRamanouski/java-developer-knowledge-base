## Overview

Understanding remote repositories is essential for collaborating on Java projects. This guide covers everything from basic remote operations to advanced fork workflows used in open-source development.

```
┌────────────────────────────────────────────────────────┐
│              REMOTE REPOSITORY WORKFLOW                │
├────────────────────────────────────────────────────────┤
│                                                        │
│  Local Repository        Remote Repository            │
│  ─────────────────       ──────────────────           │
│                                                        │
│  Working Directory       GitHub/GitLab                 │
│  ┌──────────────┐       ┌──────────────┐             │
│  │ Your Files   │       │ origin/main  │             │
│  │ pom.xml      │       │ origin/dev   │             │
│  │ src/         │       │              │             │
│  └──────────────┘       └──────────────┘             │
│         ↓                       ↑                      │
│    git add                 git push                   │
│         ↓                       ↑                      │
│  ┌──────────────┐               │                     │
│  │ Staging Area │               │                     │
│  └──────────────┘               │                     │
│         ↓                       │                      │
│    git commit                   │                     │
│         ↓                       │                      │
│  ┌──────────────┐               │                     │
│  │ Local Repo   │───────────────┘                     │
│  │ main         │                                      │
│  │ feature/auth │←─────────────┐                      │
│  └──────────────┘               │                     │
│         ↑                  git fetch                  │
│         │                  git pull                   │
│         │                       │                      │
│         └───────────────────────┘                     │
│                                                        │
└────────────────────────────────────────────────────────┘
```

---

## 1. Working with Remotes

### git clone (What It Does)

Cloning creates a complete copy of a remote repository on your local machine.

**What happens when you clone:**

```bash
git clone https://github.com/user/spring-boot-app.git

# Git performs these steps:
# 1. Creates new directory: spring-boot-app/
# 2. Initializes empty Git repo: .git/
# 3. Adds remote 'origin' pointing to GitHub URL
# 4. Fetches all branches from remote
# 5. Checks out default branch (usually main)
# 6. Sets up tracking branch (local main → origin/main)
```

**Clone process visualization:**

```
Before clone:
Local:  (nothing)

Remote (GitHub):
├── main
├── develop
├── feature/auth
└── release/1.0.0

After clone:
Local repository:
├── .git/
│   ├── config (contains remote URL)
│   ├── refs/
│   │   ├── heads/main (your local branch)
│   │   └── remotes/origin/
│   │       ├── main
│   │       ├── develop
│   │       ├── feature/auth
│   │       └── release/1.0.0
│   └── objects/ (all commits, trees, blobs)
├── pom.xml
├── src/
└── README.md

Local branches:
* main (tracking origin/main)

Remote-tracking branches:
  origin/main
  origin/develop
  origin/feature/auth
  origin/release/1.0.0
```

**Clone variations:**

```bash
# Basic clone
git clone https://github.com/user/spring-boot-app.git

# Clone into specific directory
git clone https://github.com/user/spring-boot-app.git my-app

# Clone specific branch
git clone -b develop https://github.com/user/spring-boot-app.git

# Shallow clone (faster, less history)
git clone --depth 1 https://github.com/user/spring-boot-app.git
# Only fetches latest commit, not entire history
# Useful for CI/CD pipelines

# Clone with submodules
git clone --recurse-submodules https://github.com/user/spring-boot-app.git

# Clone using SSH instead of HTTPS
git clone git@github.com:user/spring-boot-app.git

# Clone and set different origin name
git clone -o upstream https://github.com/user/spring-boot-app.git
```

**After cloning:**

```bash
# View remote configuration
cd spring-boot-app
git remote -v
# origin  https://github.com/user/spring-boot-app.git (fetch)
# origin  https://github.com/user/spring-boot-app.git (push)

# View branches
git branch -a
# * main
#   remotes/origin/HEAD -> origin/main
#   remotes/origin/main
#   remotes/origin/develop
#   remotes/origin/feature/auth

# View tracking relationship
git branch -vv
# * main a1b2c3d [origin/main] Latest commit

# Check remote details
git remote show origin
# * remote origin
#   Fetch URL: https://github.com/user/spring-boot-app.git
#   Push  URL: https://github.com/user/spring-boot-app.git
#   HEAD branch: main
#   Remote branches:
#     develop      tracked
#     feature/auth tracked
#     main         tracked
#   Local branch configured for 'git pull':
#     main merges with remote main
#   Local ref configured for 'git push':
#     main pushes to main (up to date)
```

---

### git remote (add, remove, rename, show)

Managing remote repositories in your local Git configuration.

#### Adding remotes

```bash
# Add a remote
git remote add <name> <url>

# Example: Add origin
git remote add origin https://github.com/user/spring-boot-app.git

# Example: Add upstream (for fork workflow)
git remote add upstream https://github.com/original/spring-boot-app.git

# Add multiple remotes
git remote add origin git@github.com:user/spring-boot-app.git
git remote add gitlab git@gitlab.com:user/spring-boot-app.git
git remote add bitbucket git@bitbucket.org:user/spring-boot-app.git

# Verify remotes
git remote -v
# origin    git@github.com:user/spring-boot-app.git (fetch)
# origin    git@github.com:user/spring-boot-app.git (push)
# gitlab    git@gitlab.com:user/spring-boot-app.git (fetch)
# gitlab    git@gitlab.com:user/spring-boot-app.git (push)
# upstream  https://github.com/original/spring-boot-app.git (fetch)
# upstream  https://github.com/original/spring-boot-app.git (push)
```

#### Viewing remotes

```bash
# List remotes (short)
git remote
# origin
# upstream

# List remotes with URLs
git remote -v
# origin    https://github.com/user/spring-boot-app.git (fetch)
# origin    https://github.com/user/spring-boot-app.git (push)
# upstream  https://github.com/original/spring-boot-app.git (fetch)
# upstream  https://github.com/original/spring-boot-app.git (push)

# Show detailed remote info
git remote show origin
# * remote origin
#   Fetch URL: https://github.com/user/spring-boot-app.git
#   Push  URL: https://github.com/user/spring-boot-app.git
#   HEAD branch: main
#   Remote branches:
#     develop      tracked
#     main         tracked
#     feature/auth tracked
#   Local branch configured for 'git pull':
#     main merges with remote main
#   Local ref configured for 'git push':
#     main pushes to main (up to date)

# Show all remote branches
git ls-remote origin
# a1b2c3d4e5f6g7h8i9j0k1l2m3n4o5p6q7r8s9t0  refs/heads/main
# 9a8b7c6d5e4f3g2h1i0j9k8l7m6n5o4p3q2r1s0  refs/heads/develop
# 8a7b6c5d4e3f2g1h0i9j8k7l6m5n4o3p2q1r0s9  refs/heads/feature/auth
```

#### Renaming remotes

```bash
# Rename a remote
git remote rename <old-name> <new-name>

# Example: Rename origin to github
git remote rename origin github

# Verify
git remote -v
# github    https://github.com/user/spring-boot-app.git (fetch)
# github    https://github.com/user/spring-boot-app.git (push)

# Note: This updates tracking branches too
git branch -vv
# * main a1b2c3d [github/main] Latest commit
```

#### Removing remotes

```bash
# Remove a remote
git remote remove <name>
# or
git remote rm <name>

# Example: Remove upstream
git remote remove upstream

# Verify
git remote -v
# origin    https://github.com/user/spring-boot-app.git (fetch)
# origin    https://github.com/user/spring-boot-app.git (push)

# Note: This doesn't delete remote-tracking branches
# Clean them up with:
git fetch --prune
```

#### Changing remote URLs

```bash
# Change remote URL
git remote set-url <name> <new-url>

# Example: Switch from HTTPS to SSH
git remote set-url origin git@github.com:user/spring-boot-app.git

# Verify
git remote -v
# origin    git@github.com:user/spring-boot-app.git (fetch)
# origin    git@github.com:user/spring-boot-app.git (push)

# Set different URLs for fetch and push
git remote set-url origin git@github.com:user/spring-boot-app.git
git remote set-url --push origin git@github.com:user-fork/spring-boot-app.git

# Verify
git remote -v
# origin    git@github.com:user/spring-boot-app.git (fetch)
# origin    git@github.com:user-fork/spring-boot-app.git (push)
```

---

### origin vs upstream (Fork Workflow)

Understanding the difference between `origin` and `upstream` is crucial for fork-based workflows.

**Naming conventions:**

```
┌────────────────────────────────────────────────────────┐
│              FORK WORKFLOW REMOTES                     │
├────────────────────────────────────────────────────────┤
│                                                        │
│  upstream (original repository)                        │
│  ├── main (official releases)                         │
│  ├── develop (latest development)                     │
│  └── feature/* (community features)                   │
│                                                        │
│         ↓ (you forked this)                           │
│                                                        │
│  origin (your fork)                                    │
│  ├── main (synced with upstream)                      │
│  ├── develop (your development)                       │
│  └── feature/my-feature (your work)                   │
│                                                        │
│         ↓ (you cloned your fork)                      │
│                                                        │
│  local (your machine)                                  │
│  ├── main (tracking origin/main)                      │
│  ├── develop (tracking origin/develop)                │
│  └── feature/my-feature (your local work)             │
│                                                        │
└────────────────────────────────────────────────────────┘
```

**Typical setup:**

```bash
# 1. Fork repository on GitHub
#    Original: https://github.com/spring-projects/spring-boot
#    Your fork: https://github.com/yourname/spring-boot

# 2. Clone YOUR fork
git clone https://github.com/yourname/spring-boot.git
cd spring-boot

# 3. Check remotes (only origin exists)
git remote -v
# origin  https://github.com/yourname/spring-boot.git (fetch)
# origin  https://github.com/yourname/spring-boot.git (push)

# 4. Add upstream remote (original repository)
git remote add upstream https://github.com/spring-projects/spring-boot.git

# 5. Verify both remotes
git remote -v
# origin    https://github.com/yourname/spring-boot.git (fetch)
# origin    https://github.com/yourname/spring-boot.git (push)
# upstream  https://github.com/spring-projects/spring-boot.git (fetch)
# upstream  https://github.com/spring-projects/spring-boot.git (push)

# 6. Fetch from upstream
git fetch upstream

# 7. View all branches
git branch -a
# * main
#   remotes/origin/main
#   remotes/origin/develop
#   remotes/upstream/main
#   remotes/upstream/develop
```

**Usage patterns:**

```bash
# Push to origin (your fork)
git push origin feature/my-feature

# Pull from upstream (original repo)
git pull upstream main

# Typical workflow:
# 1. Fetch latest from upstream
git fetch upstream

# 2. Update your main branch
git checkout main
git merge upstream/main

# 3. Push updated main to your fork
git push origin main

# 4. Create feature branch
git checkout -b feature/add-validation

# 5. Work and commit
git commit -m "feat: Add email validation"

# 6. Push to your fork
git push origin feature/add-validation

# 7. Create Pull Request from your fork to upstream
#    (Done on GitHub/GitLab)
```

---

### Tracking Branches

Tracking branches establish a relationship between local and remote branches.

**What is a tracking branch:**

```bash
# A tracking branch is a local branch that has a direct relationship
# to a remote branch. When you git pull on a tracking branch,
# Git automatically knows which remote branch to pull from.

# Example tracking relationship:
# Local branch:  main
# Tracks:        origin/main
# Means:         git pull = git pull origin main
#                git push = git push origin main
```

**Setting up tracking:**

```bash
# When you clone, main is automatically set up to track origin/main
git clone https://github.com/user/spring-boot-app.git
git branch -vv
# * main a1b2c3d [origin/main] Latest commit
#        ↑         ↑
#     local    tracking remote

# Create new branch tracking remote
git checkout -b develop origin/develop
# or
git checkout --track origin/develop

# Modern syntax (Git 2.23+)
git switch -c develop origin/develop

# Set tracking for existing branch
git branch --set-upstream-to=origin/main main
# or shorter
git branch -u origin/main main

# Push and set tracking
git push -u origin feature/new-feature
# -u is short for --set-upstream
```

**Viewing tracking information:**

```bash
# View tracking branches (verbose)
git branch -vv
# * main           a1b2c3d [origin/main] Latest commit
#   develop        9a8b7c6 [origin/develop: ahead 2] Working on feature
#   feature/auth   8a7b6c5 [origin/feature/auth: behind 1] Add auth
#   feature/local  7a6b5c4 Not tracking any remote

# Explanation:
# [origin/main]              - Tracking origin/main, up to date
# [origin/develop: ahead 2]  - 2 commits ahead of remote
# [origin/feature/auth: behind 1] - 1 commit behind remote
# Not tracking any remote    - No tracking set up

# Check specific branch
git rev-parse --abbrev-ref --symbolic-full-name @{u}
# origin/main (if on main branch)

# View remote tracking branches
git branch -r
# origin/HEAD -> origin/main
# origin/main
# origin/develop
# origin/feature/auth
```

**Tracking branch workflow:**

```bash
# Scenario: Work on remote feature branch

# 1. Fetch remote branches
git fetch origin

# 2. Create local branch tracking remote
git checkout -b feature/payment origin/feature/payment
# Branch 'feature/payment' set up to track remote branch 'feature/payment' from 'origin'.

# 3. Now git pull knows where to pull from
git pull
# Automatically pulls from origin/feature/payment

# 4. And git push knows where to push to
git commit -m "feat: Add payment processing"
git push
# Automatically pushes to origin/feature/payment

# Without tracking, you'd need:
git pull origin feature/payment
git push origin feature/payment
```

**Unset tracking:**

```bash
# Remove tracking relationship
git branch --unset-upstream feature/payment

# Verify
git branch -vv
# * feature/payment 7a6b5c4 Add payment processing
#   (no tracking info shown)

# Now git pull fails
git pull
# error: There is no tracking information for the current branch.
# Please specify which branch you want to merge with.
```

---

## 2. Synchronization

### git fetch (Download Changes, No Merge)

Fetch downloads new data from remote but doesn't modify your working directory.

**What fetch does:**

```bash
# Before fetch:
Local branches:
  main (a1b2c3d)

Remote-tracking branches:
  origin/main (a1b2c3d)

Remote repository (GitHub):
  main (x1y2z3a) - 3 new commits

# After fetch:
Local branches:
  main (a1b2c3d) - UNCHANGED

Remote-tracking branches:
  origin/main (x1y2z3a) - UPDATED

Remote repository (GitHub):
  main (x1y2z3a)

# Your working directory: UNCHANGED
# Your local branches: UNCHANGED
# Remote-tracking branches: UPDATED
```

**Fetch commands:**

```bash
# Fetch from origin (all branches)
git fetch origin

# Fetch from specific remote
git fetch upstream

# Fetch specific branch
git fetch origin main

# Fetch all remotes
git fetch --all

# Fetch and prune (remove deleted remote branches)
git fetch --prune
git fetch -p

# Dry run (see what would be fetched)
git fetch --dry-run

# Fetch with tags
git fetch --tags

# Shallow fetch (limited history)
git fetch --depth=10
```

**Viewing fetched changes:**

```bash
# Fetch updates
git fetch origin

# View what's new on remote
git log main..origin/main
# Shows commits on origin/main not in local main

git log --oneline main..origin/main
# x1y2z3a (origin/main) Fix bug in user service
# w9x1y2z Add new feature
# v8w9x1y Update dependencies

# Compare local and remote
git diff main origin/main

# View specific file changes
git diff main origin/main -- pom.xml

# Show remote branch log
git log origin/main --oneline -5
```

**Fetch workflow:**

```bash
# 1. Fetch latest from remote
git fetch origin

# 2. Review changes before merging
git log --oneline main..origin/main
git diff main origin/main

# 3. If changes look good, merge
git merge origin/main

# 4. Or rebase instead
git rebase origin/main

# 5. Or just checkout remote branch
git checkout origin/main
# Detached HEAD state - read-only

# 6. Create branch from remote state
git checkout -b temp-review origin/main
```

**Why use fetch instead of pull:**

```
✅ Use fetch when:
- Want to review changes before merging
- Need to see what teammates did
- Want to compare with local work
- Running automated scripts
- Want explicit control

❌ Don't use fetch when:
- Just want to update (use pull)
- Trust remote changes
- Want quick sync
```

---

### git pull (Fetch + Merge)

Pull downloads changes and immediately merges them into your current branch.

**What pull does:**

```bash
git pull

# Equivalent to:
git fetch
git merge origin/<current-branch>

# Example:
git pull origin main

# Equivalent to:
git fetch origin
git merge origin/main
```

**Pull visualization:**

```
Before pull:
Local main:      A---B---C
Remote main:     A---B---C---D---E

After pull (merge):
Local main:      A---B---C-------M
                          \     /
Remote main:               D---E

M = merge commit
```

**Pull commands:**

```bash
# Pull current branch from its tracking remote
git pull

# Pull from specific remote and branch
git pull origin main

# Pull with custom merge message
git pull -m "Merge latest from origin"

# Pull and show verbose output
git pull --verbose
git pull -v

# Pull all branches
git pull --all

# Pull with specific strategy
git pull --strategy=recursive
git pull --strategy=ours
```

**Pull conflicts:**

```bash
# Pull creates merge conflict
git pull origin main
# Auto-merging src/main/java/User.java
# CONFLICT (content): Merge conflict in src/main/java/User.java
# Automatic merge failed; fix conflicts and then commit the result.

# Resolve conflicts
vim src/main/java/User.java
git add src/main/java/User.java
git commit

# Or abort pull
git merge --abort
```

**Pull best practices:**

```bash
# Always pull before starting work
git pull origin main

# Before pushing
git pull --rebase origin main
git push origin main

# Check what pull will do (fetch first)
git fetch origin
git log --oneline main..origin/main
git pull  # Now merge fetched changes
```

---

### git pull --rebase (Fetch + Rebase)

Pull with rebase creates a linear history instead of merge commits.

**What pull --rebase does:**

```bash
git pull --rebase

# Equivalent to:
git fetch
git rebase origin/<current-branch>
```

**Pull --rebase visualization:**

```
Before pull --rebase:
Local main:      A---B---C---F---G
Remote main:     A---B---C---D---E

After pull --rebase:
Local main:      A---B---C---D---E---F'---G'
Remote main:     A---B---C---D---E

F' and G' are new commits (replayed on top of D-E)
```

**Pull --rebase commands:**

```bash
# Pull with rebase
git pull --rebase

# Pull with rebase from specific remote
git pull --rebase origin main

# Pull with interactive rebase
git pull --rebase=interactive
git pull --rebase=i

# Configure pull to always rebase
git config pull.rebase true
git config --global pull.rebase true

# Or configure per-branch
git config branch.main.rebase true
```

**Handling rebase conflicts:**

```bash
# Pull with rebase
git pull --rebase origin main
# CONFLICT (content): Merge conflict in src/main/java/User.java
# error: could not apply f6g7h8i... Add user validation

# Resolve conflict
vim src/main/java/User.java
git add src/main/java/User.java

# Continue rebase
git rebase --continue

# Or skip commit if needed
git rebase --skip

# Or abort rebase
git rebase --abort
```

**Pull vs Pull --rebase:**

```
Pull (merge):
─────────────
Local:   A---B---C-------M
              \         /
Remote:        D---E---F

• Creates merge commit M
• Preserves exact history
• Shows when pull happened
• Non-linear history

Pull --rebase:
──────────────
Local:   A---B---C---D---E---F'---B'---C'
Remote:  A---B---C---D---E---F

• No merge commit
• Linear history
• Commits B', C' are new (replayed)
• Cleaner history
```

**When to use pull --rebase:**

```bash
# ✅ Use pull --rebase when:
# - Working on feature branch
# - Want clean linear history
# - No one else has your commits
# - Before pushing

git checkout feature/my-work
git pull --rebase origin main
git push origin feature/my-work

# ❌ Don't use pull --rebase when:
# - On main/develop branch
# - Others have pulled your commits
# - Want to preserve exact history
# - In the middle of a merge
```

**Configure automatic rebase:**

```bash
# Configure pull to always use rebase
git config --global pull.rebase true

# Now git pull automatically uses rebase
git pull  # Same as git pull --rebase

# Per-repository configuration
git config pull.rebase true

# Per-branch configuration
git config branch.main.rebase true
```

---

### git push (Upload Changes)

Push uploads your local commits to a remote repository.

**Basic push:**

```bash
# Push current branch to its tracking remote
git push

# Push to specific remote and branch
git push origin main

# Push and set upstream tracking
git push -u origin feature/new-feature
git push --set-upstream origin feature/new-feature

# Push all branches
git push origin --all

# Push specific branch
git push origin develop
```

**Push visualization:**

```
Before push:
Local main:      A---B---C---D---E
Remote main:     A---B---C

After push:
Local main:      A---B---C---D---E
Remote main:     A---B---C---D---E
```

**Push options:**

```bash
# Push with verbose output
git push --verbose
git push -v

# Dry run (see what would be pushed)
git push --dry-run
git push -n

# Push tags
git push --tags
git push origin --tags

# Push specific tag
git push origin v1.0.0

# Delete remote branch
git push origin --delete feature/old-branch
git push origin :feature/old-branch  # Alternative syntax

# Push to different branch name
git push origin local-branch:remote-branch

# Push with lease (safer force push)
git push --force-with-lease origin main
```

**Push rejection:**

```bash
# Push fails when remote has commits you don't have
git push origin main
# To https://github.com/user/spring-boot-app.git
#  ! [rejected]        main -> main (fetch first)
# error: failed to push some refs to 'https://github.com/user/spring-boot-app.git'
# hint: Updates were rejected because the remote contains work that you do
# hint: not have locally. This is usually caused by another repository pushing
# hint: to the same ref. You may want to first integrate the remote changes
# hint: (e.g., 'git pull ...') before pushing again.

# Solution: Pull first, then push
git pull origin main
# Or with rebase
git pull --rebase origin main

# Then push
git push origin main
```

**Push multiple branches:**

```bash
# Push all branches
git push origin --all

# Push specific branches
git push origin main develop

# Push all tags
git push origin --tags

# Push everything (branches + tags)
git push origin --all --tags
```

**Push to multiple remotes:**

```bash
# Push to multiple remotes one by one
git push origin main
git push gitlab main
git push bitbucket main

# Or configure push URL to push to multiple
git remote set-url --add --push origin git@github.com:user/repo.git
git remote set-url --add --push origin git@gitlab.com:user/repo.git

# Now single push goes to both
git push origin main
```

---

### Force Push (git push --force-with-lease) - When and Why

Force push overwrites remote history. **Use with extreme caution!**

**Regular force push (DANGEROUS):**

```bash
# ⚠️ DANGEROUS: Overwrites remote unconditionally
git push --force origin feature/my-branch
git push -f origin feature/my-branch

# This will:
# - Overwrite remote history
# - Potentially lose other people's work
# - Break anyone who has pulled this branch
```

**Force with lease (SAFER):**

```bash
# ✅ SAFER: Only overwrites if no one else pushed
git push --force-with-lease origin feature/my-branch

# This will:
# - Check if remote has commits you don't have
# - Only push if remote is exactly what you expect
# - Fail if someone else pushed since your last fetch
```

**How --force-with-lease works:**

```bash
# Scenario 1: Safe force push
# ─────────────────────────────

# You fetch
git fetch origin

# Remote state: A---B---C
# Your state:   A---B---C'---D' (rebased)

# You force push with lease
git push --force-with-lease origin feature/my-branch
# ✅ SUCCESS: Remote matches what you expect

# Scenario 2: Prevented disaster
# ──────────────────────────────

# You fetch
git fetch origin
# Remote state: A---B---C

# Someone else pushes
# Remote state: A---B---C---E

# Your state:   A---B---C'---D' (rebased)

# You force push with lease
git push --force-with-lease origin feature/my-branch
# ❌ REJECTED: Remote has commits you don't have
# error: failed to push some refs
# The lease check failed

# You must fetch and integrate first
git fetch origin
git rebase origin/feature/my-branch
git push --force-with-lease origin feature/my-branch
```

**When force push is needed:**

```bash
# ✅ Legitimate use cases:

# 1. After interactive rebase (cleanup before PR)
git checkout feature/my-work
git rebase -i main
git push --force-with-lease origin feature/my-work

# 2. After amending commit message
git commit --amend -m "Better message"
git push --force-with-lease origin feature/my-work

# 3. After rebasing to update with main
git rebase main
git push --force-with-lease origin feature/my-work

# 4. Removing sensitive data
git filter-branch --force --index-filter \
  'git rm --cached --ignore-unmatch secrets.txt'
git push --force-with-lease origin main

# 5. Undoing pushed commits (on feature branch)
git reset --hard HEAD~2
git push --force-with-lease origin feature/my-work
```

**When NEVER to force push:**

```bash
# ❌ NEVER force push to:

# 1. Main/master branch
git push --force origin main  # DON'T!

# 2. Develop branch
git push --force origin develop  # DON'T!

# 3. Any shared branch others are working on
git push --force origin shared-feature  # DON'T!

# 4. Release branches
git push --force origin release/1.0.0  # DON'T!

# 5. Any public history
git push --force origin v1.0.0  # DON'T!
```

**Force push best practices:**

```bash
# ✅ DO:
# 1. Communicate with team before force pushing
# 2. Use --force-with-lease instead of --force
# 3. Only force push feature branches
# 4. Force push before others pull
# 5. Document why in commit message

# Example workflow:
# 1. Announce in team chat:
#    "Cleaning up feature/auth-refactor, will force push in 5 min"

# 2. Clean up history
git checkout feature/auth-refactor
git rebase -i main

# 3. Force push with lease
git push --force-with-lease origin feature/auth-refactor

# 4. Team members:
git checkout main
git branch -D feature/auth-refactor
git fetch origin
git checkout feature/auth-refactor

# ❌ DON'T:
# 1. Force push without communication
# 2. Use --force instead of --force-with-lease
# 3. Force push shared branches
# 4. Force push after others have pulled
# 5. Force push to recover from mistakes (use revert)
```

**Recovering from force push disaster:**

```bash
# If someone force pushed and you need to recover:

# 1. Check reflog
git reflog
# Find the commit before force push

# 2. Reset to that commit
git reset --hard abc123

# 3. Create backup branch
git branch backup-before-disaster

# 4. Communicate with team to decide next steps

# 5. Might need to force push to restore
#    (only if everyone agrees)
git push --force-with-lease origin main
```

---

## 3. Fork Workflow

### Forking Repositories

Forking creates a complete copy of a repository under your GitHub account.

**Fork process:**

```
Original repository (upstream):
github.com/spring-projects/spring-boot
├── 5,000 commits
├── 50 branches
├── 100 contributors
└── 1,000 forks

                  ↓ (click "Fork" button)

Your fork (origin):
github.com/yourname/spring-boot
├── Same 5,000 commits
├── Same 50 branches
├── You are the only contributor
└── Connected to upstream
```

**Why fork instead of clone:**

```
Fork:
─────
✅ Own copy on GitHub
✅ Can create pull requests to original
✅ Can push to your fork
✅ Safe to experiment
✅ Used for open-source contributions

Clone only:
───────────
❌ No GitHub copy
❌ Can't push (no permissions)
❌ Can't create pull requests
❌ Only for reading

Clone your fork:
────────────────
✅ Best of both worlds
✅ Local development
✅ Push to your fork
✅ Pull request to original
```

**Fork workflow setup:**

```bash
# 1. Fork repository on GitHub
#    Original: github.com/spring-projects/spring-boot
#    Click "Fork" button
#    Creates: github.com/yourname/spring-boot

# 2. Clone YOUR fork (not original)
git clone https://github.com/yourname/spring-boot.git
cd spring-boot

# 3. Check remote (only origin exists)
git remote -v
# origin  https://github.com/yourname/spring-boot.git (fetch)
# origin  https://github.com/yourname/spring-boot.git (push)

# 4. Add upstream (original repository)
git remote add upstream https://github.com/spring-projects/spring-boot.git

# 5. Verify both remotes
git remote -v
# origin    https://github.com/yourname/spring-boot.git (fetch)
# origin    https://github.com/yourname/spring-boot.git (push)
# upstream  https://github.com/spring-projects/spring-boot.git (fetch)
# upstream  https://github.com/spring-projects/spring-boot.git (push)

# 6. Disable push to upstream (prevent mistakes)
git remote set-url --push upstream no_push
# or
git remote set-url --push upstream DISABLE

# 7. Verify
git remote -v
# origin    https://github.com/yourname/spring-boot.git (fetch)
# origin    https://github.com/yourname/spring-boot.git (push)
# upstream  https://github.com/spring-projects/spring-boot.git (fetch)
# upstream  no_push (push)
```

---

### Keeping Fork in Sync

Keep your fork updated with the original repository.

**Sync workflow:**

```bash
# 1. Fetch latest from upstream
git fetch upstream

# 2. Check out your main branch
git checkout main

# 3. Merge upstream changes
git merge upstream/main
# or rebase
git rebase upstream/main

# 4. Push to your fork
git push origin main

# Alternative: One-liner
git checkout main && git fetch upstream && git merge upstream/main && git push origin main
```

**Detailed sync example:**

```bash
# Check current state
git remote -v
git branch -a

# Fetch all changes from upstream
git fetch upstream
# remote: Counting objects: 75, done.
# remote: Compressing objects: 100% (53/53), done.
# remote: Total 62 (delta 27), reused 44 (delta 9)
# Unpacking objects: 100% (62/62), done.
# From https://github.com/spring-projects/spring-boot
#  * [new branch]      feature/new-api    -> upstream/feature/new-api
#    a1b2c3d..x9y8z7w  main               -> upstream/main

# View what's new
git log --oneline main..upstream/main
# x9y8z7w Fix critical bug in auth
# w8x9y7z Add new REST endpoint
# v7w8x9y Update Spring Security to 6.0.0

# Check out main branch
git checkout main

# Merge upstream changes
git merge upstream/main
# Updating a1b2c3d..x9y8z7w
# Fast-forward
#  pom.xml                                    |  2 +-
#  src/main/java/auth/AuthService.java        | 10 +++++++---
#  src/main/java/rest/UserController.java     | 15 +++++++++++++++
#  3 files changed, 23 insertions(+), 4 deletions(-)

# Push to your fork
git push origin main
# To https://github.com/yourname/spring-boot.git
#    a1b2c3d..x9y8z7w  main -> main
```

**Sync all branches:**

```bash
# Fetch all from upstream
git fetch upstream

# Sync main
git checkout main
git merge upstream/main
git push origin main

# Sync develop
git checkout develop
git merge upstream/develop
git push origin develop

# Sync feature branches
git checkout feature/important
git merge upstream/feature/important
git push origin feature/important

# Or use script to sync all
git fetch upstream
for branch in main develop feature/auth feature/api; do
    git checkout $branch
    git merge upstream/$branch
    git push origin $branch
done
```

**Handle sync conflicts:**

```bash
# Merge conflict during sync
git merge upstream/main
# Auto-merging pom.xml
# CONFLICT (content): Merge conflict in pom.xml
# Automatic merge failed; fix conflicts and then commit the result.

# Resolve conflicts
vim pom.xml
git add pom.xml
git commit -m "Merge upstream/main into main"

# Push to fork
git push origin main

# Or abort and try rebase
git merge --abort
git rebase upstream/main
# Resolve conflicts
git rebase --continue
git push --force-with-lease origin main
```

**Automate sync (GitHub Actions):**

```yaml
# .github/workflows/sync-fork.yml
name: Sync Fork with Upstream

on:
  schedule:
    - cron: '0 0 * * 0'  # Weekly on Sunday
  workflow_dispatch:  # Manual trigger

jobs:
  sync:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
        with:
          token: ${{ secrets.GITHUB_TOKEN }}
      
      - name: Sync fork with upstream
        run: |
          git config user.name "github-actions[bot]"
          git config user.email "github-actions[bot]@users.noreply.github.com"
          
          git remote add upstream https://github.com/spring-projects/spring-boot.git
          git fetch upstream
          
          git checkout main
          git merge upstream/main
          git push origin main
```

---

### Creating Pull Requests from Forks

Contribute to the original repository by creating pull requests.

**Pull request workflow:**

```bash
# 1. Sync your fork with upstream
git fetch upstream
git checkout main
git merge upstream/main
git push origin main

# 2. Create feature branch
git checkout -b feature/add-validation

# 3. Make changes
vim src/main/java/User.java
git add .
git commit -m "feat: Add email validation

Implements email validation using regex pattern.
Adds comprehensive tests for edge cases.

Resolves #123"

# 4. Push to YOUR fork
git push origin feature/add-validation

# 5. Create PR on GitHub
#    - Go to YOUR fork on GitHub
#    - Click "Compare & pull request"
#    - Base repository: spring-projects/spring-boot (upstream)
#    - Base branch: main
#    - Head repository: yourname/spring-boot (origin)
#    - Compare branch: feature/add-validation
#    - Fill in PR description
#    - Click "Create pull request"
```

**PR best practices:**

```markdown
# Pull Request Template

## Description
Brief description of changes

## Motivation
Why are these changes needed?

## Changes Made
- Added email validation to User model
- Implemented regex pattern matching
- Added unit tests with 95% coverage
- Updated documentation

## Type of Change
- [ ] Bug fix
- [x] New feature
- [ ] Breaking change
- [ ] Documentation update

## Testing
- [x] Unit tests pass
- [x] Integration tests pass
- [x] Manual testing completed
- [ ] Added new tests

## Related Issues
Closes #123
Related to #456

## Checklist
- [x] Code follows project style guidelines
- [x] Self-review completed
- [x] Comments added for complex code
- [x] Documentation updated
- [x] No new warnings
- [x] Tests added
```

**Update PR after feedback:**

```bash
# Make changes based on review comments
vim src/main/java/User.java
git add .
git commit -m "refactor: Extract validation to separate method"

# Push to same branch
git push origin feature/add-validation

# PR automatically updates with new commits

# If need to squash commits:
git rebase -i main
# Squash commits
git push --force-with-lease origin feature/add-validation
```

---

### Upstream Remote Setup

Properly configuring upstream ensures smooth fork workflows.

**Complete upstream setup:**

```bash
# 1. Fork repository on GitHub
# 2. Clone your fork
git clone https://github.com/yourname/spring-boot.git
cd spring-boot

# 3. Add upstream remote
git remote add upstream https://github.com/spring-projects/spring-boot.git

# 4. Fetch from upstream
git fetch upstream

# 5. Set upstream tracking for main branch
git branch --set-upstream-to=upstream/main main

# 6. Disable accidental push to upstream
git remote set-url --push upstream no_push

# 7. Configure automatic fetch
git config remote.upstream.fetch "+refs/heads/*:refs/remotes/upstream/*"

# 8. Verify configuration
git remote -v
git remote show upstream
git branch -vv
```

**Advanced upstream configuration:**

```bash
# Fetch only specific branches from upstream
git config remote.upstream.fetch "+refs/heads/main:refs/remotes/upstream/main"
git config --add remote.upstream.fetch "+refs/heads/develop:refs/remotes/upstream/develop"

# Fetch pull requests from upstream
git config --add remote.upstream.fetch "+refs/pull/*/head:refs/remotes/upstream/pr/*"

# Now you can checkout any PR
git fetch upstream
git checkout upstream/pr/1234

# Automatic pruning of deleted upstream branches
git config remote.upstream.prune true

# Set default push remote (always push to origin)
git config remote.pushDefault origin
```

**Working with multiple upstreams:**

```bash
# Scenario: Contributing to multiple related projects

# Spring Boot main project
git remote add upstream-boot https://github.com/spring-projects/spring-boot.git

# Spring Framework (dependency)
git remote add upstream-framework https://github.com/spring-projects/spring-framework.git

# Your organization's fork
git remote add company https://github.com/company/spring-boot.git

# Verify all remotes
git remote -v
# company             https://github.com/company/spring-boot.git (fetch)
# company             https://github.com/company/spring-boot.git (push)
# origin              https://github.com/yourname/spring-boot.git (fetch)
# origin              https://github.com/yourname/spring-boot.git (push)
# upstream-boot       https://github.com/spring-projects/spring-boot.git (fetch)
# upstream-boot       no_push (push)
# upstream-framework  https://github.com/spring-projects/spring-framework.git (fetch)
# upstream-framework  no_push (push)

# Fetch from all
git fetch --all

# Sync with specific upstream
git merge upstream-boot/main
```

---

## Summary

### Working with Remotes

- ✅ **git clone**: Creates complete local copy with remote tracking
- ✅ **git remote**: Manage remote repositories (add, remove, rename)
- ✅ **origin vs upstream**: Fork workflow naming conventions
- ✅ **Tracking branches**: Link local branches to remote branches

### Synchronization

- ✅ **git fetch**: Download changes without merging
- ✅ **git pull**: Fetch + merge in one command
- ✅ **git pull --rebase**: Fetch + rebase for linear history
- ✅ **git push**: Upload local commits to remote
- ✅ **Force push**: Use --force-with-lease for safety

### Fork Workflow

- ✅ **Forking**: Create your own copy for contributions
- ✅ **Syncing**: Keep fork updated with upstream
- ✅ **Pull requests**: Contribute back to original project
- ✅ **Upstream setup**: Proper remote configuration

**Key Takeaways:**

- Clone creates complete repository with history
- Fetch downloads without modifying working directory
- Pull = fetch + merge (or rebase)
- Always use --force-with-lease instead of --force
- Fork workflow: origin (your fork) + upstream (original)
- Keep fork synced regularly with upstream
- Create feature branches for pull requests

**Best Practices:**

- Pull before starting work
- Push regularly to backup work
- Use meaningful remote names
- Disable push to upstream
- Communicate before force pushing
- Keep fork main branch clean
