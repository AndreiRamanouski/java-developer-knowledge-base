## Overview

Following Git best practices ensures clean history, secure code, and efficient team collaboration. This guide covers essential practices for professional Java development.

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚              GIT BEST PRACTICES                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                        â”‚
â”‚  1. COMMIT GUIDELINES                                  â”‚
â”‚     â€¢ Atomic commits (one logical change)             â”‚
â”‚     â€¢ Conventional Commits format                     â”‚
â”‚     â€¢ Clear, descriptive messages                     â”‚
â”‚                                                        â”‚
â”‚  2. .GITIGNORE                                         â”‚
â”‚     â€¢ Build artifacts (target/, build/)               â”‚
â”‚     â€¢ IDE files (.idea/, .vscode/)                    â”‚
â”‚     â€¢ Secrets (.env, credentials)                     â”‚
â”‚     â€¢ OS files (.DS_Store, Thumbs.db)                 â”‚
â”‚                                                        â”‚
â”‚  3. GIT HOOKS                                          â”‚
â”‚     â€¢ pre-commit: Lint, format check                  â”‚
â”‚     â€¢ commit-msg: Enforce message format              â”‚
â”‚     â€¢ pre-push: Run tests                             â”‚
â”‚                                                        â”‚
â”‚  4. SECURITY                                           â”‚
â”‚     â€¢ Never commit secrets                            â”‚
â”‚     â€¢ Use environment variables                       â”‚
â”‚     â€¢ Scan for leaked credentials                     â”‚
â”‚     â€¢ Remove secrets from history                     â”‚
â”‚                                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## 1. Commit Guidelines

### Atomic Commits (One Logical Change)

Each commit should represent one logical, self-contained change.

**What is an atomic commit:**

```
Atomic commit = Single, focused change that:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

âœ“ Can be described in one sentence
âœ“ Does one thing well
âœ“ Compiles and passes tests
âœ“ Can be reverted independently
âœ“ Makes sense in isolation
âœ“ Has related changes grouped together
```

**Examples of atomic commits:**

```bash
# âœ… GOOD: Atomic commits

# Commit 1: Add feature
git add src/main/java/User.java
git commit -m "feat: Add email field to User entity"

# Commit 2: Add validation
git add src/main/java/UserValidator.java
git commit -m "feat: Add email validation logic"

# Commit 3: Add tests
git add src/test/java/UserValidatorTest.java
git commit -m "test: Add email validation tests"

# Each commit is focused, independent, and testable

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# âŒ BAD: Non-atomic commits

# Too big - multiple unrelated changes
git add src/main/java/User.java \
        src/main/java/Payment.java \
        src/main/java/Order.java
git commit -m "Added email, fixed payment bug, refactored orders"

# Too small - incomplete change
git add src/main/java/User.java
git commit -m "feat: Add email field"
# Forgot to add migration, validator breaks!

# Mixed concerns
git add src/main/java/User.java \
        pom.xml \
        src/main/resources/application.yml
git commit -m "Updated user and changed configs"
```

**Atomic commit checklist:**

```markdown
Before committing, verify:

â–¡ Commit does ONE thing
â–¡ All related changes are included
â–¡ Code compiles
â–¡ Tests pass
â–¡ No unrelated changes included
â–¡ Can be described in single sentence
â–¡ Makes sense without other commits
â–¡ Can be reverted safely
```

**Breaking down large changes:**

```bash
# Large feature: User registration system

# âŒ ONE COMMIT (bad)
git add .
git commit -m "Add user registration"

# âœ… MULTIPLE ATOMIC COMMITS (good)

# Commit 1: Data model
git add src/main/java/entity/User.java
git commit -m "feat: Add User entity with JPA annotations"

# Commit 2: Repository
git add src/main/java/repository/UserRepository.java
git commit -m "feat: Add UserRepository interface"

# Commit 3: Service
git add src/main/java/service/UserService.java
git commit -m "feat: Implement user registration service"

# Commit 4: Controller
git add src/main/java/controller/UserController.java
git commit -m "feat: Add user registration REST endpoint"

# Commit 5: Validation
git add src/main/java/validation/UserValidator.java
git commit -m "feat: Add user input validation"

# Commit 6: Tests
git add src/test/java/service/UserServiceTest.java
git commit -m "test: Add user service unit tests"

# Commit 7: Integration tests
git add src/test/java/integration/UserRegistrationTest.java
git commit -m "test: Add registration integration tests"

# Each commit is focused and can be reviewed independently
```

---

### Meaningful Commit Messages (Conventional Commits)

Use Conventional Commits format for consistent, parseable messages.

**Conventional Commits structure:**

```
<type>[optional scope]: <description>

[optional body]

[optional footer(s)]
```

**Commit types:**

```
Types (from Angular convention):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

feat:     New feature for the user
fix:      Bug fix for the user
docs:     Documentation only changes
style:    Code style changes (formatting, semicolons, etc.)
refactor: Code change that neither fixes bug nor adds feature
perf:     Performance improvement
test:     Adding or correcting tests
build:    Changes to build system or dependencies (pom.xml, gradle)
ci:       Changes to CI configuration files and scripts
chore:    Other changes that don't modify src or test files
revert:   Reverts a previous commit
```

**Message structure:**

```
Subject line (50 characters max):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Imperative mood ("Add feature" not "Added feature")
â€¢ No period at end
â€¢ Capitalize first letter
â€¢ Be specific and descriptive

Body (wrap at 72 characters):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
â€¢ Explain WHAT and WHY, not HOW
â€¢ Separate from subject with blank line
â€¢ Use bullet points for multiple points
â€¢ Provide context and reasoning

Footer:
â”€â”€â”€â”€â”€â”€â”€
â€¢ Reference issues: "Fixes #123", "Closes #456"
â€¢ Breaking changes: "BREAKING CHANGE: ..."
â€¢ Reviewed-by, Signed-off-by, etc.
```

**Complete examples:**

```bash
# Example 1: Feature with scope
git commit -m "feat(auth): Implement JWT authentication

Adds JWT-based authentication to replace session cookies:
- Token generation on login
- Token validation middleware
- Refresh token support
- 24-hour expiration

This improves scalability by making authentication stateless
and allows easier horizontal scaling.

Resolves: #123
Reviewed-by: @tech-lead"

# Example 2: Bug fix
git commit -m "fix(payment): Prevent duplicate charge on retry

Race condition allowed duplicate charges when user retried
payment after network timeout.

Added idempotency key to payment processing:
- Generate unique key per payment attempt
- Store key with transaction
- Reject duplicate keys within 24 hours

Fixes: #456
Breaking change: Requires database migration 2024-01-15"

# Example 3: Performance improvement
git commit -m "perf(search): Add database index on user_email

Search by email was taking 5+ seconds for large user tables
due to sequential scan.

Added B-tree index on user_email column. Search now completes
in <100ms for tables with 1M+ users.

Before: 5,234ms average
After:  87ms average

Benchmarks included in commit message."

# Example 4: Refactoring
git commit -m "refactor(user): Extract validation to separate service

UserController had grown to 800 lines with complex validation
logic mixed with HTTP handling.

Extracted to UserValidationService:
- Better separation of concerns
- Easier to test in isolation
- Reusable across controllers
- Single responsibility principle

No behavior change. All tests pass."

# Example 5: Breaking change
git commit -m "feat(api)!: Change user endpoint response format

BREAKING CHANGE: User API response format has changed.

Before:
{
  \"name\": \"John Doe\",
  \"email\": \"john@example.com\"
}

After:
{
  \"user\": {
    \"fullName\": \"John Doe\",
    \"emailAddress\": \"john@example.com\"
  }
}

Clients must update to handle new format.
Migration guide: docs/migration/v2-api.md

Resolves: #789"
```

**Subject line guidelines:**

```bash
# âœ… GOOD subject lines

feat: Add password reset functionality
fix: Correct null pointer in payment service
docs: Update API authentication documentation
refactor: Simplify user validation logic
test: Add edge cases for email validator
perf: Optimize database query for user search

# âŒ BAD subject lines

Added feature  # Past tense, no type
fixed stuff  # Vague, no context
WIP  # Not descriptive
Updated files  # What files? Why?
Bug fix  # Which bug?
Changes  # Not specific
```

**Body guidelines:**

```bash
# âœ… GOOD body (explains WHY)

"""
feat: Add rate limiting to authentication endpoint

Authentication endpoint was vulnerable to brute force attacks.
Added rate limiting to prevent credential stuffing:

- 5 attempts per IP per minute
- 20 attempts per IP per hour
- 429 status code when limit exceeded
- Exponential backoff for repeated violations

This improves security without impacting legitimate users.
99.9% of users make <3 login attempts.

Implements: SEC-123
"""

# âŒ BAD body (only says WHAT)

"""
feat: Add rate limiting

Added rate limiting code.
"""
```

---

### Message Structure: Subject (50 chars), Body, Footer

**Template:**

```
<type>(<scope>): <subject line max 50 chars>

<body wrapped at 72 characters explaining what and why>

<footer with references and metadata>
```

**Real example with measurements:**

```
feat(auth): Implement OAuth2 social login
         â†‘                                â†‘
    Type + scope                    47 characters

Adds OAuth2 authentication for Google and GitHub:
                                                  â†‘
                                        72 characters

Social login improves user onboarding:
- 40% of users prefer social login (user survey)
- Reduces registration friction
- Fewer forgotten passwords

Implementation:
- Spring Security OAuth2 Client
- Google OAuth2 provider configuration
- GitHub OAuth2 provider configuration
- User account linking for existing emails

Security considerations:
- Email verification still required
- OAuth tokens stored encrypted
- Refresh tokens rotated every 7 days

Resolves: #123, #456
Reviewed-by: @security-lead
Breaking change: Requires new environment variables
                 OAUTH_GOOGLE_CLIENT_ID
                 OAUTH_GOOGLE_CLIENT_SECRET
                 OAUTH_GITHUB_CLIENT_ID
                 OAUTH_GITHUB_CLIENT_SECRET
```

**Commit message template file:**

```bash
# Create commit message template
cat > ~/.gitmessage << 'EOF'
# <type>(<scope>): <subject> (max 50 chars)
# |<----  Using a Maximum Of 50 Characters  ---->|

# Explain why this change is being made
# |<----   Try To Limit Each Line to a Maximum Of 72 Characters   ---->|

# Provide links or keys to any relevant tickets, articles or other resources
# Example: Fixes #23

# --- COMMIT END ---
# Type can be
#    feat     (new feature)
#    fix      (bug fix)
#    refactor (refactoring code)
#    style    (formatting, missing semi colons, etc; no code change)
#    docs     (changes to documentation)
#    test     (adding or refactoring tests; no production code change)
#    chore    (updating build tasks, package manager configs, etc)
#    perf     (performance improvement)
# --------------------
# Remember to
#    Capitalize the subject line
#    Use the imperative mood in the subject line
#    Do not end the subject line with a period
#    Separate subject from body with a blank line
#    Use the body to explain what and why vs. how
#    Can use multiple lines with "-" for bullet points in body
# --------------------
EOF

# Configure git to use template
git config --global commit.template ~/.gitmessage
```

---

## 2. .gitignore

### What to Ignore (Build Artifacts, IDE Files, Secrets)

**Comprehensive .gitignore for Java projects:**

```bash
# .gitignore

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Build artifacts
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Maven
target/
pom.xml.tag
pom.xml.releaseBackup
pom.xml.versionsBackup
pom.xml.next
release.properties
dependency-reduced-pom.xml
buildNumber.properties
.mvn/timing.properties
.mvn/wrapper/maven-wrapper.jar

# Gradle
.gradle/
build/
!gradle/wrapper/gradle-wrapper.jar
!**/src/main/**/build/
!**/src/test/**/build/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# IDE files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# IntelliJ IDEA
.idea/
*.iml
*.iws
*.ipr
out/
.idea_modules/

# Eclipse
.classpath
.project
.settings/
bin/
.metadata/
.recommenders/

# NetBeans
nbproject/private/
nbbuild/
dist/
nbdist/
.nb-gradle/

# VS Code
.vscode/
*.code-workspace
.history/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OS files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# macOS
.DS_Store
.AppleDouble
.LSOverride
._*

# Windows
Thumbs.db
Thumbs.db:encryptable
ehthumbs.db
ehthumbs_vista.db
Desktop.ini

# Linux
*~
.directory
.Trash-*

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Logs
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.log
logs/
*.log.*
log/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Temporary files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.tmp
*.temp
*.swp
*.swo
*~.nib
.cache/
tmp/
temp/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Secrets and credentials
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Environment variables
.env
.env.local
.env.*.local

# Credentials
**/credentials.json
**/secrets.yml
**/secrets.yaml
*.key
*.pem
*.p12
*.jks
*.keystore

# AWS
.aws/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Database
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.db
*.sqlite
*.sqlite3
h2/
*.h2.db

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Compiled files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.class
*.jar
*.war
*.ear
*.nar

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Package Files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.zip
*.tar.gz
*.rar

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Spring Boot specific
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

HELP.md
.springBeans
spring-shell.log

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Test coverage
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

coverage/
.nyc_output/
jacoco/
*.exec

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Node (for frontend)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

node_modules/
npm-debug.log*
yarn-debug.log*
yarn-error.log*

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Docker
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

.dockerignore
docker-compose.override.yml
```

---

### Patterns (Wildcards, Directories, Negation)

**Pattern syntax:**

```bash
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Basic patterns
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Ignore specific file
secret.txt

# Ignore all files with extension
*.log

# Ignore all files in directory
logs/

# Ignore directory recursively
**/node_modules/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Wildcards
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# * matches any characters except /
*.class           # All .class files
temp*             # Files starting with "temp"
*debug*           # Files containing "debug"

# ** matches any number of directories
**/logs/          # logs/ in any directory
src/**/test/      # test/ anywhere under src/

# ? matches single character
file?.txt         # file1.txt, fileA.txt
test-?.log        # test-1.log, test-a.log

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Negation (don't ignore)
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Ignore all .jar files except spring-boot.jar
*.jar
!spring-boot.jar

# Ignore all in config/ except production.yml
config/*
!config/production.yml

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Character ranges
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Ignore file1.txt through file9.txt
file[0-9].txt

# Ignore fileA.txt through fileZ.txt
file[A-Z].txt

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Comments
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# This is a comment
*.log    # Inline comment

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Directories
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Trailing slash means directory only
build/            # Ignore build directory
!build/README.md  # But keep README in build/

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Root directory only
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

/TODO             # Ignore TODO in root only
!/docs/TODO       # Keep TODO in docs/
```

**Complex example:**

```bash
# .gitignore with detailed patterns

# Ignore all .log files
*.log

# Except keep error.log for debugging
!error.log

# But ignore error.log in the logs directory
logs/error.log

# Ignore all files in temp directory
temp/**

# But keep temp/cache/important.txt
!temp/cache/
!temp/cache/important.txt

# Ignore all .class files in target
target/**/*.class

# Ignore build artifacts but keep shell scripts
build/**
!build/**/*.sh

# Ignore IDE files but keep shared settings
.idea/**
!.idea/codeStyles/
!.idea/codeStyles/Project.xml
```

---

### Global gitignore (~/.gitignore_global)

Apply ignore patterns to all repositories on your machine.

**Create global gitignore:**

```bash
# Create global gitignore file
cat > ~/.gitignore_global << 'EOF'
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# OS Files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# macOS
.DS_Store
.AppleDouble
.LSOverride
Icon
._*
.Spotlight-V100
.Trashes

# Windows
Thumbs.db
Thumbs.db:encryptable
ehthumbs.db
Desktop.ini
$RECYCLE.BIN/

# Linux
*~
.directory

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# IDE and Editor Files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# IntelliJ IDEA
.idea/
*.iml

# VS Code
.vscode/
*.code-workspace

# Vim
*.swp
*.swo
*~
.*.sw[a-z]

# Emacs
*~
\#*\#
.\#*

# Sublime Text
*.sublime-project
*.sublime-workspace

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Temporary Files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

*.tmp
*.temp
*.bak
*.old

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Personal Files
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

# Personal notes
TODO.txt
NOTES.md
scratch.txt

# Personal scripts
my-*.sh
personal-*.py
EOF

# Configure git to use global gitignore
git config --global core.excludesfile ~/.gitignore_global
```

**Verify global gitignore:**

```bash
# Check configuration
git config --global core.excludesfile
# /Users/username/.gitignore_global

# Test in any repository
touch .DS_Store
git status
# .DS_Store should not appear (ignored globally)
```

**When to use global vs local gitignore:**

```
Global gitignore (~/.gitignore_global):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ OS-specific files (.DS_Store, Thumbs.db)
âœ“ Personal IDE preferences (.idea/, .vscode/)
âœ“ Personal tools and scripts
âœ“ Text editor temporary files (*.swp, *~)

Local gitignore (.gitignore in repo):
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
âœ“ Project-specific files (target/, build/)
âœ“ Framework/language files (node_modules/)
âœ“ Project secrets (.env)
âœ“ Generated documentation (docs/build/)
```

---

### Removing Already-Tracked Files (git rm --cached)

Remove files from Git tracking while keeping them locally.

**Scenario: Accidentally committed files**

```bash
# You committed secret.txt before adding to .gitignore
git status
# nothing to commit

# Add to .gitignore
echo "secret.txt" >> .gitignore

# Git still tracks it!
git status
# nothing to commit (secret.txt still tracked)

# Remove from Git but keep local file
git rm --cached secret.txt

# Now Git stops tracking it
git status
# Changes to be committed:
#   deleted:    secret.txt
# Untracked files:
#   secret.txt (local file still exists)

# Commit the removal
git commit -m "chore: Remove secret.txt from version control"
git push origin main

# File is now ignored
```

**Remove directory recursively:**

```bash
# Remove entire directory from tracking
git rm -r --cached target/

# Commit removal
git commit -m "chore: Remove build artifacts from version control"
```

**Remove multiple files:**

```bash
# Remove all .log files
git rm --cached *.log

# Remove all files matching pattern
git rm --cached '*.class'

# Note: Use quotes to prevent shell expansion
```

**Clean up accidentally committed IDE files:**

```bash
# Add IDE files to .gitignore
cat >> .gitignore << 'EOF'
.idea/
*.iml
.vscode/
EOF

# Remove from Git
git rm -r --cached .idea/
git rm --cached *.iml
git rm -r --cached .vscode/

# Commit
git commit -m "chore: Remove IDE files from version control

Added .idea/, *.iml, and .vscode/ to .gitignore.
These files are personal and should not be tracked."

git push origin main
```

**Complete cleanup workflow:**

```bash
# 1. Update .gitignore
vim .gitignore
# Add patterns for files to ignore

# 2. Remove from Git (keep local)
git rm -r --cached target/
git rm --cached *.log
git rm -r --cached .idea/

# 3. Verify what will be committed
git status
# Should show deletions of ignored files

# 4. Commit
git commit -m "chore: Remove build artifacts and IDE files

Updated .gitignore to ignore:
- target/ (Maven build)
- *.log (log files)
- .idea/ (IntelliJ IDEA)

Removed these files from version control but kept locally."

# 5. Push
git push origin main

# 6. Verify ignored
touch target/test.class
git status
# target/test.class should not appear
```

---

## 3. Git Hooks

### Client-Side Hooks

Client-side hooks run on your local machine.

#### pre-commit

Runs before commit is created. Perfect for linting and formatting checks.

```bash
# .git/hooks/pre-commit
#!/bin/bash

echo "Running pre-commit checks..."

# Check Java code formatting
echo "Checking code formatting..."
mvn spotless:check
if [ $? -ne 0 ]; then
    echo "âŒ Code formatting check failed!"
    echo "Run 'mvn spotless:apply' to fix formatting"
    exit 1
fi

# Run Checkstyle
echo "Running Checkstyle..."
mvn checkstyle:check
if [ $? -ne 0 ]; then
    echo "âŒ Checkstyle violations found!"
    exit 1
fi

# Run tests
echo "Running tests..."
mvn test
if [ $? -ne 0 ]; then
    echo "âŒ Tests failed!"
    exit 1
fi

# Check for debug statements
echo "Checking for debug statements..."
if git diff --cached | grep -E "(System\.out\.println|printStackTrace|TODO|FIXME)"; then
    echo "âŒ Found debug statements or TODOs!"
    echo "Please remove before committing"
    exit 1
fi

# Check for secrets
echo "Checking for potential secrets..."
if git diff --cached | grep -E "(password|api_key|secret|token)\s*=\s*['\"][^'\"]+['\"]"; then
    echo "âŒ Potential secret found in commit!"
    echo "Please remove sensitive data"
    exit 1
fi

echo "âœ… All pre-commit checks passed!"
exit 0
```

#### prepare-commit-msg

Modify commit message before editor opens.

```bash
# .git/hooks/prepare-commit-msg
#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

# Add branch name to commit message
BRANCH_NAME=$(git symbolic-ref --short HEAD)

# Don't add for main/master
if [ "$BRANCH_NAME" != "main" ] && [ "$BRANCH_NAME" != "master" ]; then
    # Extract JIRA ticket from branch name (e.g., feature/PROJ-123-description)
    TICKET=$(echo "$BRANCH_NAME" | grep -o -E '[A-Z]+-[0-9]+')
    
    if [ -n "$TICKET" ]; then
        # Prepend ticket to commit message
        echo "[$TICKET] $(cat $COMMIT_MSG_FILE)" > $COMMIT_MSG_FILE
    fi
fi
```

#### commit-msg

Validate commit message format.

```bash
# .git/hooks/commit-msg
#!/bin/bash

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat $COMMIT_MSG_FILE)

# Check Conventional Commits format
# Pattern: type(scope): description
PATTERN="^(feat|fix|docs|style|refactor|perf|test|build|ci|chore|revert)(\(.+\))?: .{1,50}"

if ! echo "$COMMIT_MSG" | grep -qE "$PATTERN"; then
    echo "âŒ Invalid commit message format!"
    echo ""
    echo "Commit message must follow Conventional Commits:"
    echo "  <type>(<scope>): <description>"
    echo ""
    echo "Types: feat, fix, docs, style, refactor, perf, test, build, ci, chore, revert"
    echo ""
    echo "Examples:"
    echo "  feat(auth): Add JWT authentication"
    echo "  fix(payment): Prevent duplicate charges"
    echo "  docs(api): Update API documentation"
    echo ""
    echo "Your message:"
    echo "  $COMMIT_MSG"
    exit 1
fi

# Check subject line length (max 50 chars after type)
SUBJECT=$(echo "$COMMIT_MSG" | head -n 1)
SUBJECT_LENGTH=${#SUBJECT}

if [ $SUBJECT_LENGTH -gt 72 ]; then
    echo "âŒ Subject line too long ($SUBJECT_LENGTH chars, max 72)"
    echo "Subject: $SUBJECT"
    exit 1
fi

# Check for period at end of subject
if echo "$SUBJECT" | grep -q "\.$"; then
    echo "âŒ Subject line should not end with a period"
    echo "Subject: $SUBJECT"
    exit 1
fi

echo "âœ… Commit message format valid"
exit 0
```

#### post-commit

Run after commit is created.

```bash
# .git/hooks/post-commit
#!/bin/bash

# Notify about commit
COMMIT_MSG=$(git log -1 --pretty=%B)
COMMIT_SHA=$(git rev-parse --short HEAD)

echo "âœ… Committed: $COMMIT_SHA"
echo "Message: $COMMIT_MSG"

# Optional: Update changelog
BRANCH=$(git symbolic-ref --short HEAD)
if [ "$BRANCH" = "main" ]; then
    echo "$(date +'%Y-%m-%d %H:%M:%S') - $COMMIT_SHA: $COMMIT_MSG" >> .changelog
fi
```

---

### Server-Side Hooks

Server-side hooks run on the Git server (GitHub, GitLab, etc.).

#### pre-receive

Runs before refs are updated on server.

```bash
# .git/hooks/pre-receive
#!/bin/bash

# Reject force pushes to main
while read oldrev newrev refname; do
    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
    
    if [ "$branch" = "main" ] || [ "$branch" = "master" ]; then
        # Check if it's a force push
        if [ "$oldrev" != "0000000000000000000000000000000000000000" ]; then
            # Check if old commit is ancestor of new commit
            if ! git merge-base --is-ancestor $oldrev $newrev; then
                echo "âŒ Force push to $branch is not allowed!"
                exit 1
            fi
        fi
    fi
done

exit 0
```

#### update

Runs once per branch being updated.

```bash
# .git/hooks/update
#!/bin/bash

refname=$1
oldrev=$2
newrev=$3

branch=$(git rev-parse --symbolic --abbrev-ref $refname)

# Prevent deletion of protected branches
if [ "$newrev" = "0000000000000000000000000000000000000000" ]; then
    if [ "$branch" = "main" ] || [ "$branch" = "develop" ]; then
        echo "âŒ Cannot delete protected branch: $branch"
        exit 1
    fi
fi

# Require signed commits on main
if [ "$branch" = "main" ]; then
    # Check if commits are signed
    for commit in $(git rev-list $oldrev..$newrev); do
        if ! git verify-commit $commit 2>/dev/null; then
            echo "âŒ Commit $commit is not signed!"
            echo "All commits to main must be signed"
            exit 1
        fi
    done
fi

exit 0
```

#### post-receive

Runs after refs are updated on server.

```bash
# .git/hooks/post-receive
#!/bin/bash

# Deploy on push to main
while read oldrev newrev refname; do
    branch=$(git rev-parse --symbolic --abbrev-ref $refname)
    
    if [ "$branch" = "main" ]; then
        echo "Deploying to production..."
        
        # Trigger deployment
        curl -X POST https://deploy.example.com/deploy \
            -H "Authorization: Bearer $DEPLOY_TOKEN" \
            -d "{\"ref\": \"$newrev\"}"
        
        # Send notification
        curl -X POST $SLACK_WEBHOOK \
            -H 'Content-Type: application/json' \
            -d "{\"text\": \"ğŸš€ Deployed commit ${newrev:0:7} to production\"}"
    fi
done

exit 0
```

---

### Enforcing Standards (Linting, Tests Before Commit)

**Comprehensive pre-commit hook:**

```bash
# .git/hooks/pre-commit
#!/bin/bash

set -e  # Exit on first error

echo "ğŸ” Running pre-commit checks..."

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 1. Check for unstaged changes
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

if ! git diff-files --quiet; then
    echo "âŒ You have unstaged changes!"
    echo "Please stage or stash them before committing"
    exit 1
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 2. Code formatting
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸ“ Checking code formatting..."
if command -v mvn &> /dev/null; then
    if ! mvn spotless:check -q; then
        echo "âŒ Code formatting issues found!"
        echo "Run: mvn spotless:apply"
        exit 1
    fi
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 3. Linting
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸ” Running Checkstyle..."
if command -v mvn &> /dev/null; then
    if ! mvn checkstyle:check -q; then
        echo "âŒ Checkstyle violations found!"
        exit 1
    fi
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 4. Unit tests
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸ§ª Running unit tests..."
if command -v mvn &> /dev/null; then
    if ! mvn test -q; then
        echo "âŒ Tests failed!"
        exit 1
    fi
fi

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 5. Check for forbidden patterns
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸš« Checking for forbidden patterns..."

FORBIDDEN_PATTERNS=(
    "System\.out\.println"
    "printStackTrace"
    "\.printStackTrace()"
    "console\.log"
    "debugger;"
    "TODO:"
    "FIXME:"
)

for pattern in "${FORBIDDEN_PATTERNS[@]}"; do
    if git diff --cached | grep -E "$pattern"; then
        echo "âŒ Found forbidden pattern: $pattern"
        echo "Please remove before committing"
        exit 1
    fi
done

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 6. Check for secrets
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸ”’ Scanning for secrets..."

SECRET_PATTERNS=(
    "(password|passwd|pwd)\s*=\s*['\"][^'\"]{3,}['\"]"
    "(api_key|apikey)\s*=\s*['\"][^'\"]{10,}['\"]"
    "(secret|token)\s*=\s*['\"][^'\"]{10,}['\"]"
    "-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----"
)

for pattern in "${SECRET_PATTERNS[@]}"; do
    if git diff --cached | grep -iE "$pattern"; then
        echo "âŒ Potential secret found!"
        echo "Pattern: $pattern"
        exit 1
    fi
done

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# 7. Check file sizes
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "ğŸ“¦ Checking file sizes..."

MAX_FILE_SIZE=1048576  # 1MB in bytes

while read status file; do
    if [ "$status" = "A" ] || [ "$status" = "M" ]; then
        size=$(stat -f%z "$file" 2>/dev/null || stat -c%s "$file")
        if [ "$size" -gt "$MAX_FILE_SIZE" ]; then
            echo "âŒ File too large: $file ($(numfmt --to=iec-i --suffix=B $size))"
            echo "Maximum allowed: 1MB"
            exit 1
        fi
    fi
done < <(git diff --cached --name-status)

# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
# Success!
# â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

echo "âœ… All pre-commit checks passed!"
exit 0
```

---

### Tools: Husky (Node), pre-commit Framework

#### Husky (for Node.js/JavaScript in Java project)

```bash
# Install Husky (if you have package.json)
npm install --save-dev husky

# Initialize Husky
npx husky install

# Create pre-commit hook
npx husky add .husky/pre-commit "mvn clean test"

# .husky/pre-commit content:
#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "Running pre-commit checks..."
mvn spotless:check
mvn test

# Make executable
chmod +x .husky/pre-commit
```

#### pre-commit Framework (Python-based)

```bash
# Install pre-commit framework
pip install pre-commit

# Create .pre-commit-config.yaml
cat > .pre-commit-config.yaml << 'EOF'
repos:
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: trailing-whitespace
      - id: end-of-file-fixer
      - id: check-yaml
      - id: check-added-large-files
        args: ['--maxkb=1000']
      - id: check-merge-conflict
      - id: detect-private-key
      
  - repo: local
    hooks:
      - id: maven-test
        name: Maven Test
        entry: mvn test
        language: system
        pass_filenames: false
        
      - id: checkstyle
        name: Checkstyle
        entry: mvn checkstyle:check
        language: system
        pass_filenames: false
        
      - id: spotless
        name: Spotless Check
        entry: mvn spotless:check
        language: system
        pass_filenames: false
EOF

# Install hooks
pre-commit install

# Run manually on all files
pre-commit run --all-files

# Update hooks
pre-commit autoupdate
```

---

## 4. Security

### Never Commit Secrets (API Keys, Passwords)

**Common secrets to avoid:**

```
ğŸš« NEVER COMMIT:
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

â€¢ API keys and tokens
â€¢ Passwords and credentials
â€¢ Private keys (.pem, .key files)
â€¢ SSH keys
â€¢ OAuth tokens
â€¢ Database connection strings with passwords
â€¢ Encryption keys
â€¢ SSL certificates
â€¢ AWS credentials
â€¢ Service account credentials
â€¢ .env files with secrets
```

**How secrets accidentally get committed:**

```bash
# âŒ Hardcoded in code
public class PaymentService {
    private static final String API_KEY = "sk_live_abc123xyz"; // DON'T!
}

# âŒ In configuration files
# application.yml
spring:
  datasource:
    password: SuperSecret123  # DON'T!

# âŒ In .env committed to Git
# .env (should be in .gitignore!)
API_KEY=abc123xyz
DATABASE_PASSWORD=secret

# âŒ In comments
// TODO: Change API key: sk_live_abc123xyz
```

**Proper secret management:**

```bash
# âœ… Use environment variables
# application.yml
spring:
  datasource:
    password: ${DB_PASSWORD}

# âœ… Use external configuration
# application.yml
spring:
  config:
    import: file:./secrets.yml  # Add secrets.yml to .gitignore

# âœ… Use secret management services
# AWS Secrets Manager
# HashiCorp Vault
# Azure Key Vault
# Google Secret Manager
```

---

### .env Files in .gitignore

**Setting up .env files properly:**

```bash
# 1. Create .env.example (template, safe to commit)
cat > .env.example << 'EOF'
# Database Configuration
DB_HOST=localhost
DB_PORT=5432
DB_NAME=myapp
DB_USERNAME=user
DB_PASSWORD=

# API Keys
API_KEY=
API_SECRET=

# OAuth
OAUTH_CLIENT_ID=
OAUTH_CLIENT_SECRET=

# Email
SMTP_HOST=
SMTP_PORT=
SMTP_USERNAME=
SMTP_PASSWORD=
EOF

# 2. Add .env to .gitignore
cat >> .gitignore << 'EOF'
# Environment variables
.env
.env.local
.env.*.local
.env.production
EOF

# 3. Create actual .env (not committed)
cp .env.example .env
# Fill in real values

# 4. Load environment variables in application
# Use Spring Boot's @PropertySource or dotenv library
```

**Java example with .env:**

```java
// Using dotenv-java library
import io.github.cdimascio.dotenv.Dotenv;

@SpringBootApplication
public class Application {
    public static void main(String[] args) {
        // Load .env file
        Dotenv dotenv = Dotenv.configure()
            .ignoreIfMissing()
            .load();
        
        // Set system properties
        dotenv.entries().forEach(entry -> 
            System.setProperty(entry.getKey(), entry.getValue())
        );
        
        SpringApplication.run(Application.class, args);
    }
}
```

```xml
<!-- pom.xml -->
<dependency>
    <groupId>io.github.cdimascio</groupId>
    <artifactId>dotenv-java</artifactId>
    <version>3.0.0</version>
</dependency>
```

---

### Scanning for Leaked Secrets (git-secrets, truffleHog)

#### git-secrets

```bash
# Install git-secrets
brew install git-secrets  # macOS
# or
git clone https://github.com/awslabs/git-secrets.git
cd git-secrets
make install

# Initialize in repository
cd your-repo
git secrets --install

# Add AWS patterns
git secrets --register-aws

# Add custom patterns
git secrets --add 'password\s*=\s*.+'
git secrets --add 'api[_-]?key\s*=\s*.+'
git secrets --add 'secret\s*=\s*.+'

# Add allowed patterns (false positives)
git secrets --add --allowed 'example\.com'

# Scan repository
git secrets --scan

# Scan specific file
git secrets --scan path/to/file.java

# Scan commit history
git secrets --scan-history

# List patterns
git secrets --list
```

#### TruffleHog

```bash
# Install TruffleHog
pip install truffleHog

# Scan repository
trufflehog filesystem /path/to/repo

# Scan Git history
trufflehog git https://github.com/user/repo

# Scan specific branch
trufflehog git file:///path/to/repo --branch main

# Output to JSON
trufflehog git file:///path/to/repo --json > secrets.json

# Scan with regex
trufflehog git file:///path/to/repo \
    --regex \
    --rules custom-rules.json

# Example custom-rules.json
cat > custom-rules.json << 'EOF'
{
  "AWS Access Key": "AKIA[0-9A-Z]{16}",
  "Slack Token": "xox[baprs]-[0-9a-zA-Z-]+",
  "Google API Key": "AIza[0-9A-Za-z\\-_]{35}",
  "GitHub Token": "ghp_[0-9a-zA-Z]{36}",
  "Private Key": "-----BEGIN (RSA|DSA|EC|OPENSSH) PRIVATE KEY-----"
}
EOF

trufflehog git file:///path/to/repo --rules custom-rules.json
```

#### GitLeaks

```bash
# Install GitLeaks
brew install gitleaks  # macOS

# Scan repository
gitleaks detect --source /path/to/repo

# Scan with verbose output
gitleaks detect --source /path/to/repo --verbose

# Generate report
gitleaks detect --source /path/to/repo --report-format json --report-path report.json

# Custom configuration
cat > .gitleaks.toml << 'EOF'
title = "Gitleaks Config"

[[rules]]
description = "AWS Access Key"
regex = '''AKIA[0-9A-Z]{16}'''

[[rules]]
description = "Database Password"
regex = '''password\s*=\s*["'][^"']{8,}["']'''

[allowlist]
paths = [
    '''.*\.example$''',
    '''.*\.template$'''
]
EOF

gitleaks detect --source /path/to/repo --config .gitleaks.toml
```

**Pre-commit hook with secret scanning:**

```bash
# .git/hooks/pre-commit
#!/bin/bash

echo "ğŸ”’ Scanning for secrets..."

# Run gitleaks
if command -v gitleaks &> /dev/null; then
    gitleaks protect --staged --verbose
    if [ $? -ne 0 ]; then
        echo "âŒ Secrets detected in staged files!"
        echo "Please remove secrets before committing"
        exit 1
    fi
fi

# Run git-secrets
if command -v git-secrets &> /dev/null; then
    git secrets --scan
    if [ $? -ne 0 ]; then
        echo "âŒ Secrets detected!"
        exit 1
    fi
fi

echo "âœ… No secrets detected"
exit 0
```

---

### Removing Secrets from History (BFG Repo-Cleaner, git filter-branch)

#### BFG Repo-Cleaner (Recommended)

```bash
# Download BFG
wget https://repo1.maven.org/maven2/com/madgag/bfg/1.14.0/bfg-1.14.0.jar
alias bfg='java -jar bfg-1.14.0.jar'

# Create backup
git clone --mirror https://github.com/user/repo.git repo-backup.git

# Remove file with secrets
bfg --delete-files secret.txt repo.git

# Remove folder
bfg --delete-folders .env repo.git

# Replace text (passwords, keys)
# Create replacements.txt
cat > replacements.txt << 'EOF'
PASSWORD1==>***REMOVED***
sk_live_abc123==>***REMOVED***
super_secret_key==>***REMOVED***
EOF

bfg --replace-text replacements.txt repo.git

# Clean up
cd repo.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# Force push (âš ï¸ DANGEROUS - coordinate with team!)
git push --force
```

#### git filter-branch (Alternative)

```bash
# âš ï¸ WARNING: Rewrites entire Git history!

# Remove specific file
git filter-branch --force --index-filter \
    'git rm --cached --ignore-unmatch path/to/secret.txt' \
    --prune-empty --tag-name-filter cat -- --all

# Remove files matching pattern
git filter-branch --force --index-filter \
    'git rm --cached --ignore-unmatch -r "*.env"' \
    --prune-empty --tag-name-filter cat -- --all

# Replace text in all files
git filter-branch --force --tree-filter \
    'find . -type f -exec sed -i "s/secret_password/***REMOVED***/g" {} \;' \
    --prune-empty --tag-name-filter cat -- --all

# Clean up
rm -rf .git/refs/original/
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# Force push
git push origin --force --all
git push origin --force --tags
```

**Complete secret removal workflow:**

```bash
# 1. Identify leaked secret
git log -p | grep -i "password"

# 2. Create backup
git clone --mirror https://github.com/user/repo.git repo-backup.git

# 3. Notify team
# Send message: "Emergency: Removing leaked secrets from Git history.
#                 Do NOT push for next 30 minutes."

# 4. Rotate the leaked secret
# Change password, regenerate API key, etc.

# 5. Remove from history with BFG
bfg --replace-text replacements.txt repo.git

# 6. Clean up
cd repo.git
git reflog expire --expire=now --all
git gc --prune=now --aggressive

# 7. Force push
git push --force --all
git push --force --tags

# 8. Team members must re-clone
# Each team member:
cd ~/projects
rm -rf old-repo
git clone https://github.com/user/repo.git

# 9. Verify secret is removed
git log -p | grep -i "old_password"
# Should return nothing

# 10. Document incident
# Update security log
# Review commit access policies
```

---

## Summary

### Commit Guidelines

- âœ… **Atomic commits**: One logical change per commit
- âœ… **Conventional Commits**: Standardized format for consistency
- âœ… **Clear messages**: Explain WHAT and WHY, max 50 char subject
- âœ… **Message structure**: Subject, body, footer with references

### .gitignore

- âœ… **Build artifacts**: target/, build/, *.class
- âœ… **IDE files**: .idea/, .vscode/, *.iml
- âœ… **Secrets**: .env, credentials, *.key
- âœ… **Patterns**: Wildcards, negation, global gitignore
- âœ… **Cleanup**: git rm --cached for already-tracked files

### Git Hooks

- âœ… **pre-commit**: Linting, formatting, tests
- âœ… **commit-msg**: Enforce message format
- âœ… **pre-push**: Run full test suite
- âœ… **Server-side**: Protect branches, trigger deployments
- âœ… **Tools**: Husky, pre-commit framework

### Security

- âœ… **Never commit secrets**: Use environment variables
- âœ… **Secret management**: .env files, secret services
- âœ… **Scanning**: git-secrets, TruffleHog, GitLeaks
- âœ… **Removal**: BFG Repo-Cleaner for history cleanup
- âœ… **Prevention**: Pre-commit hooks, secret scanning

**Golden Rules:**

1. Write commits like you're explaining to your future self
2. Keep secrets out of Git entirely
3. Use hooks to enforce standards automatically
4. When in doubt, check .gitignore
5. If you leak a secret, rotate it immediately
