## Overview

Gradle's dependency management system is powerful and flexible, offering fine-grained control over how dependencies are resolved, cached, and included in your project. Understanding configurations, resolution strategies, and version control is essential for maintaining healthy builds.

```
┌─────────────────────────────────────────────────────────────────┐
│              GRADLE DEPENDENCY MANAGEMENT                       │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  1. DECLARE DEPENDENCIES                                        │
│     ├── Configurations (implementation, api, etc.)             │
│     ├── Notation (string, map, platform)                       │
│     └── Repositories (where to find them)                      │
│                                                                 │
│  2. RESOLVE DEPENDENCIES                                        │
│     ├── Download from repositories                             │
│     ├── Resolve version conflicts                              │
│     ├── Build dependency graph                                 │
│     └── Apply resolution strategy                              │
│                                                                 │
│  3. CACHE DEPENDENCIES                                          │
│     ├── Local cache (~/.gradle/caches)                         │
│     ├── Metadata caching                                       │
│     └── Artifact caching                                       │
│                                                                 │
│  4. USE DEPENDENCIES                                            │
│     ├── Compile classpath                                      │
│     ├── Runtime classpath                                      │
│     └── Test classpath                                         │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. Dependency Configurations

### Configuration Overview

```
┌────────────────────────────────────────────────────────────────┐
│           GRADLE DEPENDENCY CONFIGURATIONS                     │
├────────────────────────────────────────────────────────────────┤
│                                                                │
│  implementation                                                │
│  ├── Compile: YES                                              │
│  ├── Runtime: YES                                              │
│  ├── Exposed to consumers: NO                                  │
│  └── Use: Default choice (encapsulation)                       │
│                                                                │
│  api (requires java-library plugin)                            │
│  ├── Compile: YES                                              │
│  ├── Runtime: YES                                              │
│  ├── Exposed to consumers: YES                                 │
│  └── Use: When part of public API                             │
│                                                                │
│  compileOnly                                                   │
│  ├── Compile: YES                                              │
│  ├── Runtime: NO                                               │
│  ├── Use: Annotations, provided dependencies                   │
│  └── Examples: Lombok, Servlet API                            │
│                                                                │
│  runtimeOnly                                                   │
│  ├── Compile: NO                                               │
│  ├── Runtime: YES                                              │
│  ├── Use: JDBC drivers, logging implementations               │
│  └── Examples: PostgreSQL driver, Logback                     │
│                                                                │
│  testImplementation                                            │
│  ├── Test Compile: YES                                         │
│  ├── Test Runtime: YES                                         │
│  ├── Production: NO                                            │
│  └── Use: Test frameworks, mocking libraries                  │
│                                                                │
│  testRuntimeOnly                                               │
│  ├── Test Compile: NO                                          │
│  ├── Test Runtime: YES                                         │
│  └── Use: Test-specific runtime dependencies                  │
│                                                                │
└────────────────────────────────────────────────────────────────┘
```

---

### 1.1 implementation

**Most common configuration - Use by default**

```groovy
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web:3.2.0'
    implementation 'com.google.guava:guava:32.1.3-jre'
    implementation 'org.apache.commons:commons-lang3:3.13.0'
}
```

**Characteristics:**

```
✓ Available at compile time
✓ Available at runtime
✗ NOT exposed to consumers (implementation detail)
✓ Faster builds (changes don't recompile consumers)
✓ Better encapsulation
```

**Example Scenario:**

```groovy
// library-a/build.gradle
dependencies {
    implementation 'com.google.guava:guava:32.1.3-jre'
}

// Consumer cannot use Guava classes
// library-b/build.gradle
dependencies {
    implementation project(':library-a')
    // Cannot use Guava classes here!
    // Would need to declare Guava explicitly
}
```

---

### 1.2 api

**Exposes dependency to consumers - Use sparingly**

```groovy
plugins {
    id 'java-library'  // Required for 'api' configuration
}

dependencies {
    // Public API dependencies (exposed to consumers)
    api 'org.slf4j:slf4j-api:2.0.9'
    
    // Implementation details (not exposed)
    implementation 'ch.qos.logback:logback-classic:1.4.11'
}
```

**When to Use api:**

```
✓ Return types in public API
✓ Method parameters in public API
✓ Public class inheritance
✓ Public interfaces

Examples:
  // Public method returns SLF4J Logger
  public Logger getLogger() {
      return logger;
  }
  
  // Consumer needs SLF4J on compile classpath
  api 'org.slf4j:slf4j-api:2.0.9'
```

**Example:**

```groovy
// library/build.gradle
plugins {
    id 'java-library'
}

dependencies {
    // SLF4J is part of public API
    api 'org.slf4j:slf4j-api:2.0.9'
    
    // Guava is internal implementation
    implementation 'com.google.guava:guava:32.1.3-jre'
}

// Consumer can use SLF4J
// app/build.gradle
dependencies {
    implementation project(':library')
    // Can use SLF4J classes (from api)
    // Cannot use Guava classes (from implementation)
}
```

**api vs implementation:**

```
┌──────────────────────────────────────────────────────────┐
│         implementation (preferred)                       │
│  ✓ Faster builds                                         │
│  ✓ Better encapsulation                                  │
│  ✓ Fewer recompilations                                  │
│  ✗ Not available to consumers                            │
│                                                          │
│         api (use when necessary)                         │
│  ✓ Available to consumers                                │
│  ✓ Part of public contract                               │
│  ✗ Slower builds                                         │
│  ✗ Changes trigger consumer recompilation                │
└──────────────────────────────────────────────────────────┘
```

---

### 1.3 compileOnly

**Compile-time only, not in runtime classpath**

```groovy
dependencies {
    // Lombok - annotation processor
    compileOnly 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    
    // Servlet API - provided by container
    compileOnly 'javax.servlet:javax.servlet-api:4.0.1'
    
    // JSR-305 annotations - compile-time only
    compileOnly 'com.google.code.findbugs:jsr305:3.0.2'
}
```

**Common Use Cases:**

```
1. Annotation Processors
   - Lombok
   - MapStruct
   - AutoValue
   
2. Provided Dependencies
   - Servlet API (provided by Tomcat/Jetty)
   - JEE APIs (provided by app server)
   
3. Compile-time Annotations
   - JSR-305 (@Nullable, @Nonnull)
   - Checker Framework
   - Error Prone annotations
```

**Example:**

```groovy
dependencies {
    // Lombok for getters/setters
    compileOnly 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    
    // MapStruct for mapping
    compileOnly 'org.mapstruct:mapstruct:1.5.5.Final'
    annotationProcessor 'org.mapstruct:mapstruct-processor:1.5.5.Final'
}

// Java code
import lombok.Data;

@Data
public class User {
    private String name;
    private String email;
    // Lombok generates getters/setters at compile time
    // Lombok JAR not needed at runtime
}
```

---

### 1.4 runtimeOnly

**Runtime-only, not on compile classpath**

```groovy
dependencies {
    // JDBC drivers - needed at runtime
    runtimeOnly 'org.postgresql:postgresql:42.6.0'
    runtimeOnly 'com.mysql:mysql-connector-j:8.1.0'
    runtimeOnly 'com.h2database:h2:2.2.224'
    
    // Logging implementation
    runtimeOnly 'ch.qos.logback:logback-classic:1.4.11'
    runtimeOnly 'org.apache.logging.log4j:log4j-core:2.21.1'
}
```

**Common Use Cases:**

```
1. Database Drivers
   - PostgreSQL
   - MySQL
   - Oracle
   - H2 (for testing)
   
2. Logging Implementations
   - Logback (SLF4J implementation)
   - Log4j2 (SLF4J implementation)
   
3. Runtime Dependencies
   - JAXB (runtime only in Java 11+)
   - Jackson modules for specific types
```

**Example:**

```groovy
dependencies {
    // Compile against interface
    implementation 'org.slf4j:slf4j-api:2.0.9'
    
    // Runtime implementation
    runtimeOnly 'ch.qos.logback:logback-classic:1.4.11'
}

// Java code - compile time
import org.slf4j.Logger;
import org.slf4j.LoggerFactory;
// ✓ Can import SLF4J (from implementation)
// ✗ Cannot import Logback classes (runtimeOnly)

public class MyService {
    private static final Logger log = LoggerFactory.getLogger(MyService.class);
    // Logback provides implementation at runtime
}
```

---

### 1.5 Test Configurations

**testImplementation:**

```groovy
dependencies {
    // Test frameworks
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    testImplementation 'org.assertj:assertj-core:3.24.2'
    testImplementation 'org.mockito:mockito-core:5.5.0'
    
    // Spring Boot testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    
    // Testcontainers
    testImplementation 'org.testcontainers:testcontainers:1.19.1'
    testImplementation 'org.testcontainers:postgresql:1.19.1'
}
```

**testRuntimeOnly:**

```groovy
dependencies {
    // JUnit Platform Launcher
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    
    // Test database
    testRuntimeOnly 'com.h2database:h2:2.2.224'
}
```

**testCompileOnly:**

```groovy
dependencies {
    // Lombok for test classes
    testCompileOnly 'org.projectlombok:lombok:1.18.30'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.30'
}
```

---

### Complete Configuration Example

```groovy
plugins {
    id 'java-library'
    id 'org.springframework.boot' version '3.2.0'
}

dependencies {
    // ===== API - Public interface =====
    api 'org.slf4j:slf4j-api:2.0.9'
    
    // ===== IMPLEMENTATION - Internal dependencies =====
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'com.google.guava:guava:32.1.3-jre'
    implementation 'org.apache.commons:commons-lang3:3.13.0'
    
    // ===== COMPILE ONLY - Annotations, provided =====
    compileOnly 'org.projectlombok:lombok:1.18.30'
    compileOnly 'javax.servlet:javax.servlet-api:4.0.1'
    
    // ===== ANNOTATION PROCESSORS =====
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
    
    // ===== RUNTIME ONLY - Drivers, implementations =====
    runtimeOnly 'org.postgresql:postgresql:42.6.0'
    runtimeOnly 'ch.qos.logback:logback-classic:1.4.11'
    
    // ===== TEST IMPLEMENTATION =====
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    testImplementation 'org.mockito:mockito-core:5.5.0'
    testImplementation 'org.assertj:assertj-core:3.24.2'
    
    // ===== TEST RUNTIME ONLY =====
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    testRuntimeOnly 'com.h2database:h2:2.2.224'
    
    // ===== TEST COMPILE ONLY =====
    testCompileOnly 'org.projectlombok:lombok:1.18.30'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.30'
}
```

---

## 2. Dependency Notation

### 2.1 String Notation (Compact)

```groovy
dependencies {
    // Standard format: 'group:artifact:version'
    implementation 'org.springframework.boot:spring-boot-starter-web:3.2.0'
    implementation 'com.google.guava:guava:32.1.3-jre'
    
    // With classifier
    implementation 'net.java.dev.jna:jna:5.13.0:jpms'
    
    // With extension
    implementation 'org.example:my-lib:1.0.0@jar'
    
    // Without version (from platform/BOM)
    implementation 'org.springframework.boot:spring-boot-starter-web'
}
```

---

### 2.2 Map Notation (Explicit)

```groovy
dependencies {
    // Map notation - more verbose but clearer
    implementation group: 'org.springframework.boot',
                  name: 'spring-boot-starter-web',
                  version: '3.2.0'
    
    // With classifier
    implementation group: 'net.java.dev.jna',
                  name: 'jna',
                  version: '5.13.0',
                  classifier: 'jpms'
    
    // With extension
    implementation group: 'org.example',
                  name: 'my-lib',
                  version: '1.0.0',
                  ext: 'jar'
    
    // Exclude transitive dependencies
    implementation(group: 'org.springframework.boot',
                   name: 'spring-boot-starter-web',
                   version: '3.2.0') {
        transitive = false
    }
}
```

---

### 2.3 Platform (BOM) - Bill of Materials

```groovy
dependencies {
    // Import BOM (manages versions)
    implementation platform('org.springframework.boot:spring-boot-dependencies:3.2.0')
    implementation platform('com.fasterxml.jackson:jackson-bom:2.15.3')
    implementation platform('org.testcontainers:testcontainers-bom:1.19.1')
    
    // Use dependencies without versions
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'com.fasterxml.jackson.core:jackson-databind'
    
    testImplementation 'org.testcontainers:postgresql'
    testImplementation 'org.testcontainers:junit-jupiter'
}
```

**enforced platform:**

```groovy
dependencies {
    // Enforce platform versions (override other version declarations)
    implementation enforcedPlatform('org.springframework.boot:spring-boot-dependencies:3.2.0')
    
    // This will use version from platform (3.2.0)
    // even if specified differently elsewhere
    implementation 'org.springframework.boot:spring-boot-starter-web'
}
```

**Platform vs Regular Dependency:**

```groovy
// Regular dependency (brings in code)
implementation 'org.springframework.boot:spring-boot-dependencies:3.2.0'
// ✗ Wrong - brings in all Spring Boot as dependencies

// Platform (only manages versions)
implementation platform('org.springframework.boot:spring-boot-dependencies:3.2.0')
// ✓ Correct - only manages versions, no code
```

---

### 2.4 Project Dependencies

```groovy
dependencies {
    // Project dependency
    implementation project(':shared-library')
    implementation project(':common-utils')
    
    // Project with specific configuration
    implementation project(path: ':shared-library', configuration: 'runtimeElements')
}
```

---

### 2.5 File Dependencies

```groovy
dependencies {
    // Single file
    implementation files('libs/custom-library.jar')
    
    // Multiple files
    implementation files('libs/lib1.jar', 'libs/lib2.jar')
    
    // File tree
    implementation fileTree(dir: 'libs', include: ['*.jar'])
    implementation fileTree(dir: 'libs', include: ['*.jar'], exclude: ['*-sources.jar'])
}
```

---

## 3. Dependency Constraints

### 3.1 Version Constraints

```groovy
dependencies {
    // Prefer specific version
    implementation('com.google.guava:guava') {
        version {
            prefer '32.1.3-jre'
        }
    }
    
    // Require minimum version
    implementation('com.google.guava:guava') {
        version {
            require '30.0-jre'
        }
    }
    
    // Strict version range
    implementation('com.google.guava:guava') {
        version {
            strictly '[30.0-jre, 33.0-jre['  // 30.0 <= version < 33.0
        }
    }
    
    // Combination
    implementation('com.google.guava:guava') {
        version {
            strictly '[30.0-jre, 33.0-jre['
            prefer '32.1.3-jre'
        }
    }
}
```

**Version Range Syntax:**

```
]1.0, 2.0[    → 1.0 < version < 2.0 (exclusive)
[1.0, 2.0]    → 1.0 ≤ version ≤ 2.0 (inclusive)
[1.0, 2.0[    → 1.0 ≤ version < 2.0
]1.0, 2.0]    → 1.0 < version ≤ 2.0
[1.0, )       → version ≥ 1.0
( , 2.0]      → version ≤ 2.0
```

---

### 3.2 Rejecting Versions

```groovy
dependencies {
    // Reject specific version
    implementation('com.google.guava:guava:32.1.3-jre') {
        version {
            reject '31.0-jre', '31.1-jre'  // Known bugs
        }
    }
    
    // Reject version range
    implementation('org.springframework:spring-core') {
        version {
            rejectAll()  // Reject everything, must be explicit
        }
    }
}

// Or using constraints
configurations.all {
    resolutionStrategy {
        componentSelection {
            all { ComponentSelection selection ->
                if (selection.candidate.version.contains('alpha') ||
                    selection.candidate.version.contains('beta')) {
                    selection.reject('Alpha/Beta versions not allowed')
                }
            }
        }
    }
}
```

---

### 3.3 Dependency Constraints Block

```groovy
dependencies {
    constraints {
        // Constrain version for all configurations
        implementation('com.google.guava:guava:32.1.3-jre')
        
        // Constrain with version range
        implementation('org.slf4j:slf4j-api') {
            version {
                strictly '[2.0, 3.0['
                prefer '2.0.9'
            }
        }
    }
    
    // Actual dependencies (versions from constraints)
    implementation 'com.google.guava:guava'
    implementation 'org.slf4j:slf4j-api'
}
```

---

## 4. Dependency Resolution

### 4.1 Resolution Strategy

```groovy
configurations.all {
    resolutionStrategy {
        // Fail on version conflict
        failOnVersionConflict()
        
        // Prefer project modules over external
        preferProjectModules()
        
        // Cache dynamic versions for 10 minutes
        cacheDynamicVersionsFor 10, 'minutes'
        
        // Cache changing modules for 0 seconds (always check)
        cacheChangingModulesFor 0, 'seconds'
    }
}
```

---

### 4.2 Force Versions

```groovy
configurations.all {
    resolutionStrategy {
        // Force specific version
        force 'org.slf4j:slf4j-api:2.0.9'
        force 'com.google.guava:guava:32.1.3-jre'
    }
}

// Or per dependency
dependencies {
    implementation('com.example:library:1.0') {
        force = true
    }
}
```

---

### 4.3 Exclude Transitive Dependencies

**Exclude Globally:**

```groovy
configurations.all {
    exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    exclude module: 'commons-logging'
}
```

**Exclude Per Dependency:**

```groovy
dependencies {
    // Exclude specific module
    implementation('org.springframework.boot:spring-boot-starter-web') {
        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    }
    
    // Exclude entire group
    implementation('com.example:library:1.0') {
        exclude group: 'commons-logging'
    }
    
    // Multiple exclusions
    implementation('com.example:library:1.0') {
        exclude group: 'org.slf4j', module: 'slf4j-log4j12'
        exclude group: 'log4j'
    }
    
    // Disable transitive dependencies completely
    implementation('com.example:library:1.0') {
        transitive = false
    }
}
```

**Example - Replace Tomcat with Jetty:**

```groovy
dependencies {
    implementation('org.springframework.boot:spring-boot-starter-web') {
        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    }
    implementation 'org.springframework.boot:spring-boot-starter-jetty'
}
```

---

### 4.4 Dependency Substitution

```groovy
configurations.all {
    resolutionStrategy.dependencySubstitution {
        // Replace module with another
        substitute module('org.slf4j:slf4j-log4j12') using module('org.slf4j:slf4j-simple:2.0.9')
        
        // Use project instead of external module
        substitute module('com.example:published-library') using project(':local-library')
        
        // Substitute with specific version
        substitute module('commons-logging:commons-logging') with module('org.slf4j:jcl-over-slf4j:2.0.9')
    }
}
```

**Replace with Platform:**

```groovy
configurations.all {
    resolutionStrategy.dependencySubstitution {
        // Use platform for version management
        all { DependencySubstitution dependency ->
            if (dependency.requested.module == 'spring-core') {
                dependency.useTarget(
                    dependency.requested.group + ':' + 
                    dependency.requested.module + ':' + 
                    '6.0.13'
                )
            }
        }
    }
}
```

---

### 4.5 Component Metadata Rules

```groovy
dependencies {
    components {
        // Mark as platform
        all { ComponentMetadataDetails details ->
            if (details.id.group == 'com.example' && 
                details.id.name == 'platform') {
                details.platform()
            }
        }
        
        // Add constraint
        withModule('com.google.guava:guava') { ComponentMetadataDetails details ->
            details.allVariants {
                withDependencies {
                    add('com.google.code.findbugs:jsr305:3.0.2')
                }
            }
        }
    }
}
```

---

## 5. Dependency Locking

### 5.1 Why Lock Dependencies?

```
Benefits:
  ✓ Reproducible builds
  ✓ Prevent unexpected updates
  ✓ Security (review changes)
  ✓ Stability in production
  
Without locking:
  implementation 'com.example:library:1.+'
  → Different versions on different machines
  → "Works on my machine" syndrome
  
With locking:
  → Exact versions locked in file
  → Same build everywhere
```

---

### 5.2 Enable Dependency Locking

```groovy
// build.gradle
dependencyLocking {
    // Lock all configurations
    lockAllConfigurations()
    
    // Or lock specific configurations
    // lockMode = LockMode.STRICT
}

// Generate lock files
// ./gradlew dependencies --write-locks
```

---

### 5.3 Lock File Generation

```bash
# Generate lock files for all configurations
./gradlew dependencies --write-locks

# Update specific configuration
./gradlew dependencies --write-locks --configuration compileClasspath

# Update specific dependency
./gradlew dependencies --update-locks org.springframework.boot:spring-boot-starter-web
```

**Generated Lock File (gradle.lockfile):**

```
# This is a Gradle generated file for dependency locking.
# Manual edits can break the build. This file is expected to be part of source control.
com.google.guava:guava:32.1.3-jre=compileClasspath,runtimeClasspath
org.slf4j:slf4j-api:2.0.9=compileClasspath,runtimeClasspath
org.springframework.boot:spring-boot-starter-web:3.2.0=compileClasspath,runtimeClasspath
# ... more dependencies
```

---

### 5.4 Lock Mode Strategies

```groovy
dependencyLocking {
    // STRICT: Fail if lock file missing
    lockMode = LockMode.STRICT
    
    // LENIENT: Warn if lock file missing (default)
    lockMode = LockMode.LENIENT
    
    // Lock only specific configurations
    lockAllConfigurations()
    
    // Ignore specific dependencies
    ignoredDependencies.add('com.example:changing-lib')
}
```

---

### 5.5 Using Lock Files

```bash
# Build with locked versions
./gradlew build

# Update single dependency
./gradlew dependencies --update-locks org.springframework.boot:spring-boot-starter-web

# Refresh all locks
./gradlew dependencies --write-locks

# Verify locks are up-to-date
./gradlew buildEnvironment --write-verification-metadata sha256
```

---

### 5.6 Lock File Location

```
Project Structure:
  my-project/
  ├── gradle/
  │   └── dependency-locks/
  │       ├── compileClasspath.lockfile
  │       ├── runtimeClasspath.lockfile
  │       └── testRuntimeClasspath.lockfile
  │
  └── build.gradle

Or unified:
  my-project/
  ├── gradle.lockfile  (all configurations)
  └── build.gradle
```

**Version Control:**

```bash
# Commit lock files
git add gradle/dependency-locks/
git add gradle.lockfile
git commit -m "Lock dependencies"
```

---

## 6. Advanced Dependency Management

### 6.1 Version Catalogs

**gradle/libs.versions.toml:**

```toml
[versions]
spring-boot = "3.2.0"
guava = "32.1.3-jre"
junit = "5.10.0"

[libraries]
spring-boot-web = { group = "org.springframework.boot", name = "spring-boot-starter-web", version.ref = "spring-boot" }
spring-boot-test = { group = "org.springframework.boot", name = "spring-boot-starter-test", version.ref = "spring-boot" }
guava = { group = "com.google.guava", name = "guava", version.ref = "guava" }
junit-jupiter = { group = "org.junit.jupiter", name = "junit-jupiter", version.ref = "junit" }

[bundles]
spring-boot = ["spring-boot-web", "spring-boot-test"]

[plugins]
spring-boot = { id = "org.springframework.boot", version.ref = "spring-boot" }
```

**settings.gradle:**

```groovy
dependencyResolutionManagement {
    versionCatalogs {
        libs {
            from(files('gradle/libs.versions.toml'))
        }
    }
}
```

**build.gradle:**

```groovy
dependencies {
    implementation libs.spring.boot.web
    implementation libs.guava
    
    testImplementation libs.bundles.spring.boot
    testImplementation libs.junit.jupiter
}

plugins {
    alias(libs.plugins.spring.boot)
}
```

---

### 6.2 Dependency Insight

```bash
# Why is this dependency included?
./gradlew dependencyInsight --dependency guava

# Output shows:
# - Which configuration includes it
# - What requested it (direct or transitive)
# - Version conflicts and resolution

# Configuration-specific insight
./gradlew dependencyInsight --dependency slf4j-api --configuration compileClasspath
```

---

### 6.3 Build Scan

```bash
# Generate detailed dependency report
./gradlew build --scan

# Includes:
# - Dependency tree
# - Resolution time
# - Download time
# - Cache hits/misses
# - Version conflicts
```

---

## 7. Common Patterns

### 7.1 Spring Boot Dependencies

```groovy
plugins {
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
}

dependencies {
    // Spring Boot starters (versions managed by plugin)
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-security'
    
    // Exclude Tomcat, use Jetty
    implementation('org.springframework.boot:spring-boot-starter-web') {
        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    }
    implementation 'org.springframework.boot:spring-boot-starter-jetty'
    
    // Database
    runtimeOnly 'org.postgresql:postgresql'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}
```

---

### 7.2 Multi-Module Project

```groovy
// Parent build.gradle
subprojects {
    apply plugin: 'java'
    
    repositories {
        mavenCentral()
    }
    
    dependencies {
        // Common dependencies for all modules
        implementation platform('org.springframework.boot:spring-boot-dependencies:3.2.0')
        testImplementation 'org.junit.jupiter:junit-jupiter'
    }
}

// Module A
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
}

// Module B
dependencies {
    implementation project(':module-a')
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
}
```

---

### 7.3 Lombok + MapStruct

```groovy
dependencies {
    // Versions
    def lombokVersion = '1.18.30'
    def mapstructVersion = '1.5.5.Final'
    
    // Compile-time annotation processors
    compileOnly "org.projectlombok:lombok:${lombokVersion}"
    compileOnly "org.mapstruct:mapstruct:${mapstructVersion}"
    
    annotationProcessor "org.projectlombok:lombok:${lombokVersion}"
    annotationProcessor "org.mapstruct:mapstruct-processor:${mapstructVersion}"
    
    // Important: Lombok must be processed before MapStruct
    annotationProcessor "org.projectlombok:lombok-mapstruct-binding:0.2.0"
}
```

---

## Summary

### Configuration Decision Tree

```
Choose configuration:

Is it part of public API?
├─ YES → api (requires java-library plugin)
└─ NO  → Is it needed at runtime?
         ├─ YES → Is it needed at compile time?
         │        ├─ YES → implementation
         │        └─ NO  → runtimeOnly
         └─ NO  → compileOnly

For tests:
├─ Test compile + runtime → testImplementation
├─ Test runtime only → testRuntimeOnly
└─ Test compile only → testCompileOnly
```

### Essential Commands

```bash
# View dependencies
./gradlew dependencies
./gradlew dependencies --configuration compileClasspath

# Dependency insight
./gradlew dependencyInsight --dependency guava

# Generate lock files
./gradlew dependencies --write-locks

# Update locks
./gradlew dependencies --update-locks org.springframework.boot:spring-boot

# Build scan
./gradlew build --scan
```

### Best Practices

```
✓ Use implementation by default
✓ Use api only for public API dependencies
✓ Use platform() for BOMs
✓ Lock dependencies in production
✓ Exclude unused transitive dependencies
✓ Use version catalogs for centralized management
✓ Keep dependencies up-to-date
✓ Use dependency constraints for version management
```
