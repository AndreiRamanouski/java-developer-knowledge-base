## Overview

The Spring Boot Gradle plugin provides seamless integration between Spring Boot and Gradle, offering automatic dependency management, executable JAR creation, Docker image building, and development conveniences.

```
┌─────────────────────────────────────────────────────────────────┐
│           SPRING BOOT GRADLE PLUGIN FEATURES                    │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  Dependency Management                                          │
│  ├── Automatic version management                              │
│  ├── No version numbers needed                                 │
│  ├── Compatible versions guaranteed                            │
│  └── Override when needed                                      │
│                                                                 │
│  Executable JAR (bootJar)                                       │
│  ├── Fat JAR with all dependencies                             │
│  ├── Embedded web server (Tomcat/Jetty/Undertow)              │
│  ├── Main class auto-detection                                 │
│  └── Layered JARs for Docker optimization                      │
│                                                                 │
│  Development Tools                                              │
│  ├── bootRun - Run application directly                        │
│  ├── Hot reload support (DevTools)                             │
│  ├── Build info generation                                     │
│  └── Active profiles configuration                             │
│                                                                 │
│  Docker Integration (bootBuildImage)                            │
│  ├── Cloud Native Buildpacks                                   │
│  ├── No Dockerfile needed                                      │
│  ├── Optimized layering                                        │
│  └── Security scanning integration                             │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. Basic Setup

### 1.1 Minimal Configuration

```groovy
// build.gradle

plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
}

group = 'com.example'
version = '1.0.0-SNAPSHOT'
sourceCompatibility = '17'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

test {
    useJUnitPlatform()
}
```

**What Each Plugin Does:**

```
org.springframework.boot:
  ✓ Provides bootJar, bootRun, bootBuildImage tasks
  ✓ Enables Spring Boot features
  ✓ Configures main class detection

io.spring.dependency-management:
  ✓ Imports Spring Boot BOM
  ✓ Manages dependency versions
  ✓ Ensures compatible versions
```

---

### 1.2 Kotlin DSL Configuration

```kotlin
// build.gradle.kts

import org.jetbrains.kotlin.gradle.tasks.KotlinCompile

plugins {
    java
    id("org.springframework.boot") version "3.2.0"
    id("io.spring.dependency-management") version "1.1.4"
    kotlin("jvm") version "1.9.20"
    kotlin("plugin.spring") version "1.9.20"
}

group = "com.example"
version = "1.0.0-SNAPSHOT"
java.sourceCompatibility = JavaVersion.VERSION_17

repositories {
    mavenCentral()
}

dependencies {
    implementation("org.springframework.boot:spring-boot-starter-web")
    implementation("com.fasterxml.jackson.module:jackson-module-kotlin")
    implementation("org.jetbrains.kotlin:kotlin-reflect")
    
    testImplementation("org.springframework.boot:spring-boot-starter-test")
}

tasks.withType<KotlinCompile> {
    kotlinOptions {
        freeCompilerArgs = listOf("-Xjsr305=strict")
        jvmTarget = "17"
    }
}

tasks.withType<Test> {
    useJUnitPlatform()
}
```

---

## 2. Dependency Management

### 2.1 Automatic Version Management

**No Versions Needed:**

```groovy
dependencies {
    // Spring Boot manages versions
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    implementation 'org.springframework.boot:spring-boot-starter-security'
    
    // Related dependencies also managed
    runtimeOnly 'org.postgresql:postgresql'
    runtimeOnly 'com.h2database:h2'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.springframework.security:spring-security-test'
}
```

**Managed Dependencies Include:**

```
Spring Framework
Spring Boot Starters
Spring Data
Spring Security
Spring Cloud
Jackson
Hibernate
Tomcat/Jetty/Undertow
Database drivers
Logging frameworks
Testing libraries
... and many more
```

---

### 2.2 Overriding Versions

```groovy
// Method 1: ext properties
ext['slf4j.version'] = '2.0.9'
ext['junit-jupiter.version'] = '5.10.1'

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    // Uses SLF4J 2.0.9 instead of Spring Boot's default
}

// Method 2: Explicit version
dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'com.google.guava:guava:32.1.3-jre'  // Explicit version
}

// Method 3: Platform constraints
dependencies {
    implementation platform('com.fasterxml.jackson:jackson-bom:2.15.3')
    implementation 'com.fasterxml.jackson.core:jackson-databind'
    // Uses Jackson 2.15.3 instead of Spring Boot's default
}
```

---

### 2.3 Spring Boot BOM

```groovy
// What Spring Boot plugin does automatically:
dependencyManagement {
    imports {
        mavenBom "org.springframework.boot:spring-boot-dependencies:3.2.0"
    }
}

// You can also import additional BOMs
dependencyManagement {
    imports {
        mavenBom 'org.springframework.cloud:spring-cloud-dependencies:2023.0.0'
        mavenBom 'io.awspring.cloud:spring-cloud-aws-dependencies:3.0.3'
    }
}
```

---

## 3. Spring Boot Tasks

### 3.1 bootJar Task

**Create Executable JAR:**

```groovy
bootJar {
    // Archive naming
    archiveBaseName = 'my-service'
    archiveVersion = '1.0.0'
    archiveClassifier = ''
    // Result: my-service-1.0.0.jar
    
    // Main class (auto-detected by default)
    mainClass = 'com.example.Application'
    
    // Layered JAR for Docker optimization
    layered {
        enabled = true
        
        // Custom layers
        application {
            enabled = true
            includeProjectDependencies()
        }
    }
    
    // Exclude files
    exclude 'application-dev.yml'
    
    // Launch script for Unix (make JAR executable)
    launchScript()
    
    // Exclude DevTools
    excludeDevtools = true
}
```

**Run Executable JAR:**

```bash
# Build
./gradlew bootJar

# Run JAR
java -jar build/libs/my-service-1.0.0.jar

# With profile
java -jar build/libs/my-service-1.0.0.jar --spring.profiles.active=prod

# With properties
java -jar build/libs/my-service-1.0.0.jar \
  --server.port=8081 \
  --spring.datasource.url=jdbc:postgresql://localhost/mydb

# Unix executable (with launchScript)
chmod +x build/libs/my-service-1.0.0.jar
./build/libs/my-service-1.0.0.jar
```

---

### 3.2 bootRun Task

**Run Application Directly:**

```groovy
bootRun {
    // Main class
    mainClass = 'com.example.Application'
    
    // JVM arguments
    jvmArgs = [
        '-Xmx512m',
        '-Xms256m',
        '-XX:+UseG1GC'
    ]
    
    // System properties
    systemProperty 'spring.profiles.active', 'dev'
    systemProperty 'spring.output.ansi.enabled', 'ALWAYS'
    
    // Application arguments
    args = ['--debug', '--trace']
    
    // Environment variables
    environment 'DATABASE_URL', 'jdbc:postgresql://localhost/devdb'
    environment 'LOG_LEVEL', 'DEBUG'
    
    // Source sets
    sourceResources sourceSets.main
    
    // Watch for changes (with DevTools)
    optimizedLaunch = true
}
```

**Common Usage:**

```bash
# Run application
./gradlew bootRun

# With active profile
./gradlew bootRun --args='--spring.profiles.active=dev'

# With system property
./gradlew bootRun -Dspring.profiles.active=dev

# With multiple arguments
./gradlew bootRun --args='--server.port=8081 --debug'

# Continuous build (restart on change)
./gradlew bootRun --continuous
```

---

### 3.3 bootBuildImage Task

**Build Docker Image (Cloud Native Buildpacks):**

```groovy
bootBuildImage {
    // Image name
    imageName = 'docker.io/mycompany/my-service:1.0.0'
    
    // Or with properties
    imageName = "${project.name}:${project.version}"
    
    // Builder
    builder = 'paketobuildpacks/builder:base'
    
    // Environment
    environment = [
        'BP_JVM_VERSION': '17',
        'BPE_DELIM_JAVA_TOOL_OPTIONS': ' ',
        'BPE_APPEND_JAVA_TOOL_OPTIONS': '-XX:MaxMetaspaceSize=128m -XX:ReservedCodeCacheSize=64m'
    ]
    
    // Build cache
    buildCache {
        volume {
            name = "cache-${rootProject.name}.build"
        }
    }
    
    launchCache {
        volume {
            name = "cache-${rootProject.name}.launch"
        }
    }
    
    // Docker configuration
    docker {
        publishRegistry {
            username = System.getenv('DOCKER_USERNAME')
            password = System.getenv('DOCKER_PASSWORD')
            url = 'https://docker.io'
        }
        
        // BuildKit
        builderRegistry {
            username = System.getenv('DOCKER_USERNAME')
            password = System.getenv('DOCKER_PASSWORD')
        }
    }
    
    // Clean cache before building
    cleanCache = false
    
    // Verbosity
    verboseLogging = false
}
```

**Build and Push Image:**

```bash
# Build Docker image
./gradlew bootBuildImage

# Output:
# Successfully built image 'docker.io/mycompany/my-service:1.0.0'

# Run container
docker run -p 8080:8080 docker.io/mycompany/my-service:1.0.0

# Push to registry
docker push docker.io/mycompany/my-service:1.0.0

# Or configure auto-push
./gradlew bootBuildImage --publishImage
```

**Image Layers:**

```
Generated Image Layers:
├── Dependencies layer (changes rarely)
├── Spring Boot loader
├── Snapshot dependencies (changes frequently)
├── Application classes (changes frequently)
└── Layered structure optimizes Docker cache
```

---

### 3.4 bootWar Task

**For WAR Deployments:**

```groovy
plugins {
    id 'war'
    id 'org.springframework.boot' version '3.2.0'
}

bootWar {
    archiveBaseName = 'my-webapp'
    archiveVersion = '1.0.0'
    
    // Main class
    mainClass = 'com.example.Application'
    
    // Provided runtime (Tomcat provided by app server)
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    // Mark as provided
    providedRuntime 'org.springframework.boot:spring-boot-starter-tomcat'
}
```

---

## 4. Spring Boot Configuration

### 4.1 Build Info

**Generate build-info.properties:**

```groovy
springBoot {
    buildInfo()
}

// Generates: META-INF/build-info.properties
// build.name=my-service
// build.artifact=my-service
// build.version=1.0.0
// build.time=2024-01-15T10:30:00Z
// build.group=com.example

// Custom properties
springBoot {
    buildInfo {
        properties {
            additional = [
                'description': 'My Spring Boot Service',
                'java.version': JavaVersion.current(),
                'profile': System.getProperty('spring.profiles.active', 'default')
            ]
        }
    }
}
```

**Access in Application:**

```java
@RestController
public class InfoController {
    @Autowired
    private BuildProperties buildProperties;
    
    @GetMapping("/info")
    public Map<String, String> buildInfo() {
        return Map.of(
            "name", buildProperties.getName(),
            "version", buildProperties.getVersion(),
            "time", buildProperties.getTime().toString()
        );
    }
}
```

---

### 4.2 Main Class Configuration

```groovy
springBoot {
    // Explicit main class
    mainClass = 'com.example.Application'
}

// Or in bootJar/bootRun
bootJar {
    mainClass = 'com.example.Application'
}

bootRun {
    mainClass = 'com.example.Application'
}

// Auto-detection (default)
// Spring Boot finds class with @SpringBootApplication
// or public static void main(String[] args)
```

---

### 4.3 Layered JARs

**Enable Layered JARs:**

```groovy
bootJar {
    layered {
        enabled = true
    }
}
```

**Layer Structure:**

```
my-service.jar
├── BOOT-INF/
│   ├── classes/              (application layer)
│   ├── lib/                  (dependencies layer)
│   │   ├── spring-*.jar     (spring-boot-loader layer)
│   │   └── other-*.jar      (dependencies layer)
│   └── classpath.idx
├── META-INF/
└── org/springframework/boot/loader/
```

**Custom Layers:**

```groovy
bootJar {
    layered {
        enabled = true
        
        includeLayerTools = true  // Include layer tools
        
        application {
            intoLayer('spring-boot-loader') {
                include 'org/springframework/boot/loader/**'
            }
            intoLayer('application')
        }
        
        dependencies {
            intoLayer('snapshot-dependencies') {
                include '*:*:*SNAPSHOT'
            }
            intoLayer('dependencies')
        }
        
        layerOrder = ['dependencies', 'spring-boot-loader', 'snapshot-dependencies', 'application']
    }
}
```

**Extract Layers (for Docker):**

```bash
# Extract layers
java -Djarmode=layertools -jar my-service.jar extract

# Results in:
# dependencies/
# spring-boot-loader/
# snapshot-dependencies/
# application/
```

**Dockerfile with Layers:**

```dockerfile
FROM eclipse-temurin:17-jre as builder
WORKDIR /application
COPY my-service.jar application.jar
RUN java -Djarmode=layertools -jar application.jar extract

FROM eclipse-temurin:17-jre
WORKDIR /application
COPY --from=builder application/dependencies/ ./
COPY --from=builder application/spring-boot-loader/ ./
COPY --from=builder application/snapshot-dependencies/ ./
COPY --from=builder application/application/ ./
ENTRYPOINT ["java", "org.springframework.boot.loader.JarLauncher"]
```

---

## 5. Common Configurations

### 5.1 Web Application

```groovy
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
}

dependencies {
    // Web
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    // Validation
    implementation 'org.springframework.boot:spring-boot-starter-validation'
    
    // Actuator
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    
    // DevTools (optional, development only)
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    
    // Lombok
    compileOnly 'org.projectlombok:lombok'
    annotationProcessor 'org.projectlombok:lombok'
    
    // Configuration processor
    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

bootRun {
    systemProperty 'spring.profiles.active', 'dev'
}
```

---

### 5.2 Data JPA Application

```groovy
dependencies {
    // Web + Data
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-data-jpa'
    
    // Database
    runtimeOnly 'org.postgresql:postgresql'
    runtimeOnly 'com.h2database:h2'  // For testing
    
    // Flyway migration
    implementation 'org.flywaydb:flyway-core'
    runtimeOnly 'org.flywaydb:flyway-database-postgresql'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.testcontainers:testcontainers'
    testImplementation 'org.testcontainers:postgresql'
}

test {
    useJUnitPlatform()
}
```

---

### 5.3 Microservice with Cloud

```groovy
ext {
    set('springCloudVersion', '2023.0.0')
}

dependencies {
    // Web
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    // Cloud
    implementation 'org.springframework.cloud:spring-cloud-starter-config'
    implementation 'org.springframework.cloud:spring-cloud-starter-netflix-eureka-client'
    implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
    
    // Resilience
    implementation 'org.springframework.cloud:spring-cloud-starter-circuitbreaker-resilience4j'
    
    // Observability
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    implementation 'io.micrometer:micrometer-registry-prometheus'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.springframework.cloud:spring-cloud-starter-contract-stub-runner'
}

dependencyManagement {
    imports {
        mavenBom "org.springframework.cloud:spring-cloud-dependencies:${springCloudVersion}"
    }
}
```

---

### 5.4 Reactive Application

```groovy
dependencies {
    // Reactive Web
    implementation 'org.springframework.boot:spring-boot-starter-webflux'
    
    // Reactive Data
    implementation 'org.springframework.boot:spring-boot-starter-data-r2dbc'
    runtimeOnly 'org.postgresql:r2dbc-postgresql'
    
    // Reactive Security
    implementation 'org.springframework.boot:spring-boot-starter-security'
    
    // Testing
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'io.projectreactor:reactor-test'
}
```

---

## 6. Multi-Module Spring Boot

### 6.1 Project Structure

```
spring-boot-app/
├── settings.gradle
├── build.gradle (root)
├── common/
│   └── build.gradle
├── domain/
│   └── build.gradle
├── service/
│   └── build.gradle
└── web/
    └── build.gradle
```

---

### 6.2 Root Configuration

```groovy
// build.gradle (root)

plugins {
    id 'java' apply false
    id 'org.springframework.boot' version '3.2.0' apply false
    id 'io.spring.dependency-management' version '1.1.4' apply false
}

subprojects {
    apply plugin: 'java'
    apply plugin: 'io.spring.dependency-management'
    
    group = 'com.example'
    version = '1.0.0-SNAPSHOT'
    sourceCompatibility = '17'
    
    repositories {
        mavenCentral()
    }
    
    dependencyManagement {
        imports {
            mavenBom org.springframework.boot.gradle.plugin.SpringBootPlugin.BOM_COORDINATES
        }
    }
    
    dependencies {
        compileOnly 'org.projectlombok:lombok'
        annotationProcessor 'org.projectlombok:lombok'
        
        testImplementation 'org.springframework.boot:spring-boot-starter-test'
    }
    
    test {
        useJUnitPlatform()
    }
}
```

---

### 6.3 Library Modules

```groovy
// common/build.gradle
dependencies {
    api 'org.springframework.boot:spring-boot-starter'
    api 'org.apache.commons:commons-lang3'
}

// domain/build.gradle
dependencies {
    api project(':common')
    api 'org.springframework.boot:spring-boot-starter-data-jpa'
}
```

---

### 6.4 Application Module

```groovy
// web/build.gradle

plugins {
    id 'org.springframework.boot'
}

dependencies {
    implementation project(':common')
    implementation project(':domain')
    implementation project(':service')
    
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'org.springframework.boot:spring-boot-starter-actuator'
    
    runtimeOnly 'org.postgresql:postgresql'
}

springBoot {
    buildInfo()
    mainClass = 'com.example.web.Application'
}

bootJar {
    archiveBaseName = 'my-app'
    layered {
        enabled = true
    }
}
```

---

## 7. Advanced Features

### 7.1 Native Image Support

```groovy
plugins {
    id 'org.springframework.boot' version '3.2.0'
    id 'org.graalvm.buildtools.native' version '0.9.28'
}

graalvmNative {
    binaries {
        main {
            imageName = 'my-service'
            mainClass = 'com.example.Application'
            
            buildArgs.add('--verbose')
            buildArgs.add('-H:+ReportExceptionStackTraces')
        }
    }
}
```

```bash
# Build native image
./gradlew nativeCompile

# Run native image
./build/native/nativeCompile/my-service
```

---

### 7.2 Development Tools

```groovy
dependencies {
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
}

bootRun {
    // DevTools triggers on classpath change
    sourceResources sourceSets.main
}

// Automatic restart on Java changes
// Live reload in browser (with LiveReload extension)
```

---

### 7.3 Custom Starters

```groovy
// my-starter/build.gradle
plugins {
    id 'java-library'
}

dependencies {
    api 'org.springframework.boot:spring-boot-starter'
    implementation 'org.springframework.boot:spring-boot-autoconfigure'
    annotationProcessor 'org.springframework.boot:spring-boot-autoconfigure-processor'
    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
}

// Usage in application
dependencies {
    implementation project(':my-starter')
    // Or from Maven
    implementation 'com.example:my-starter:1.0.0'
}
```

---

## Summary

### Essential Configuration

```groovy
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.4'
}

group = 'com.example'
version = '1.0.0-SNAPSHOT'
sourceCompatibility = '17'

repositories {
    mavenCentral()
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    
    developmentOnly 'org.springframework.boot:spring-boot-devtools'
    annotationProcessor 'org.springframework.boot:spring-boot-configuration-processor'
    
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
}

springBoot {
    buildInfo()
}

bootJar {
    layered {
        enabled = true
    }
}

test {
    useJUnitPlatform()
}
```

### Key Tasks

```bash
# Run application
./gradlew bootRun

# Build executable JAR
./gradlew bootJar

# Build Docker image
./gradlew bootBuildImage

# Run tests
./gradlew test

# Clean and build
./gradlew clean build
```

### Common Starters

```
Web:
  spring-boot-starter-web
  spring-boot-starter-webflux

Data:
  spring-boot-starter-data-jpa
  spring-boot-starter-data-mongodb
  spring-boot-starter-data-redis
  spring-boot-starter-data-r2dbc

Security:
  spring-boot-starter-security
  spring-boot-starter-oauth2-client
  spring-boot-starter-oauth2-resource-server

Testing:
  spring-boot-starter-test
  spring-boot-starter-webflux (includes reactor-test)

Tools:
  spring-boot-devtools
  spring-boot-starter-actuator
  spring-boot-configuration-processor
```

### Best Practices

```
✓ Use dependency management plugin
✓ Don't specify versions for Spring dependencies
✓ Enable layered JARs for Docker
✓ Use bootBuildImage for containerization
✓ Include build info
✓ Use DevTools in development
✓ Configure profiles appropriately
✓ Use Actuator for monitoring
✓ Test with spring-boot-starter-test
```
