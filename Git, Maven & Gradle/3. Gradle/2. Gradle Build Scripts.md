## Overview

Gradle build scripts define how your project is built, tested, and packaged. Gradle supports two DSLs: Groovy (build.gradle) and Kotlin (build.gradle.kts), each with unique advantages.

```
┌─────────────────────────────────────────────────────────────────┐
│                  GRADLE BUILD SCRIPT STRUCTURE                  │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  settings.gradle / settings.gradle.kts                         │
│  ├── Root project name                                         │
│  ├── Multi-project includes                                    │
│  └── Plugin management                                         │
│       ↓                                                         │
│  build.gradle / build.gradle.kts                               │
│  ├── Plugins (apply plugins)                                   │
│  ├── Project properties (group, version)                       │
│  ├── Repositories (where to find dependencies)                 │
│  ├── Dependencies (what to include)                            │
│  ├── Task configuration                                        │
│  └── Custom tasks and logic                                    │
│                                                                 │
│  Execution Order:                                               │
│  1. settings.gradle evaluated first                            │
│  2. build.gradle evaluated second                              │
│  3. Task graph constructed                                     │
│  4. Tasks executed                                              │
│                                                                 │
└─────────────────────────────────────────────────────────────────┘
```

---

## 1. build.gradle Structure (Groovy DSL)

### Complete Example

```groovy
// build.gradle - Groovy DSL

// 1. PLUGINS - Apply plugins to project
plugins {
    id 'java'                                      // Java plugin
    id 'application'                               // Application plugin
    id 'org.springframework.boot' version '3.2.0'  // Spring Boot plugin
    id 'io.spring.dependency-management' version '1.1.0'
}

// 2. PROJECT PROPERTIES - Identify and configure project
group = 'com.example'
version = '1.0.0-SNAPSHOT'
description = 'My Gradle Application'

// 3. JAVA CONFIGURATION
java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

// 4. REPOSITORIES - Where to find dependencies
repositories {
    mavenCentral()                    // Maven Central
    mavenLocal()                      // Local Maven repository (~/.m2)
    google()                          // Google's Maven repository
    
    // Custom repositories
    maven {
        name = 'Spring Milestones'
        url = 'https://repo.spring.io/milestone'
    }
    
    maven {
        name = 'Company Nexus'
        url = 'https://nexus.company.com/repository/maven-public/'
        credentials {
            username = project.findProperty('nexusUsername') ?: 'default'
            password = project.findProperty('nexusPassword') ?: 'default'
        }
    }
}

// 5. DEPENDENCIES - What libraries to use
dependencies {
    // Compile + Runtime
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'com.google.guava:guava:32.1.3-jre'
    
    // Compile only (not in runtime classpath)
    compileOnly 'org.projectlombok:lombok:1.18.30'
    
    // Annotation processors
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    
    // Runtime only
    runtimeOnly 'org.postgresql:postgresql:42.6.0'
    
    // Test dependencies
    testImplementation 'org.springframework.boot:spring-boot-starter-test'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
}

// 6. TASK CONFIGURATION - Configure existing tasks
tasks.named('test') {
    useJUnitPlatform()  // Use JUnit 5
    
    // Test configuration
    maxParallelForks = Runtime.runtime.availableProcessors().intdiv(2) ?: 1
    
    testLogging {
        events "passed", "skipped", "failed"
        exceptionFormat "full"
        showStandardStreams = false
    }
}

tasks.named('jar') {
    manifest {
        attributes(
            'Implementation-Title': project.name,
            'Implementation-Version': project.version,
            'Main-Class': 'com.example.Application'
        )
    }
}

// 7. CUSTOM TASKS - Define custom tasks
task printVersion {
    doLast {
        println "Project version: ${project.version}"
    }
}

task copyDependencies(type: Copy) {
    from configurations.runtimeClasspath
    into "${buildDir}/dependencies"
}

// 8. CUSTOM CONFIGURATION
configurations {
    integrationTestImplementation.extendsFrom testImplementation
    integrationTestRuntimeOnly.extendsFrom testRuntimeOnly
}

// 9. SOURCE SETS (if needed)
sourceSets {
    integrationTest {
        java {
            srcDir 'src/integration-test/java'
        }
        resources {
            srcDir 'src/integration-test/resources'
        }
    }
}

// 10. ADDITIONAL CONFIGURATION
application {
    mainClass = 'com.example.Application'
}

// Conditional configuration
if (project.hasProperty('profile') && profile == 'dev') {
    println 'Using development profile'
}
```

---

### Section-by-Section Breakdown

#### 1. Plugins Block

```groovy
plugins {
    // Core plugins (no version needed)
    id 'java'
    id 'application'
    id 'groovy'
    id 'war'
    
    // Community plugins (version required)
    id 'org.springframework.boot' version '3.2.0'
    id 'io.spring.dependency-management' version '1.1.0'
    id 'com.github.johnrengelman.shadow' version '8.1.1'
    
    // Apply conditionally
    if (project.hasProperty('enableKotlin')) {
        id 'org.jetbrains.kotlin.jvm' version '1.9.20'
    }
}
```

**Common Plugins:**

```groovy
// Language plugins
id 'java'                    // Java support
id 'groovy'                  // Groovy support
id 'scala'                   // Scala support
id 'kotlin("jvm")' version 'X.Y.Z'  // Kotlin support

// Build plugins
id 'application'             // Executable application
id 'war'                     // WAR packaging
id 'ear'                     // EAR packaging

// Framework plugins
id 'org.springframework.boot' version '3.2.0'
id 'io.micronaut.application' version '4.0.0'
id 'io.quarkus' version '3.5.0'

// Utility plugins
id 'maven-publish'           // Maven publishing
id 'jacoco'                  // Code coverage
id 'checkstyle'              // Code style
```

---

#### 2. Project Properties

```groovy
// Basic properties
group = 'com.example'
version = '1.0.0-SNAPSHOT'
description = 'My Application'

// Java version
java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
    // Or using numbers
    sourceCompatibility = '17'
    targetCompatibility = '17'
}

// Artifact configuration
archivesBaseName = 'my-app'  // JAR name prefix

// Custom properties (accessible throughout build)
ext {
    springVersion = '6.0.13'
    lombokVersion = '1.18.30'
    isProduction = project.hasProperty('prod')
}

// Use custom properties
println "Spring version: ${springVersion}"
```

---

#### 3. Repositories

```groovy
repositories {
    // Standard repositories
    mavenCentral()              // Maven Central (recommended)
    mavenLocal()                // ~/.m2/repository
    google()                    // Google's repository
    gradlePluginPortal()        // Gradle Plugin Portal
    
    // Maven repository with URL
    maven {
        name = 'Spring Releases'
        url = 'https://repo.spring.io/release'
    }
    
    // With credentials
    maven {
        name = 'Company Nexus'
        url = 'https://nexus.company.com/repository/maven-public/'
        credentials {
            username = findProperty('nexusUsername') ?: System.getenv('NEXUS_USERNAME')
            password = findProperty('nexusPassword') ?: System.getenv('NEXUS_PASSWORD')
        }
    }
    
    // Authenticated repository
    maven {
        url = 'https://private-repo.company.com/maven'
        credentials(HttpHeaderCredentials) {
            name = 'Authorization'
            value = 'Bearer ' + System.getenv('REPO_TOKEN')
        }
        authentication {
            header(HttpHeaderAuthentication)
        }
    }
    
    // Flat directory repository (local JARs)
    flatDir {
        dirs 'libs', 'third-party-libs'
    }
    
    // Ivy repository
    ivy {
        url = 'https://ivy-repo.company.com'
    }
    
    // Multiple URLs (fallback)
    maven {
        url = 'https://primary-repo.com'
        url = 'https://fallback-repo.com'
    }
}
```

---

#### 4. Dependencies

```groovy
dependencies {
    // ===== COMPILE DEPENDENCIES =====
    
    // implementation: compile + runtime (preferred)
    implementation 'org.springframework.boot:spring-boot-starter-web'
    implementation 'com.google.guava:guava:32.1.3-jre'
    
    // api: compile + runtime + exposed to consumers
    // (only with java-library plugin)
    api 'org.apache.commons:commons-lang3:3.13.0'
    
    // compileOnly: compile time only (like Maven's provided)
    compileOnly 'org.projectlombok:lombok:1.18.30'
    compileOnly 'javax.servlet:javax.servlet-api:4.0.1'
    
    // ===== RUNTIME DEPENDENCIES =====
    
    // runtimeOnly: runtime only (not on compile classpath)
    runtimeOnly 'org.postgresql:postgresql:42.6.0'
    runtimeOnly 'com.h2database:h2:2.2.224'
    
    // ===== ANNOTATION PROCESSORS =====
    
    annotationProcessor 'org.projectlombok:lombok:1.18.30'
    annotationProcessor 'org.mapstruct:mapstruct-processor:1.5.5.Final'
    
    // ===== TEST DEPENDENCIES =====
    
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
    testImplementation 'org.mockito:mockito-core:5.5.0'
    testImplementation 'org.assertj:assertj-core:3.24.2'
    
    testRuntimeOnly 'org.junit.platform:junit-platform-launcher'
    
    testCompileOnly 'org.projectlombok:lombok:1.18.30'
    testAnnotationProcessor 'org.projectlombok:lombok:1.18.30'
    
    // ===== PLATFORM/BOM =====
    
    // Import BOM (like Maven's dependencyManagement)
    implementation platform('org.springframework.boot:spring-boot-dependencies:3.2.0')
    implementation platform('com.fasterxml.jackson:jackson-bom:2.15.3')
    
    // ===== VERSION CONSTRAINTS =====
    
    implementation('com.google.guava:guava') {
        version {
            strictly '[30.0, 31.0['  // Strict range
            prefer '30.1.1-jre'      // Preferred version
        }
    }
    
    // ===== EXCLUSIONS =====
    
    implementation('org.springframework.boot:spring-boot-starter-web') {
        exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
    }
    
    // ===== TRANSITIVE DEPENDENCIES =====
    
    implementation('com.company:some-lib:1.0.0') {
        transitive = false  // Don't include transitive dependencies
    }
    
    // ===== CLASSIFIER =====
    
    implementation 'net.java.dev.jna:jna:5.13.0:jpms'  // With classifier
    
    // ===== FILE DEPENDENCIES =====
    
    implementation files('libs/custom-lib.jar')
    implementation fileTree(dir: 'libs', include: ['*.jar'])
}
```

**Dependency Configurations:**

```
┌────────────────────────────────────────────────────────────┐
│            GRADLE DEPENDENCY CONFIGURATIONS                │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  implementation:                                           │
│  - Compile + Runtime                                       │
│  - NOT exposed to consumers                                │
│  - Preferred (encapsulation)                               │
│                                                            │
│  api:                                                      │
│  - Compile + Runtime                                       │
│  - Exposed to consumers                                    │
│  - Use sparingly (increases coupling)                      │
│  - Requires java-library plugin                            │
│                                                            │
│  compileOnly:                                              │
│  - Compile time only                                       │
│  - NOT in runtime classpath                                │
│  - Like Maven's 'provided'                                 │
│                                                            │
│  runtimeOnly:                                              │
│  - Runtime only                                            │
│  - NOT on compile classpath                                │
│                                                            │
│  testImplementation:                                       │
│  - Test compile + test runtime                             │
│  - NOT in production                                       │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

#### 5. Tasks Configuration

```groovy
// Configure existing tasks

// Named task configuration (type-safe)
tasks.named('test') {
    useJUnitPlatform()
    
    maxHeapSize = '1G'
    maxParallelForks = 4
    
    testLogging {
        events "passed", "skipped", "failed", "standardOut", "standardError"
        exceptionFormat "full"
        showCauses true
        showStackTraces true
    }
    
    // System properties
    systemProperty 'spring.profiles.active', 'test'
    
    // Environment variables
    environment 'TEST_ENV', 'integration'
}

// Compiler configuration
tasks.named('compileJava') {
    options.encoding = 'UTF-8'
    options.compilerArgs += [
        '-Xlint:unchecked',
        '-Xlint:deprecation',
        '-parameters'
    ]
}

// JAR configuration
tasks.named('jar') {
    archiveBaseName = 'my-app'
    archiveVersion = '1.0.0'
    
    manifest {
        attributes(
            'Implementation-Title': project.name,
            'Implementation-Version': project.version,
            'Main-Class': 'com.example.Application',
            'Built-By': System.getProperty('user.name'),
            'Built-Date': new Date().format('yyyy-MM-dd HH:mm:ss'),
            'Built-JDK': System.getProperty('java.version')
        )
    }
    
    // Include dependencies
    from {
        configurations.runtimeClasspath.collect {
            it.isDirectory() ? it : zipTree(it)
        }
    }
    
    duplicatesStrategy = DuplicatesStrategy.EXCLUDE
}

// Configure all tasks of a type
tasks.withType(JavaCompile).configureEach {
    options.encoding = 'UTF-8'
}

tasks.withType(Test).configureEach {
    useJUnitPlatform()
}
```

---

#### 6. Custom Tasks

```groovy
// Simple task
task hello {
    doLast {
        println 'Hello, Gradle!'
    }
}

// Task with type
task copyFiles(type: Copy) {
    from 'src/main/resources'
    into "${buildDir}/resources"
}

// Task with dependencies
task buildAll {
    dependsOn 'clean', 'build', 'test'
    
    doLast {
        println 'Build complete!'
    }
}

// Task with inputs and outputs (incremental build)
task generateVersion {
    inputs.property('version', project.version)
    outputs.file("${buildDir}/version.txt")
    
    doLast {
        file("${buildDir}/version.txt").text = project.version
    }
}

// Task with configuration
task customZip(type: Zip) {
    archiveBaseName = project.name
    archiveVersion = project.version
    destinationDirectory = file("${buildDir}/distributions")
    
    from('src/main') {
        include '**/*.java'
    }
    
    from('build/libs') {
        include '*.jar'
    }
}

// Typed task
abstract class GreetingTask extends DefaultTask {
    @Input
    String greeting = 'hello'
    
    @Input
    String person = 'world'
    
    @TaskAction
    void greet() {
        println "${greeting}, ${person}!"
    }
}

task greet(type: GreetingTask) {
    greeting = 'Hi'
    person = 'Gradle'
}

// Task with condition
task conditionalTask {
    onlyIf {
        project.hasProperty('runConditional')
    }
    
    doLast {
        println 'Conditional task executed'
    }
}
```

---

## 2. build.gradle.kts (Kotlin DSL)

### Complete Example

```kotlin
// build.gradle.kts - Kotlin DSL

import org.jetbrains.kotlin.gradle.tasks.KotlinCompile

// 1. PLUGINS
plugins {
    java
    application
    id("org.springframework.boot") version "3.2.0"
    id("io.spring.dependency-management") version "1.1.0"
    kotlin("jvm") version "1.9.20"  // If using Kotlin
}

// 2. PROJECT PROPERTIES
group = "com.example"
version = "1.0.0-SNAPSHOT"
description = "My Gradle Application"

// 3. JAVA CONFIGURATION
java {
    sourceCompatibility = JavaVersion.VERSION_17
    targetCompatibility = JavaVersion.VERSION_17
}

// 4. REPOSITORIES
repositories {
    mavenCentral()
    mavenLocal()
    
    maven {
        name = "Spring Milestones"
        url = uri("https://repo.spring.io/milestone")
    }
    
    maven {
        name = "Company Nexus"
        url = uri("https://nexus.company.com/repository/maven-public/")
        credentials {
            username = project.findProperty("nexusUsername") as String? ?: "default"
            password = project.findProperty("nexusPassword") as String? ?: "default"
        }
    }
}

// 5. DEPENDENCIES
dependencies {
    // Implementation
    implementation("org.springframework.boot:spring-boot-starter-web")
    implementation("com.google.guava:guava:32.1.3-jre")
    
    // Compile only
    compileOnly("org.projectlombok:lombok:1.18.30")
    
    // Annotation processors
    annotationProcessor("org.projectlombok:lombok:1.18.30")
    
    // Runtime
    runtimeOnly("org.postgresql:postgresql:42.6.0")
    
    // Test
    testImplementation("org.springframework.boot:spring-boot-starter-test")
    testImplementation("org.junit.jupiter:junit-jupiter:5.10.0")
    testRuntimeOnly("org.junit.platform:junit-platform-launcher")
    
    // Platform/BOM
    implementation(platform("org.springframework.boot:spring-boot-dependencies:3.2.0"))
}

// 6. TASK CONFIGURATION
tasks.named<Test>("test") {
    useJUnitPlatform()
    
    maxHeapSize = "1G"
    maxParallelForks = Runtime.getRuntime().availableProcessors() / 2
    
    testLogging {
        events("passed", "skipped", "failed")
        exceptionFormat = org.gradle.api.tasks.testing.logging.TestExceptionFormat.FULL
        showStandardStreams = false
    }
}

tasks.named<Jar>("jar") {
    manifest {
        attributes(
            "Implementation-Title" to project.name,
            "Implementation-Version" to project.version,
            "Main-Class" to "com.example.Application"
        )
    }
}

// Compiler configuration
tasks.withType<JavaCompile>().configureEach {
    options.encoding = "UTF-8"
    options.compilerArgs.addAll(listOf(
        "-Xlint:unchecked",
        "-Xlint:deprecation",
        "-parameters"
    ))
}

// Kotlin compiler configuration (if using Kotlin)
tasks.withType<KotlinCompile>().configureEach {
    kotlinOptions {
        freeCompilerArgs = listOf("-Xjsr305=strict")
        jvmTarget = "17"
    }
}

// 7. CUSTOM TASKS
tasks.register("printVersion") {
    doLast {
        println("Project version: ${project.version}")
    }
}

tasks.register<Copy>("copyDependencies") {
    from(configurations.runtimeClasspath)
    into("${buildDir}/dependencies")
}

// 8. APPLICATION CONFIGURATION
application {
    mainClass.set("com.example.Application")
}

// 9. CUSTOM CONFIGURATION
val integrationTestImplementation by configurations.creating {
    extendsFrom(configurations.testImplementation.get())
}

val integrationTestRuntimeOnly by configurations.creating {
    extendsFrom(configurations.testRuntimeOnly.get())
}

// 10. SOURCE SETS
sourceSets {
    create("integrationTest") {
        java {
            srcDir("src/integration-test/java")
        }
        resources {
            srcDir("src/integration-test/resources")
        }
    }
}
```

---

### Groovy vs Kotlin DSL Comparison

**Same Configuration in Both DSLs:**

**Groovy:**

```groovy
// build.gradle
plugins {
    id 'java'
    id 'org.springframework.boot' version '3.2.0'
}

dependencies {
    implementation 'org.springframework.boot:spring-boot-starter-web'
    testImplementation 'org.junit.jupiter:junit-jupiter:5.10.0'
}

tasks.named('test') {
    useJUnitPlatform()
}

task hello {
    doLast {
        println 'Hello!'
    }
}
```

**Kotlin:**

```kotlin
// build.gradle.kts
plugins {
    java
    id("org.springframework.boot") version "3.2.0"
}

dependencies {
    implementation("org.springframework.boot:spring-boot-starter-web")
    testImplementation("org.junit.jupiter:junit-jupiter:5.10.0")
}

tasks.named<Test>("test") {
    useJUnitPlatform()
}

tasks.register("hello") {
    doLast {
        println("Hello!")
    }
}
```

**Key Differences:**

```
┌────────────────────────────────────────────────────────────┐
│             GROOVY vs KOTLIN DSL                           │
├────────────────────────────────────────────────────────────┤
│                                                            │
│  Syntax:                                                   │
│  Groovy:  id 'java'                                       │
│  Kotlin:  java                                             │
│                                                            │
│  Strings:                                                  │
│  Groovy:  'single' or "double"                            │
│  Kotlin:  "double" only                                    │
│                                                            │
│  Dependencies:                                             │
│  Groovy:  implementation 'group:artifact:version'         │
│  Kotlin:  implementation("group:artifact:version")        │
│                                                            │
│  Tasks:                                                    │
│  Groovy:  tasks.named('test')                             │
│  Kotlin:  tasks.named<Test>("test")                       │
│                                                            │
│  Properties:                                               │
│  Groovy:  version = '1.0.0'                               │
│  Kotlin:  version = "1.0.0"                               │
│                                                            │
│  Type Safety:                                              │
│  Groovy:  Dynamic typing                                  │
│  Kotlin:  Static typing                                    │
│                                                            │
│  IDE Support:                                              │
│  Groovy:  Basic                                            │
│  Kotlin:  Excellent (autocomplete, refactoring)           │
│                                                            │
└────────────────────────────────────────────────────────────┘
```

---

### Advantages of Kotlin DSL

**1. Type Safety:**

```kotlin
// Kotlin: Compile-time error if wrong type
tasks.named<JavaCompile>("compileJava") {
    options.encoding = "UTF-8"
    // options.encoding = 123  // ✗ Compile error
}

// Groovy: Runtime error
tasks.named('compileJava') {
    options.encoding = 'UTF-8'
    // options.encoding = 123  // ✓ Compiles, fails at runtime
}
```

**2. IDE Support:**

```kotlin
// Kotlin: Full autocomplete
tasks.named<Test>("test") {
    use  // ← IDE suggests: useJUnitPlatform()
}

// Groovy: Limited autocomplete
tasks.named('test') {
    use  // ← IDE might not suggest anything
}
```

**3. Refactoring:**

```kotlin
// Kotlin: Rename refactoring works
val myVersion = "1.0.0"
version = myVersion  // ← Can rename 'myVersion' safely

// Groovy: String-based, harder to refactor
def myVersion = '1.0.0'
version = myVersion
```

**4. Navigation:**

```kotlin
// Kotlin: Click to navigate to definition
implementation("org.springframework.boot:spring-boot-starter-web")
// ← Ctrl+Click on implementation goes to definition

// Groovy: Limited navigation
implementation 'org.springframework.boot:spring-boot-starter-web'
```

---

### Disadvantages of Kotlin DSL

**1. More Verbose:**

```kotlin
// Kotlin: More parentheses and quotes
implementation("org.springframework.boot:spring-boot-starter-web")
tasks.named<Test>("test") {
    useJUnitPlatform()
}

// Groovy: Cleaner syntax
implementation 'org.springframework.boot:spring-boot-starter-web'
tasks.named('test') {
    useJUnitPlatform()
}
```

**2. Slower Build Script Compilation:**

```
Kotlin DSL:
  - First build: ~10s compilation
  - Subsequent: Cached, fast
  
Groovy DSL:
  - First build: ~2s compilation
  - Subsequent: ~2s compilation
```

**3. Learning Curve:**

```
Kotlin DSL:
  - Requires Kotlin knowledge
  - More complex syntax
  - Type system understanding needed
  
Groovy DSL:
  - More straightforward
  - Dynamic typing easier
  - Familiar to many developers
```

---

## 3. settings.gradle / settings.gradle.kts

### Purpose

`settings.gradle` is evaluated BEFORE build.gradle and defines:

- Root project name
- Multi-project structure
- Plugin management
- Build cache configuration

---

### Basic settings.gradle (Groovy)

```groovy
// settings.gradle

// 1. ROOT PROJECT NAME
rootProject.name = 'my-application'

// 2. MULTI-PROJECT INCLUDES (if multi-module)
include 'module-a'
include 'module-b'
include 'module-c'

// Or with subdirectories
include 'services:user-service'
include 'services:order-service'
include 'libs:common-lib'

// 3. PLUGIN MANAGEMENT
pluginManagement {
    repositories {
        gradlePluginPortal()
        mavenCentral()
        maven {
            url = 'https://repo.spring.io/milestone'
        }
    }
    
    // Plugin version management
    plugins {
        id 'org.springframework.boot' version '3.2.0'
        id 'io.spring.dependency-management' version '1.1.0'
    }
    
    // Plugin resolution
    resolutionStrategy {
        eachPlugin {
            if (requested.id.id == 'com.example.plugin') {
                useModule('com.example:my-plugin:1.0.0')
            }
        }
    }
}

// 4. DEPENDENCY RESOLUTION MANAGEMENT
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    
    repositories {
        mavenCentral()
        google()
    }
    
    // Version catalogs
    versionCatalogs {
        libs {
            from(files('gradle/libs.versions.toml'))
        }
    }
}

// 5. BUILD CACHE
buildCache {
    local {
        enabled = true
        directory = new File(rootDir, '.gradle/build-cache')
        removeUnusedEntriesAfterDays = 30
    }
    
    remote(HttpBuildCache) {
        url = 'https://build-cache.company.com/'
        enabled = true
        push = System.getenv('CI') != null  // Only push in CI
        credentials {
            username = System.getenv('CACHE_USERNAME')
            password = System.getenv('CACHE_PASSWORD')
        }
    }
}

// 6. FEATURE PREVIEWS
enableFeaturePreview('TYPESAFE_PROJECT_ACCESSORS')
enableFeaturePreview('VERSION_CATALOGS')
```

---

### settings.gradle.kts (Kotlin)

```kotlin
// settings.gradle.kts

// 1. ROOT PROJECT NAME
rootProject.name = "my-application"

// 2. MULTI-PROJECT INCLUDES
include("module-a")
include("module-b")
include("module-c")

// With subdirectories
include("services:user-service")
include("services:order-service")
include("libs:common-lib")

// 3. PLUGIN MANAGEMENT
pluginManagement {
    repositories {
        gradlePluginPortal()
        mavenCentral()
        maven {
            url = uri("https://repo.spring.io/milestone")
        }
    }
    
    plugins {
        id("org.springframework.boot") version "3.2.0"
        id("io.spring.dependency-management") version "1.1.0"
    }
}

// 4. DEPENDENCY RESOLUTION MANAGEMENT
dependencyResolutionManagement {
    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)
    
    repositories {
        mavenCentral()
        google()
    }
    
    versionCatalogs {
        create("libs") {
            from(files("gradle/libs.versions.toml"))
        }
    }
}

// 5. BUILD CACHE
buildCache {
    local {
        isEnabled = true
        directory = File(rootDir, ".gradle/build-cache")
        removeUnusedEntriesAfterDays = 30
    }
    
    remote<HttpBuildCache> {
        url = uri("https://build-cache.company.com/")
        isEnabled = true
        isPush = System.getenv("CI") != null
        credentials {
            username = System.getenv("CACHE_USERNAME")
            password = System.getenv("CACHE_PASSWORD")
        }
    }
}

// 6. FEATURE PREVIEWS
enableFeaturePreview("TYPESAFE_PROJECT_ACCESSORS")
enableFeaturePreview("VERSION_CATALOGS")
```

---

### Multi-Project Structure

**Directory Layout:**

```
my-application/
├── settings.gradle
├── build.gradle
├── module-a/
│   └── build.gradle
├── module-b/
│   └── build.gradle
└── services/
    ├── user-service/
    │   └── build.gradle
    └── order-service/
        └── build.gradle
```

**settings.gradle:**

```groovy
rootProject.name = 'my-application'

// Include all subprojects
include 'module-a'
include 'module-b'
include 'services:user-service'
include 'services:order-service'

// Configure subproject directories (if non-standard)
project(':module-a').projectDir = file('custom-dir/module-a')
```

---

### Plugin Management

```groovy
// settings.gradle
pluginManagement {
    // Where to find plugins
    repositories {
        gradlePluginPortal()
        mavenCentral()
        maven { url 'https://plugins.gradle.org/m2/' }
    }
    
    // Define plugin versions centrally
    plugins {
        id 'org.springframework.boot' version '3.2.0'
        id 'io.spring.dependency-management' version '1.1.0'
        id 'com.github.johnrengelman.shadow' version '8.1.1'
    }
    
    // Plugin resolution strategy
    resolutionStrategy {
        eachPlugin {
            if (requested.id.namespace == 'com.example') {
                useModule("com.example:gradle-plugin:${requested.version}")
            }
        }
    }
}
```

**Then in build.gradle (no version needed):**

```groovy
plugins {
    id 'org.springframework.boot'  // Version from settings.gradle
    id 'io.spring.dependency-management'
}
```

---

## Summary

### Key Takeaways

**build.gradle Structure:**

```groovy
1. plugins { }              // Apply plugins
2. group/version            // Project identity
3. repositories { }         // Where to find dependencies
4. dependencies { }         // What to include
5. tasks { }                // Configure tasks
6. Custom logic             // Programmatic build logic
```

**Groovy vs Kotlin DSL:**

```
Choose Groovy DSL when:
  ✓ Concise syntax preferred
  ✓ Dynamic typing acceptable
  ✓ Team familiar with Groovy
  ✓ Existing Groovy projects

Choose Kotlin DSL when:
  ✓ Type safety important
  ✓ Better IDE support desired
  ✓ Refactoring support needed
  ✓ New projects
  ✓ Team knows Kotlin
```

**settings.gradle:**

```groovy
Defines:
  ✓ Root project name
  ✓ Multi-project structure
  ✓ Plugin management
  ✓ Build cache
  ✓ Repository management
  
Evaluated:
  ✓ Before build.gradle
  ✓ Once per build
```

### Essential Patterns

```groovy
// Dependency with version constraint
implementation('com.google.guava:guava') {
    version {
        strictly '[30.0, 31.0['
        prefer '30.1.1-jre'
    }
}

// Exclude transitive dependency
implementation('org.springframework.boot:spring-boot-starter-web') {
    exclude group: 'org.springframework.boot', module: 'spring-boot-starter-tomcat'
}

// Platform/BOM
implementation platform('org.springframework.boot:spring-boot-dependencies:3.2.0')

// Custom task with incremental build
task generateDocs {
    inputs.dir 'src/main/java'
    outputs.dir 'build/docs'
    doLast {
        // Generate documentation
    }
}
```
